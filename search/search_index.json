{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Tactical RMM Documentation","text":"<p>Tactical RMM is a remote monitoring &amp; management tool built with Django, Vue and Golang. It uses an agent written in Golang and integrates with MeshCentral.</p>"},{"location":"#live-demo","title":"LIVE DEMO","text":""},{"location":"#features","title":"Features","text":"<ul> <li>TeamViewer-like remote desktop control</li> <li>Real-time remote shell</li> <li>Remote file browser (download and upload files)</li> <li>Windows Registry Editor</li> <li>Remote command and script execution (bash, batch, powershell, python, nushell and deno scripts)</li> <li>Event log viewer</li> <li>Services management</li> <li>Windows patch management</li> <li>Automated checks with email/SMS/Webhooks alerting (cpu, disk, memory, services, scripts, event logs)</li> <li>Automated task runner (run scripts on a schedule)</li> <li>Remote software installation via chocolatey</li> <li>Software and hardware inventory</li> </ul>"},{"location":"#sponsorship-features","title":"Sponsorship Features","text":"<ul> <li>Mac and Linux Agents</li> <li>Windows Code Signed Agents</li> <li>Fully Customizable Reporting Module</li> <li>Single Sign-On (SSO)</li> </ul>"},{"location":"#windows-agent-versions-supported","title":"Windows agent versions supported","text":"<ul> <li>Windows 7, 8.1, 10, 11</li> <li>Server 2008 R2, 2012 R2, 2016, 2019, 2022, 2025</li> </ul>"},{"location":"#linux-agent-versions-supported","title":"Linux agent versions supported","text":"<ul> <li>Any distro with systemd which includes but is not limited to: Debian (10, 11), Ubuntu x86_64 (18.04, 20.04, 22.04), Synology 7, CentOS, FreePBX, Raspberry Pi with raspbian and more!</li> <li>Check to see if you're running systemd with <code>ps --no-headers -o comm 1</code></li> </ul>"},{"location":"#mac-agent-versions-supported","title":"Mac agent versions supported","text":"<ul> <li>64 bit Intel and Apple Silicon (M-Series Processors)</li> </ul>"},{"location":"#discusscollaborate-and-get-helpsupport","title":"Discuss/Collaborate and Get Help/Support","text":"<p>Join us on Discord for (help/tips/discussion/dev chat/social etc). This is the primary method of discussing all things Tactical RMM.</p> <p>Github Discussions: is a distant 2nd option, we will frequently request you join Discord if you're requesting help or troubleshooting issues with your installation.</p> <p>Github Issues: Report bugs you discover with clear write-ups on how to reproduce problems. Also submit enhancement/feature requests here.</p> <p>View useful scripts to be used in Tactical RMM.</p> <p>Check out Awesome additions from the community.</p>"},{"location":"#github-repos","title":"Github Repos","text":"<p>Main Code Repo: https://github.com/amidaware/tacticalrmm</p> <p>Main Web admin frontend: https://github.com/amidaware/tacticalrmm-web</p> <p>Tactical Agent Source: https://github.com/amidaware/rmmagent</p> <p>Community Scripts: https://github.com/amidaware/community-scripts</p> <p>https://docs.tacticalrmm.com source: https://github.com/amidaware/trmm-docs</p> <p>Awesome contributions from the community: https://github.com/amidaware/trmm-awesome</p>"},{"location":"3rdparty_anydesk/","title":"AnyDesk","text":""},{"location":"3rdparty_anydesk/#anydesk-integration","title":"AnyDesk Integration","text":"<p>Info</p> <p>You can set up a full automation policy to collect the machine GUID, but this example will collect from just one agent for testing purposes.</p>"},{"location":"3rdparty_anydesk/#create-custom-field","title":"Create Custom Field","text":"<p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents.</p> <p>Add Custom Field: Target = <code>Agent</code> Name = <code>AnyNetID</code> Field Type = <code>Text</code></p> <p></p>"},{"location":"3rdparty_anydesk/#create-url-action","title":"Create URL Action","text":"<p>While in Global Settings go to URL ACTIONS.</p> <p>Add a URL Action: Name = <code>AnyDesk Control</code> Description = <code>Connect to a AnyDesk Session</code> URL Pattern =</p> <pre><code>anydesk:{{agent.AnyNetID}}\n</code></pre>"},{"location":"3rdparty_anydesk/#create-anydesk-collector","title":"Create AnyDesk Collector","text":"<p>This populates the Custom field with the Anydesk ID.</p> <p>Navigate to an agent with AnyDesk running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task: Select Script = <code>AnyDesk - Get AnyNetID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Collects the AnyNetID for AnyDesk.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>AnyNetID</code></p> <p></p> <p>Click Next Check One Time, choose a time in the past so it'll run once on the agent. Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute, then right click the agent that you are working with and go to Run URL Action &gt; AnyDesk Control.</p> <p>It should launch the session in AnyDesk.</p> <p>Note</p> <p>You have to have AnyDesk installed on the local computer.</p>"},{"location":"3rdparty_bitdefender_gravityzone/","title":"BitDefender GravityZone Deployment","text":""},{"location":"3rdparty_bitdefender_gravityzone/#how-to-deploy-bitdefender-gravityzone","title":"How to Deploy BitDefender GravityZone","text":"<p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Clients.</p> <p>Add a Custom Field:</p> <p>First:  Target = <code>CLIENTS</code> Name = <code>bdurl</code> Field Type = <code>Text</code></p> <p></p> <p>Log into your GravityZone and on the left hand side, select Network &gt; Packages.</p> <p></p> <p>Select the client you are working with and click \"Send Download Links\" at the top. </p> <p></p> <p>Copy the appropriate download link.</p> <p></p> <p>Paste download link into the <code>bdurl</code> when you right click your target clients name in the RMM.</p> <p></p> <p>Right-click the Agent you want to deploy to and Run Script. Select BitDefender GravityZone Install and set timeout for 1800 seconds.</p> <p>Install time will vary based on internet speed and other AV removal by BitDefender BEST deployment</p>"},{"location":"3rdparty_bitdefender_gravityzone/#how-to-onboard-a-new-company","title":"How to onboard a new company","text":"<p>Use these procedures to onboard a new company in Bitdefender.</p> <ol> <li>Go to Companies &gt; Add Company and fill out the details. The company type is \"Customer\".    </li> <li>Fill out the next tab for the authentication.</li> <li>Fill out the last tab for the licensing. You probably want to use Monthly Subscription so that it's added to your    monthly MSP subscription.    </li> <li>Next go to Network &gt; Packages &gt; Add to add a new package download for the company. Each company should have a    separate download.    </li> <li>Select the company &gt; Send download links. The Windows link is needed for the TRMM script to install Bitdefender. The    Linux and Mac installer links are also provided but the script is for Windows only.    </li> </ol>"},{"location":"3rdparty_bitdefender_gravityzone/#alert-types","title":"Alert types","text":"<p>There are two general types of alerts: email and dashboard. While you may get both types of alerts for an incident, they are not the same and configuring the exclusions are not the same. This section explains both types and how to add the exclusions for each.</p>"},{"location":"3rdparty_bitdefender_gravityzone/#process-alert","title":"Process alert","text":"<ul> <li>Bitdefender   docs: notification settings</li> </ul> <p>This is a process alert that is emailed and as the name suggests, it kills the process. If the parent process is <code>C:\\Windows\\System32\\services.exe</code>, the process is a service that just died. The detection type, ATC/IDS, indicates the exclusion will need to include the ATC/IDS module.</p> <p>Detected Exploit  A harmful process has been detected by Behavior Scan on the following endpoint in your network:</p> Detected Exploit Details Company: ACME Company, Inc. Computer Name: PC-Desktop01 Computer IP: 192.168.1.69 Installed Agent: Bitdefender Endpoint Security Tools Command Line: C:\\Program Files\\TacticalAgent\\tacticalrmm.exe -m svc Parent Process Path: C:\\Windows\\System32\\services.exe Parent PID: 852 Exploit Type: ATC Application Exploit Path: C:\\Program Files\\TacticalAgent\\tacticalrmm.exe Exploit Status: ATC/IDS Disinfected Last Blocked: 08 December 2022 08:55:59 Logged User: SYSTEM <p>Process notifications are configured in  Notifications &gt;  Settings &gt; ATC/IDS event.</p> <p></p>"},{"location":"3rdparty_bitdefender_gravityzone/#quarantine-alert","title":"Quarantine alert","text":"<ul> <li>Bitdefender docs: quarantine</li> </ul> <p>When a file is detected, it is quarantined by moving it to an encrypted folder on the endpoint. Email notifications cannot be configured for quarantined files, although they are available via the API. The threat name, Atc4.Detection, indicates the exclusion needs to include the ATC/IDS module.</p> <p></p>"},{"location":"3rdparty_bitdefender_gravityzone/#troubleshooting-and-problem-resolution","title":"Troubleshooting and problem resolution","text":""},{"location":"3rdparty_bitdefender_gravityzone/#meshagentexe-quarantine-corrupts-mesh-agent-service","title":"MeshAgent.exe quarantine corrupts Mesh Agent service","text":"<p>When Bitdefender quarantines MeshAgent.exe, the service is corrupted. Here is what the service looks like before the quarantine.</p> <pre><code>[PC-Desktop3]: PS C:\\&gt; Get-CimInstance Win32_Service -Filter 'Name = \"Mesh Agent\"' | Format-List *\n\n\nName                    : Mesh Agent\nStatus                  : OK\nExitCode                : 0\nDesktopInteract         : True\nErrorControl            : Ignore\nPathName                : \"C:\\Program Files\\Mesh Agent\\MeshAgent.exe\"\nServiceType             : Own Process\nStartMode               : Auto\nCaption                 : Mesh Agent\nDescription             : Mesh Agent background service\nInstallDate             :\nCreationClassName       : Win32_Service\nStarted                 : True\nSystemCreationClassName : Win32_ComputerSystem\nSystemName              : PC-Desktop3\nAcceptPause             : False\nAcceptStop              : True\nDisplayName             : Mesh Agent\nServiceSpecificExitCode : 0\nStartName               : LocalSystem\nState                   : Running\nTagId                   : 0\nCheckPoint              : 0\nDelayedAutoStart        : False\nProcessId               : 7612\nWaitHint                : 0\nPSComputerName          :\nCimClass                : root/cimv2:Win32_Service\nCimInstanceProperties   : {Caption, Description, InstallDate, Name...}\nCimSystemProperties     : Microsoft.Management.Infrastructure.CimSystemProperties\n</code></pre> <p>This is what the service looks like after <code>MeshAgent.exe</code> is quarantined. Notice the <code>PathName</code>, <code>ServiceType</code>, <code>StartMode</code> are \"Unknown\", and some properties are blank.</p> <pre><code>[PC-Desktop3]: PS C:\\&gt; Get-CimInstance Win32_Service -Filter 'Name = \"Mesh Agent\"' | Format-List *\n\n\nName                    : Mesh Agent\nStatus                  : OK\nExitCode                : 1067\nDesktopInteract         :\nErrorControl            : Unknown\nPathName                :\nServiceType             : Unknown\nStartMode               : Unknown\nCaption                 : Mesh Agent\nDescription             :\nInstallDate             :\nCreationClassName       : Win32_Service\nStarted                 : False\nSystemCreationClassName : Win32_ComputerSystem\nSystemName              : PC-Desktop3\nAcceptPause             : False\nAcceptStop              : False\nDisplayName             : Mesh Agent\nServiceSpecificExitCode : 0\nStartName               :\nState                   : Stopped\nTagId                   :\nCheckPoint              : 0\nDelayedAutoStart        :\nProcessId               : 0\nWaitHint                : 0\nPSComputerName          :\nCimClass                : root/cimv2:Win32_Service\nCimInstanceProperties   : {Caption, Description, InstallDate, Name...}\nCimSystemProperties     : Microsoft.Management.Infrastructure.CimSystemProperties\n</code></pre> <p>Restoring <code>MeshAgent.exe</code> from quarantine will make it \"look\" normal but will not have any permissions. Renaming, deleting or moving the file results in a permission denied error. After a reboot, the <code>MeshAgent.exe</code> will be missing.</p> <pre><code>[PC-Desktop3]: PS C:\\Program Files\\Mesh Agent&gt; Rename-Item -Path .\\MeshAgent.exe -NewName .\\MeshAgent-Restored.exe\nRename-Item : Access to the path is denied.\n    + CategoryInfo          : PermissionDenied: (C:\\Program File...t\\MeshAgent.exe:String) [Rename-Item], Unauthorized\n   AccessException\n    + FullyQualifiedErrorId : RenameItemUnauthorizedAccessError,Microsoft.PowerShell.Commands.RenameItemCommand\n</code></pre> <p>The best path for recovery is to leave the file in quarantine and run the Win_TRMM_Mesh_Install.ps1 script to have Tactical RMM install the Mesh Agent. The existing config will be used and there will not be duplicates.</p>"},{"location":"3rdparty_bitdefender_total_security/","title":"BitDefender Total Security","text":""},{"location":"3rdparty_bitdefender_total_security/#exceptions","title":"Exceptions","text":"<p>Open the app and select the Protection tab on the left.</p> <p></p> <p>Open Antivirus, Advanced Threat Defense, or Online Threat Protection. It doesn't matter which, simply select the Settings tab in any of them and click Manage exceptions.</p> <p>Click the Add an Exception button.</p> <p></p> <p>You'll be greeted with this panel:</p> <p></p> <p>The buttons become available depending on what you enter for the path / URL. Antivirus allows folders and files. Online Threat Prevention allows URLS, files, folders, and *. Advanced Threat Defense allows only individual files.</p> <p>BitDefender does not allow right click interactions in the entry field, so copy and paste using ctrl-c and ctrl-v if you want to do so.</p> <p>Enter:</p> <pre><code>C:\\Program Files\\Mesh Agent\\MeshAgent.exe\n</code></pre> <p>And toggle the buttons for Advanced Threat Defense, Online Threat Prevention, and Antivirus. Under Antivirus, options for On-access scan, On-demand scan, and Embedded scripts appear. Select them all.</p> <p></p> <p>Repeat this process for:</p> <pre><code>C:\\Program Files\\TacticalAgent\\meshagent.exe\nC:\\Program Files\\TacticalAgent\\tacticalrmm.exe\nC:\\Program Files\\TacticalAgent\\unins000.exe\n</code></pre> <p>Next, add an exception for:</p> <pre><code>C:\\ProgramData\\TacticalRMM\n</code></pre> <p>Select all available options.</p> <p></p> <p>For the sake of caution, add the following and select the Online Threat Prevention option:</p> <pre><code>C:\\Program Files\\Mesh Agent\\*\nC:\\Program Files\\TacticalAgent\\*\nC:\\ProgramData\\TacticalRMM\\*\n</code></pre> <p>Add exceptions for your T-RMM URLs as well.</p> <p>That should be all that's needed, unless BitDefender complains about the T-RMM agent installation file, in which case you'll need to add an exception for it as well, selecting all available options, then re-download it and save it in the same location to be safe.</p>"},{"location":"3rdparty_bomgar/","title":"Bomgar / BeyondTrust Remote Support","text":""},{"location":"3rdparty_bomgar/#bomgar-beyondtrust-integration","title":"Bomgar / BeyondTrust Integration","text":"<p>Info</p> <p>To make this work you will need to already have the Bomgar / BeyondTrust agent pinned, installed, and running on a Bomgar Guest.</p> <p>In TRMM go to Global Settings &gt; URL ACTIONS.</p> <p>Add a URL Action: Name = <code>Bomgar Connect</code> Description = <code>Open Bomgar and Start Session</code> URL Pattern =</p> <pre><code>https://&lt;your_Bomgar_FQDN&gt;/api/client_script??type=rep&amp;operation=generate&amp;action=start_jump_item_session&amp;client.hostname={{agent.hostname}}&amp;client.private_ip={{agent.local_ips}}&amp;jump.method=pinned&amp;session.custom.custom_field1=Custom%20Value&amp;session.custom.custom_field2=123Note:\n</code></pre> <p></p> <p>Click\u00a0Summit</p> <p>Give it a second to execute, then right click the agent that you are working with and go to\u00a0Run URL Action &gt; BomgarConnect.</p> <p>It should ask you to sign into your Bomgar Representative Console if you are not already logged in and launch the session.</p>"},{"location":"3rdparty_dashy/","title":"Dashy","text":""},{"location":"3rdparty_dashy/#dashy-integration","title":"Dashy Integration","text":"<p>Info</p> <p>This is a Dashy integration for Tactical RMM to see server status in your dashboard.</p>"},{"location":"3rdparty_dashy/#enable-monitoring-endpoint","title":"Enable Monitoring Endpoint","text":"<p>SSH into your TRMM server as the user who installed Tactical</p> <p>Edit the <code>local_settings.py</code> file found at /rmm/api/tacticalrmm/tacticalrmm</p> <p>Add a new line at the botton with <code>MON_TOKEN</code> and give it a secure token value</p> <p><code>MON_TOKEN = \"fahlidufuidavb389fgw4a730gha0v9a0sdv8cyv\"</code></p> <p>Now run the command <code>sudo systemctl restart rmm</code></p>"},{"location":"3rdparty_dashy/#add-widget-to-dashboard","title":"Add Widget to Dashboard","text":"<p>While in the config editor add the widget to your desired section.</p> <p></p> <p>Widget Options: useProxy = <code>true</code> type = <code>trmm</code> options: token = <code>Your MON_TOKEN</code> url = <code>Api url of your instance</code></p> <p>Preview or save your config and you should now see the Tactical RMM Status widget.</p> <p></p>"},{"location":"3rdparty_grafana/","title":"Adding Grafana to Tactical RMM","text":"<p>Adding graphical dashboards to Tactical.</p> <p>See https://github.com/dinger1986/TRMM-Grafana</p> <p></p> <p></p>"},{"location":"3rdparty_n-able-takecontrol/","title":"N-Able TAKE CONTROL","text":""},{"location":"3rdparty_n-able-takecontrol/#n-able-take-control-integration-solarwinds-beanywhere","title":"N-Able Take Control Integration (Solarwinds / Beanywhere)","text":"<p>Info</p> <p>You can setup a full automation policy to collect the machine GUID but this example will collect from just one agent for testing purposes.</p> <p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents</p> <p>Add Custom Field Target = <code>Agent</code> Name = <code>TakeControlID</code> Field Type = <code>Text</code></p> <p>While in Global Settings go to URL ACTIONS</p> <p>Add a URL Action Name = <code>N-Able Take Control</code> Description = <code>Connect to a Take Control Session</code> URL Pattern =</p> <p><pre><code>mspasp://{{agent.TakeControlID}}\n</code></pre> Add script with this name Take Control - Get TakeControlID for client:</p> <pre><code>$ConfigPath = $Env:ProgramData + \"\\GetSupportService\\BASupSrvc.ini\"\n$ResultsIdSearch = Select-String -Path $ConfigPath -Pattern ServerUniqueID\n$Result = @($ResultsIdSearch -split '=')\n$id = $Result[1]\n$Text = \"-s \" + $id\n$ENCODED = [Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($Text))\nWrite-Output $ENCODED\n</code></pre> <p>Navigate to an agent with Take Control running (or apply using Settings &gt; Automation Manager).</p> <p>Go to Tasks. Add Task Select Script = <code>Take Control - Get TakeControlID for client</code> Descriptive name of task = <code>Collects the TakeControlID.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>TakeControlID</code></p> <p>Click Next Add Schedule Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute then right click the agent that you are working with and go to Run URL Action &gt; N-Able Take Control</p> <p>It launch the session in Take Control desktop Console.</p>"},{"location":"3rdparty_rustdesk/","title":"RustDesk","text":""},{"location":"3rdparty_rustdesk/#to-install-rustdesk-and-use-it-with-tactical-rmm-you-need-to-the-the-following","title":"To install Rustdesk and use it with Tactical RMM you need to the the following.","text":"<ol> <li>Install your own RustDesk Server, following their official docs and open ports.</li> <li>Create the following scripts (all are powershell).</li> <li>Create a URL Action.</li> <li>Create custom fields for the RustDesk ID and password.</li> <li>Create collector tasks and Script Checks</li> <li>Enjoy :)</li> </ol>"},{"location":"3rdparty_rustdesk/#install-script-replace-ipaddress-and-key","title":"Install Script Replace IPADDRESS and KEY","text":"<pre><code>$ErrorActionPreference= 'silentlycontinue'\n\nIf (!(Test-Path c:\\Temp)) {\n  New-Item -ItemType Directory -Force -Path c:\\Temp &gt; null\n}\n\ncd c:\\Temp\n\npowershell Invoke-WebRequest \"https://github.com/rustdesk/rustdesk/releases/download/1.2.2/rustdesk-1.2.2-x86_64.exe\" -Outfile \"rustdesk.exe\"\nStart-Process .\\rustdesk.exe --silent-install -wait\n\n$ServiceName = 'Rustdesk'\n$arrService = Get-Service -Name $ServiceName -ErrorAction SilentlyContinue\n\nif ($arrService -eq $null)\n{\n    Start-Sleep -seconds 20\n}\n\nwhile ($arrService.Status -ne 'Running')\n{\n    Start-Service $ServiceName\n    Start-Sleep -seconds 5\n    $arrService.Refresh()\n}\nnet stop rustdesk\n\n$username = ((Get-WMIObject -ClassName Win32_ComputerSystem).Username).Split('\\')[1]\nRemove-Item C:\\Users\\$username\\AppData\\Roaming\\RustDesk\\config\\RustDesk2.toml\nNew-Item C:\\Users\\$username\\AppData\\Roaming\\RustDesk\\config\\RustDesk2.toml\nSet-Content C:\\Users\\$username\\AppData\\Roaming\\RustDesk\\config\\RustDesk2.toml \"rendezvous_server = 'IPADDRESS' `nnat_type = 1`nserial = 0`n`n[options]`ncustom-rendezvous-server = 'IPADDRESS'`nkey = 'KEY='`nrelay-server = 'IPADDRESS'`napi-server = 'https://IPADDRESS'\"\nRemove-Item C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Roaming\\RustDesk\\config\\RustDesk2.toml\nNew-Item C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Roaming\\RustDesk\\config\\RustDesk2.toml\nSet-Content C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Roaming\\RustDesk\\config\\RustDesk2.toml \"rendezvous_server = 'IPADDRESS' `nnat_type = 1`nserial = 0`n`n[options]`ncustom-rendezvous-server = 'IPADDRESS'`nkey = 'KEY='`nrelay-server = 'IPADDRESS'`napi-server = 'https://IPADDRESS'\"\n\nnet start rustdesk\n</code></pre>"},{"location":"3rdparty_rustdesk/#rustdesk-get-id-collector-script-needs-custom-agent-field","title":"RustDesk Get ID (Collector Script needs Custom Agent Field)","text":"<pre><code>$ErrorActionPreference= 'silentlycontinue'\n\ncd $env:ProgramFiles\\RustDesk\\\n.\\RustDesk.exe --get-id | out-host\n</code></pre>"},{"location":"3rdparty_rustdesk/#create-script-to-be-used-as-a-check","title":"Create Script to be used as a Check","text":"<pre><code>$ErrorActionPreference= 'silentlycontinue'\n\n$confirmation_file = \"C:\\program files\\RustDesk\\rdrunonce.txt\"\n\nif ([System.IO.File]::Exists($confirmation_file)) {\n    echo \"Confirmation file exists\"\n    exit 0\n}\nelse\n{\n    echo \"Confirmation file doesn't exists\"\n    exit 1\n}\n</code></pre>"},{"location":"3rdparty_rustdesk/#rustdesk-set-and-get-password-collector-script-needs-custom-agent-field-to-run-on-check-failure","title":"RustDesk Set and Get Password (Collector Script needs Custom Agent Field) to run on Check Failure","text":"<pre><code>$ErrorActionPreference= 'silentlycontinue'\n\n$confirmation_file = \"C:\\program files\\RustDesk\\rdrunonce.txt\"\n\nnet stop rustdesk &gt; null\n$ProcessActive = Get-Process rustdesk -ErrorAction SilentlyContinue\nif($ProcessActive -ne $null)\n{\nstop-process -ProcessName rustdesk -Force\n}\n\n$rustdesk_pw = (-join ((65..90) + (97..122) | Get-Random -Count 12 | % {[char]$_})) \nStart-Process \"$env:ProgramFiles\\RustDesk\\RustDesk.exe\" \"--password $rustdesk_pw\" -wait\nWrite-Output $rustdesk_pw\n\nnet start rustdesk &gt; null\n\nNew-Item $confirmation_file &gt; null\n</code></pre>"},{"location":"3rdparty_rustdesk/#rustdesk-url-action","title":"RustDesk URL Action","text":"<p><code>rustdesk://connection/new/{{agent.rustdeskid}}?password={{agent.rustdeskpwd}}</code></p>"},{"location":"3rdparty_rustdesk/#add-custom-agent-fields","title":"Add Custom Agent Fields","text":"<p><code>rustdeskid Type = Text</code> <code>rustdeskpwd Type = Text</code></p>"},{"location":"3rdparty_screenconnect/","title":"ScreenConnect / ConnectWise Control","text":""},{"location":"3rdparty_screenconnect/#connectwise-control-integration","title":"ConnectWise Control Integration","text":"<p>Info</p> <p>To make this work you will need the exact name of the windows service from one of your agents running a ScreenConnect Guest.</p> <p>Info</p> <p>You can setup a full automation policy to collect the machine GUID, but this example will collect from just one agent for testing purposes.</p> <p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents.</p> <p>Add Custom Field: Target = <code>Client</code> Name = <code>ScreenConnectService</code> Field Type = <code>Text</code> Default Value = <code>ScreenConnect Client (XXXXXXXX)</code> (make sure to copy paste the exact windows service name here)</p> <p></p> <p>Add Custom Field: Target = <code>Agent</code> Name = <code>ScreenConnectGUID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS</p> <p>Add a URL Action: Name = <code>ScreenConnect</code> Description = <code>Launch Screen Connect Session</code> URL Pattern =</p> <pre><code>https://&lt;your_screenconnect_fqdn_with_port&gt;/Host#Access/All%20Machines//{{agent.ScreenConnectGUID}}/Join\n</code></pre> <p></p> <p>Navigate to an agent with ConnectWise Service running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task: Descriptive name of task = <code>get screen connect GUID</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>ScreenConnectGUID</code> (Agent)</p> <p></p> <p>Click Next</p> <p>Select Script = <code>ScreenConnect - Get GUID for client</code> (this is a builtin script from script library) Script argument = <code>{{client.ScreenConnectService}}</code> (it should auto-fill)</p> <p>Click the plus sign</p> <p></p> <p></p> <p>Choose a schedule for the collector to run then add the task.</p> <p>Once the task has synced with the agent, right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute, refresh the tasks tab and then check the output of the task and make sure you see a GUID.</p> <p>Right click the agent that you are working with and go to Run URL Action &gt; ScreenConnect.</p> <p>It should ask you to sign into your ConnectWise Control server if you are not already logged in and launch the session.</p>"},{"location":"3rdparty_screenconnect/#install-screenconnect-via-tactical","title":"Install ScreenConnect via Tactical","text":"<p>Use the ScreenConnect AIO script</p> <p></p>"},{"location":"3rdparty_screenconnect/#install-tactical-rmm-via-screenconnect-commands-window","title":"Install Tactical RMM via ScreenConnect Commands Window","text":"<ol> <li>Create a Deployment under Agents &gt; Manage Deployments</li> <li>Replace <code>&lt;deployment URL&gt;</code> below with your Deployment Download Link.</li> </ol> <pre><code>#!ps\n#maxlength=500000\n#timeout=600000\n\nInvoke-WebRequest \"&lt;deployment URL&gt;\" -OutFile ( New-Item -Path \"c:\\ProgramData\\TacticalRMM\\temp\\trmminstall.exe\" -Force )\n$proc = Start-Process c:\\ProgramData\\TacticalRMM\\temp\\trmminstall.exe -ArgumentList '-silent' -PassThru\nWait-Process -InputObject $proc\n\nif ($proc.ExitCode -ne 0) {\n    Write-Warning \"$_ exited with status code $($proc.ExitCode)\"\n}\nRemove-Item -Path \"c:\\ProgramData\\TacticalRMM\\temp\\trmminstall.exe\" -Force\n</code></pre>"},{"location":"3rdparty_splashtop/","title":"Splashtop","text":""},{"location":"3rdparty_splashtop/#splashtop-integration","title":"Splashtop Integration","text":"<p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents.</p> <p>Add Custom Field: Target = <code>Agent</code> Name = <code>SplashtopSUUID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS.</p> <p>Add a URL Action: Name = <code>Splashtop</code> Description = <code>Connect to a Splashtop client</code> URL Pattern =</p> <pre><code>st-business://com.splashtop.business?account=&amp;uuid={{agent.SplashtopSUUID}}&amp;sessiontype=remote\n</code></pre> <p>Navigate to an agent with Splashtop running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task: Select Script = <code>Splashtop - Get SUUID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Obtain Splashtop SUUID from device registry.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>SplashtopSUUID</code></p> <p></p> <p>Click Next Check Manual Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute, then right click the agent that you are working with and go to Run URL Action &gt; Splashtop.</p>"},{"location":"3rdparty_supremo/","title":"Supremo","text":""},{"location":"3rdparty_supremo/#supremo-integration","title":"Supremo Integration","text":"<p>Info</p> <p>You can set up a full automation policy to collect the machine GUID, but this example will collect from just one agent for testing purposes.</p>"},{"location":"3rdparty_supremo/#create-custom-field","title":"Create Custom Field","text":"<p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents.</p> <p>Add Custom Field: Target = <code>Agent</code> Name = <code>SupremoID</code> Field Type = <code>Text</code></p>"},{"location":"3rdparty_supremo/#create-url-action-ref","title":"Create URL Action (Ref)","text":"<p>While in Global Settings go to URL ACTIONS.</p> <p>Add a URL Action: Name = <code>Supremo Control</code> Description = <code>Connect to a Supremo Session</code> URL Pattern =</p> <pre><code>Supremo:{{agent.SupremoID}}\n</code></pre>"},{"location":"3rdparty_supremo/#create-supremo-collector","title":"Create Supremo Collector","text":"<p>This populates the Custom field with the Supremo ID.</p> <p>Navigate to an agent with Supremo running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task: Select Script = <code>Supremo - Get ClientID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Collects the SupremoID for Supremo.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>SupremoID</code></p> <p>Click Next Check One Time, choose a time in the past so it'll run once on the agent. Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute, then right click the agent that you are working with and go to Run URL Action &gt; Supremo Control.</p> <p>It should launch the session in Supremo.</p> <p>Note</p> <p>You have to have Supremo installed on the local computer.</p>"},{"location":"3rdparty_teamviewer/","title":"TeamViewer","text":""},{"location":"3rdparty_teamviewer/#teamviewer-integration","title":"TeamViewer Integration","text":"<p>Info</p> <p>You can setup a full automation policy to collect the machine GUID, but this example will collect from just one agent for testing purposes.</p> <p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents.</p> <p>Add Custom Field: Target = <code>Agent</code> Name = <code>TeamViewerClientID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS.</p> <p>Add a URL Action: Name = <code>TeamViewer Control</code> Description = <code>Connect to a TeamViewer Session</code> URL Pattern =</p> <pre><code>https://start.teamviewer.com/device/{{agent.TeamViewerClientID}}/authorization/password/mode/control\n</code></pre> <p>Navigate to an agent with TeamViewer running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task: Select Script = <code>TeamViewer - Get ClientID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Collects the ClientID for TeamViewer.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>TeamViewerClientID</code></p> <p> </p> <p>Click Next Check Manual Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute, then right click the agent that you are working with and go to Run URL Action &gt; TeamViewer Control.</p> <p>It will launch the session and possibly prompt for a password in TeamViewer.</p>"},{"location":"3rdparty_zammad/","title":"Zammad","text":""},{"location":"3rdparty_zammad/#zammad-setup","title":"Zammad Setup","text":"<ol> <li> <p>Install Zammad:    Follow the installation instructions provided in the Zammad documentation.</p> </li> <li> <p>Generate API Token:</p> </li> <li>Click on your User Initials in Zammad.</li> <li>Navigate to Profile &gt; Token Access.</li> <li>Click \"Create\".</li> <li>Name the Token \"Tactical RMM\" and select \"Ticket Agent\".</li> <li> <p>Click \"Create\" to generate the token.</p> </li> <li> <p>Add Customers and Emails:    Ensure each customer in Zammad has a corresponding email associated.</p> </li> </ol>"},{"location":"3rdparty_zammad/#tactical-rmm-setup","title":"Tactical RMM Setup","text":"<ol> <li>Add Custom Field in Sites:</li> <li>Add a custom field under Sites called <code>Zammad-Email</code></li> <li> <p>Populate this field with the corresponding email addresses from Zammad to match up with customers.</p> </li> <li> <p>Add Webhook:</p> </li> <li> <p>URL Pattern: <code>https://your_zammad_domain.com/api/v1/tickets</code></p> </li> <li> <p>Method: POST</p> </li> <li> <p>Request Headers: <pre><code>{\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Bearer your_generated_token_here\"\n}\n</code></pre></p> </li> </ol> <p>Replace your_generated_token_here with the actual API token generated from Zammad.</p> <ol> <li>Request Body: <pre><code>{\n\"title\": \"{{ alert.severity }} on {{ agent.hostname }}\",\n\"group\": \"Users\",\n\"customer\": \"{{ client.Zammad-Email }}\",\n\"article\": {\n    \"subject\": \"{{ alert.severity }} on {{ agent.hostname }}\",\n    \"body\": \"Client: {{agent.site.client.name}}, Site: {{agent.site.name}}: {{ alert.message }} at {{ alert.alert_time }}\",\n    \"type\": \"note\",\n    \"internal\": false\n}\n}\n</code></pre></li> <li><code>{{ alert.severity }}</code>, <code>{{ agent.hostname }}</code>, <code>{{ alert.message }}</code>, and <code>{{ alert.alert_time }}</code> are placeholders that will be replaced with actual data from Tactical RMM alerts.</li> <li> <p><code>{{ client.Zammad-Email }}</code> refers to the custom field you added under Sites where you store the corresponding Zammad email for each customer.</p> </li> <li> <p>Add Webhook to Alert Policy:</p> <ul> <li>Assign the webhook to the appropriate Alert Policy that is assigned to customers in Tactical RMM.</li> </ul> </li> </ol>"},{"location":"3rdparty_zammad/#notes","title":"Notes:","text":"<ul> <li>Ensure that the API token in the Authorization header (Bearer your_generated_token_here) has the necessary permissions (e.g., ticket.agent) to create tickets in Zammad.</li> <li>Adjust the title, group, customer, article fields in the request body as per your specific requirements and Zammad's API capabilities.</li> <li>Test the integration thoroughly to ensure that alerts from Tactical RMM are correctly creating tickets in Zammad with the expected data.</li> </ul>"},{"location":"advanced_commands/","title":"Advanced commands","text":""},{"location":"advanced_commands/#advanced-commands","title":"Advanced Commands","text":"<pre><code>Everything you find on this page is dangerous. \n\nThe first rule of TRMM Club is: You do not talk about TRMM Club.\nThe second rule of TRMM Club is: You do not talk about TRMM Club.\n</code></pre> <p>Danger</p> <p>Use all commands here with caution, there is no undo. Have backups. You have been warned.</p>"},{"location":"advanced_commands/#server-commands","title":"Server Commands","text":""},{"location":"advanced_commands/#remove-agent-history-for-one-agent","title":"Remove agent history for one agent","text":"<p>Permanently deletes all history records for a specific agent. This is useful for cleaning up agents with corrupted history or reducing database size for agents.</p> <p>Keywords: <code>agent history</code>, <code>delete history</code>, <code>cleanup</code>, <code>database maintenance</code>, <code>audit trail</code>, <code>task history</code>, <code>agent cleanup</code></p> <p>Parameters: - Replace <code>CHANGEME</code> with the exact hostname of the target agent - Ensure the agent hostname exists before running the command</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py shell -c 'from agents.models import Agent,AgentHistory;agent = Agent.objects.get(hostname=\"CHANGEME\");to_delete = AgentHistory.objects.filter(agent=agent).values_list(\"id\", flat=True);AgentHistory.objects.filter(id__in=to_delete).delete()'\n</code></pre>"},{"location":"advanced_commands/#get-mapping-of-agent-id-to-mesh-id","title":"Get mapping of agent ID to mesh ID","text":"<p>TRMM Agent unique ID and MeshCentral nodeID</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py shell -c 'from agents.models import Agent; [print((i.agent_id, f\"node//{i.hex_mesh_node_id}\")) for i in Agent.objects.only(\"mesh_node_id\") if i.mesh_node_id and i.hex_mesh_node_id != \"error\"]'\n</code></pre>"},{"location":"advanced_commands/#maintenance-mode-toggle-for-all-agents","title":"Maintenance mode toggle for all agents","text":"<p>Set all agents in Maintenance Mode</p> <pre><code>echo \"from agents.models import Agent; Agent.objects.update(maintenance_mode=True)\" | /rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py shell\n</code></pre> <p>Undo all agents from Maintenance Mode</p> <pre><code>echo \"from agents.models import Agent; Agent.objects.update(maintenance_mode=False)\" | /rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py shell\n</code></pre>"},{"location":"av/","title":"Antivirus","text":"<p>They are usually fraught with false-positives because we live in a world of complex greys, not black and white.</p> <p>We are facing significant challenges due to the stringent policies of antivirus companies. Antivirus software is a critical tool for safeguarding Windows systems against viruses, trojans, and other malicious threats. However, the aggressive approach of some antivirus companies towards virus and trojan protection often results in legitimate software, such as Tactical RMM, being misclassified as malware.</p> <p>For instance, Tactical RMM is designed to assist IT professionals and system administrators in managing and monitoring systems remotely. This, while essential for operational efficiency and security, can sometimes be flagged by antivirus solutions as potential threats. This classification occurs despite the primary use of Tactical RMM for legitimate, constructive purposes. The rationale behind such decisions is that if a tool could potentially be leveraged for malicious activities, it must be treated as a threat. This stance overlooks the reality that the majority of users employ these tools for valid and positive reasons. </p> <p>Some antivirus companies adopt a slightly more nuanced approach by labeling these tools as \"Security Threats\" or \"Riskware.\" While this is a less severe classification than labeling them as viruses or trojans, it still hinders users by quarantining or deleting the tools, effectively preventing their use. Moreover, the distinction between \"Virus\" and \"Riskware\" is lost on many users, leading to confusion and undue concern and why do they not class other RMMs the same?</p> <p>The issue of overzealous protection is not unique to Tactical RMM. Other developers, both small and large, encounter similar problems with antivirus software flagging their products without clear justification. Examples include utilities that do not even involve password recovery or system monitoring but still face unwarranted scrutiny and restriction. In fact we can see NirSoft 15 years ago wrote a similar blog about this.</p> <p>The challenge extends beyond individual developers to affect the broader ecosystem. Small developers, in particular, struggle with the ramifications of these false positives, lacking the resources and legal clout that larger companies possess to quickly address and resolve these issues.</p> <p>To mitigate these challenges, it is crucial for both users and developers to engage more proactively with antivirus companies. This involves reporting false positives, providing feedback on software classifications, and advocating for a more balanced approach that recognizes the legitimate use of Tactical RMM. Ultimately, greater awareness and communication can help ensure that essential tools are not unjustly penalized, supporting a more secure and efficient digital environment. Remember YOU are the antivirus companies customer, YOU by reporting these false positives can help!</p> <p>At the moment, Microsoft Windows Defender thinks a go executable with virtually nothing in it is the \"Trojan:Win32/Wacatac.B!ml\" virus https://old.reddit.com/r/golang/comments/s1bh01/goexecutables_and_windows_defender/.</p> <ul> <li>Windows Defender ranks as one of the top AVs and can be largely controlled via Tactical. Read more about Defender detection rates etc here.</li> <li>Use the <code>Defender Status Report</code> script (Task &gt; Run Daily - Use Automation manager) to monitor machines: https://github.com/amidaware/community-scripts/blob/main/scripts/Win_Defender_Status_Report.ps1.</li> <li>If you want to lock a system down, run the <code>Defender Enable</code> script (test in your environment, because it can stop Microsoft Office from opening docs among MANY other things) that will turn on Protected Folders: https://github.com/amidaware/community-scripts/blob/main/scripts/Win_Defender_Enable.ps1 and you will be extremely safe. Annoyed, and unable to do lots of dangerous things like opening files from the internet and email...but safe. Use this as an Exclusion List for Protected Folders items.</li> </ul> <p>Be aware there is also a PowerShell script to add TRMM exclusions specific to Windows Defender.</p> <p>Is Code Signing worth it?</p> <p>Note</p> <p>If you need to use 3rd party AV, add the necessary exclusions (see below for examples) and submit the exes as safe.</p>"},{"location":"av/#your-todo-list","title":"Your TODO List","text":"<ol> <li>You need to manage your AV exclusions.</li> <li>If AV incorrectly flags TRMM agent or mesh agent, submit a report to the relevant AV vendor.</li> </ol>"},{"location":"av/#bitdefender-gravityzone","title":"Bitdefender Gravityzone","text":"<p>Admin URL: https://cloud.gravityzone.bitdefender.com/</p> <p>To exclude the Tactical and MeshCentral agents, go to Policies &gt; {policy name} &gt; Antimalware &gt; Settings &gt; Custom Exclusions.</p> <p></p> <p>Add the following exclusions. The ATS/IDS module does not support file exclusions, only folder exclusions.</p> File Excluded Items Modules Notes Folder <code>C:\\ProgramData\\TacticalRMM\\</code> On-demand, On-Access, ATC/IDS All TRMM scripts are saved here to run Folder <code>%ProgramFiles%\\Mesh Agent\\</code> On-demand, On-Access, ATC/IDS Excludes Mesh Agent from ATC/IDS Folder <code>%ProgramFiles%\\TacticalAgent\\</code> On-demand, On-Access, ATC/IDS Excludes TacticalAgent from ATC/IDS Process <code>%ProgramFiles%\\Mesh Agent\\MeshAgent.exe</code> On-Access, ATC/IDS Excludes <code>Mesh Agent</code> service (process) from ATC/IDS Process <code>%ProgramFiles%\\TacticalAgent\\tacticalrmm.exe</code> On-Access, ATC/IDS Excludes <code>tacticalrmm</code> service (process) from ATC/IDS File <code>%ProgramFiles%\\Mesh Agent\\MeshAgent.exe</code> On-demand, On-Access This may not be needed since the entire folder is excluded File <code>%ProgramFiles%\\TacticalAgent\\tacticalrmm.exe</code> On-demand, On-Access This may not be needed since the entire folder is excluded <p></p> <p>To exclude URLs: Policies &gt; {policy name} &gt; Network Protection &gt; Content Control &gt; Settings &gt; Exclusions</p> <p></p> <p></p>"},{"location":"av/#webroot","title":"Webroot","text":"<p>Admin URL:</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"av/#sentinel-one","title":"Sentinel One","text":"<p>First log into your SentinelOne account</p> <p>Go To Sentinels (from the sidebar) &gt; Exclusions &gt; New Exclusion &gt; Create Exclusion </p> <p>Choose the Path option in the New Exclusion window </p> <p>Add the Following Paths:</p> <ul> <li><code>C:\\ProgramData\\TacticalRMM\\</code></li> <li><code>%ProgramFiles%\\Mesh Agent\\</code></li> <li><code>%ProgramFiles%\\TacticalAgent\\</code></li> </ul> <p>Choose Suppress Alerts in Exclusions mode </p> <p>Save and Apply Policy to Devices</p>"},{"location":"av/#sophos","title":"Sophos","text":""},{"location":"av/#sophos-central-admin","title":"Sophos Central Admin","text":"<p>Go To Global Settings &gt; General &gt; Global Exclusions &gt; Add Exclusion</p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"av/#sophos-xg-firewall","title":"Sophos XG Firewall","text":"<p>Log into Sophos Central Admin:</p> <p>Admin URL: https://cloud.sophos.com/</p> <p>Log into the Sophos XG Firewall.</p> <p>Go To System &gt; Hosts and services &gt; FQDN Host Group and create a new group.</p> <p></p> <p>Go To System &gt; Hosts and services &gt; FQDN Host.</p> <p>Create the following 3 hosts and add each to your FQDN host group.</p> <ul> <li>api.yourdomain.com</li> <li>mesh.yourdomain.com</li> <li>rmm.yourdomain.com (Optional if you want your client to have GUI access to Tactical RMM)</li> </ul> <p></p> <p></p> <p>Go To Hosts and services &gt; Services and create the following services:</p> <ul> <li>Name: Tactical-Service-443<ul> <li>Protocol: TCP</li> <li>Source port: 1:65535</li> <li>Destination port: 443</li> </ul> </li> </ul> <p></p> <p></p> <p>Go To Hosts and services &gt; Service group and create the following service group:</p> <p></p> <p>Go To Protect &gt; Rules and policies and add a firewall rule:</p> <ul> <li>Rule name: Tactical Rule</li> <li>Rule position: Top</li> <li>Source zones: LAN</li> <li>Source networks: ANY</li> <li>Destination zones: WAN</li> <li>Destination networks: Your FQDN Host Group</li> <li>Services: Tactical Services</li> </ul> <p></p> <p></p> <p>Optionally select Log Firewall Traffic checkbox for troubleshooting.</p>"},{"location":"av/#eset-protect-console","title":"ESET PROTECT Console","text":"<p>There are three areas where you need to configure exclusions:</p> <ol> <li> <p>Detection Engine &gt; Performance Exclusions </p> </li> <li> <p>Web Access Protection &gt; URL Address Management &gt; List of addresses excluded from content scan </p> </li> <li> <p>Web Access Protection &gt; URL Address Management &gt; List of allowed addresses </p> </li> </ol>"},{"location":"av/#utm-filter-bypasses","title":"UTM Filter Bypasses","text":"<p>Use the below if your UTM blocks installation of Tactical RMM</p> <p><code>^https?://([A-Za-z0-9.-]*\\.)?tacticalrmm\\.com\\.?/</code></p>"},{"location":"backup/","title":"Backup","text":""},{"location":"backup/#backing-up-the-rmm","title":"Backing up the RMM","text":"<p>Note</p> <p>This is only applicable for the standard install, not Docker installs.</p> <p>A backup script is provided for quick and easy way to backup all settings/data into one file to migrate to another server.</p> <p>Warning</p> <p>The backup script does not self update itself. Always make sure you have latest version from the master branch by verifying the <code>SCRIPT_VERSION</code> at the top of the file matches.</p> <p>Make sure you are logged into the user you used to install TRMM eg <code>tactical</code>. Then download and run the backup script:</p> <pre><code>wget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/master/backup.sh\nchmod +x backup.sh\n./backup.sh\n</code></pre> <p>The backup tar file will be saved in <code>/rmmbackups</code> with the following format:</p> <p><code>rmm-backup-CURRENTDATETIME.tar</code></p>"},{"location":"backup/#schedule-to-run-daily-via-cron","title":"Schedule to run Daily via Cron","text":"<p>Note</p> <p>You MUST enable passwordless sudo for your linux user or you won't get all files backed up, do a dry run first before setting up a schedule! You should verify this also by doing a test restore or verify the files have content.</p> <p>To schedule automated daily backups run the script with the <code>--schedule</code> flag</p> <pre><code>./backup.sh --schedule\n</code></pre> <p>This will do the following:</p> <ul> <li> <p>Create daily, weekly and monthly folders under /rmmbackup.</p> </li> <li> <p>Schedule backups using cron to run at midnight every night.</p> </li> <li> <p>As well as Daily backups, there are monthly backups on the 10th day of every month and weekly backups every Friday.</p> </li> <li> <p>Automated pruning of backup files, daily kept for 2 weeks, weekly for 2 months and monthly for 1 year. To calculate estimated disk needs, take the size of a manual backup and * 37. eg 600MB backup * 37 = 22.2GB of space needed.           Calculate Backup Size (in MB): MB *  =  Total Space needed MB </p> </li> </ul> <p>Warning</p> <p>The backup script will just save to your server drive, you ideally want to automate moving this to another server. Please ensure you have space for the backups to be stored.</p>"},{"location":"backup/#video-walkthru","title":"Video Walkthru","text":""},{"location":"backup/#backup-testing","title":"Backup Testing","text":"<p>See Restore Testing</p>"},{"location":"code_signing/","title":"Code Signing","text":"<p>Version added: Tactical RMM v0.6.0 / Agent v1.5.0 (April 2021)</p> <p>Tactical RMM agents are now code signed!</p> <p>To get access to code signed agents (which also includes Linux/macOS agents) and Single Sign-On, you must be a Sponsor with a minimum monthly Tier 1 sponsorship.</p> <p>To get access to our Reporting feature, you must be a sponsor with a minimum monthly Tier 2 sponsorship. Exceptions will be made for Founders and Non-Profits which will only require Tier 1.</p> <p>One token is valid for 1 self hosted instance. If you have more than 1 instance please contact support for pricing options.</p> <p>Once you have become a Sponsor, open a support ticket and choose the \"Code Signing Request\" layout.</p> <p></p> <p>Select the payment method you paid with from the dropdown.</p> <p>If you sponsored via Stripe or Paypal and your contact email is different from the email you used to pay, please let us know that in the ticket.</p> <p>Enter the API subdomain you will be using for your instance (e.g. <code>api.example.com</code>).</p> <p>If you already have an existing token and want to switch your sponsorship from github to stripe/paypal, make sure to mention that in the ticket description and include your github username. Don't forget to also cancel your github sponsorship after you have successfully setup Paypal/Stripe.</p> <p>If you have joined our Discord and would like to be added to the sponsors role, include your Discord username as well.</p> <p>Please allow up to 24 hours for a response.</p>"},{"location":"code_signing/#how-does-it-work","title":"How does it work?","text":"<p>Every time you generate an agent or an agent does a self-update, your self-hosted instance sends a request to Tactical's code signing servers with your auth token.</p> <p>If the token is valid, the server sends you back a code signed agent. If not, it sends you back the un-signed agent.</p> <p>If you think your auth token has been compromised or stolen then please open a ticket to get a new token / invalidate the old one.</p>"},{"location":"code_signing/#why-should-i-pay-for-code-signing","title":"Why should I pay for Code Signing?","text":"<ol> <li>Code signing costs a lot of money. OV code signing requires a legitimate legal business...Amidaware was setup for this purpose. Code signing + operating a business costs thousands of dollars a year.</li> <li>It helps the project move forward and it can supports devs spending time on it, they have lives, wives, jobs and kids which all demands attention.</li> <li>It should stop bad actors using it maliciously.</li> <li>It helps with Antivirus products detecting it as being malicious.</li> </ol>"},{"location":"code_signing/#tactical-rmm-is-getting-flagged-as-pua-or-virus-will-this-fix-it","title":"Tactical RMM is getting flagged as PUA or virus, will this fix it?","text":"<p>Getting a code signed agent helps, but it is not guaranteed to eliminate this entirely. This is because AVs are unpredictable, changing all the time, constantly making new decisions and rules, telling you one thing and doing another, all doing different things in slightly different ways, etc.</p> <p>However, the best way to submit a whitelisting request to your AV for the TRMM agent... is having a code signed exe to submit.</p> <p>Right click <code>\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\"</code> &gt; <code>Properties</code> &gt; <code>Digital Signatures</code> tab.</p>"},{"location":"code_signing/#code-signing-certificate-info","title":"Code signing certificate info","text":"<p>Digicert OV code signing cert used by agents v2.9.0 and higher:</p> <ul> <li> <p>Serial Number: <code>0108a89f4540182a1dfc246db61a0e89</code></p> </li> <li> <p>Thumb Print: <code>9b38bdd4327297c8b87505119dbc8305379335bc</code></p> </li> </ul> <p>Digicert OV code signing cert used by agents v2.7.0 and v2.8.0:</p> <ul> <li> <p>Serial Number: <code>0f558fcc46f23aa4e2688052f3a9459f</code></p> </li> <li> <p>Thumb Print: <code>5f67afdbb3adc263965f5ed0c732e45575434449</code></p> </li> </ul> <p>Digicert OV code signing used by agents v2.6.2 and below:</p> <ul> <li> <p>Serial Number: <code>0fef30ccce9d30183067160018796558</code></p> </li> <li> <p>Thumb Print: <code>0e4844266294100d3f93e1cc7eecf61e9206bb14</code></p> </li> </ul> <p>Amidaware code signing used only by the dynamic EXE installer after May 3, 2024 at 4:59 PM PST:</p> <ul> <li> <p>Serial Number: <code>0229c833c9bda1fe0a306f4b12b6ab3cf40f5790</code></p> </li> <li> <p>Thumb Print: <code>17a930357440276bfaee23220e2f7e8f1a208556</code></p> </li> </ul> <p>Amidaware Code Signing Root CA:</p> <ul> <li> <p>Serial Number: <code>2d4486df7eba0c6659d79106783caac1a83ffb41</code></p> </li> <li> <p>Thumb Print: <code>45492337c44055dbb3910a90d4ed02758ebc0ebd</code></p> </li> </ul>"},{"location":"code_signing/#code-signing-changes-for-dynamic-exe-installers","title":"Code Signing Changes for Dynamic EXE Installers","text":"<p>Starting May 3, 2024, at 4:59 PM PST, all new dynamically generated EXE installers, including deployment link installers, will now be signed with Amidaware's own code signing certificate, issued by Amidaware's Code Signing Root CA. This change has been prompted by industry-wide modifications to code signing practices, which now necessitate the use of hardware tokens or HSMs (Hardware Security Modules). These requirements make it unfeasible for us to continue using our Digicert code signing certificate for signing these dynamically generated installers.</p> <p>While we have already transitioned to using Digicert's HSM to store our private key, this approach now incurs a cost for each executable signed. Given the volume of dynamic EXEs we currently generate and sign for all our customers, currently around 250,000 per month as of May 2024, this would result in costs around $62,000.00 USD per month\u2014an unsustainable increase from the previously nonexistent cost.</p> <p>Please note that the Inno Setup installer (<code>tacticalagent-vX.X.X-windows-arch.exe</code>), utilized by both the Powershell and Manual installation methods, as well as the agent update method, will continue to be signed with our Digicert OV code signing certificate. The <code>tacticalrmm.exe</code> agent binary will also continue being signed with our Digicert OV cert.</p> <p>As a reminder, the dynamic EXE installer is a generally one-time use standalone program that simply serves as a convenience wrapper around the Manual installation method. It automates the process by downloading the Inno Setup installer and executing it with the necessary command-line arguments\u2014mirroring the functionality provided by the Powershell installer but delivered in an EXE format.</p>"},{"location":"code_signing/#optional-root-ca-installation-for-dynamic-exe-installers","title":"Optional Root CA Installation for Dynamic EXE Installers:","text":"<p>For those using the dynamic EXE installation method, installing Amidaware's Code Signing Root CA on your system before you attempt installation can help ensure a smoother installation process. This step is entirely optional and is not needed for existing agents of if you use any of the other installation methods. To install the Root CA, you can run the following PowerShell command (as admin):</p> <pre><code>Invoke-WebRequest -Uri \"https://amidaware.com/amidaware-root.crt\" -OutFile \"amida-root.crt\"; Import-Certificate -FilePath \"amida-root.crt\" -CertStoreLocation Cert:\\LocalMachine\\Root\n</code></pre>"},{"location":"contributing/","title":"Contributing","text":""},{"location":"contributing/#contributing-to-the-docs","title":"Contributing to the Docs","text":"<p>The source of the docs are https://github.com/amidaware/trmm-docs</p> <p>Docs are built with MKDocs for Material</p> <p>Please refer to the docs README for instructions on how to build and serve the docs locally.</p> <p>Open your browser and navigate to <code>http://yourserverip:8005</code></p> <p>Add/edit markdown files in the <code>docs/docs</code> folder and you'll see live changes at the url above.</p> <p>Edit <code>docs/mkdocs.yml</code> to edit structure and add new files.</p> <p>Full MKDocs documentation here</p> <p>Once finished, create a pull request to the <code>main</code> branch for review.</p>"},{"location":"contributing/#contributing-using-github-codespaces","title":"Contributing using GitHub Codespaces","text":"<p>Devcontainers is an open specification for developing with a preconfigured container setup. With devcontainers, you don't need SSH keys, <code>git clone</code>, or deal with the usual \"local setup\" tasks. Everything is configured in the container and you connect to it remotely. GitHub Codespaces is GitHub's version of devcontainers. Authentication is provided via your GitHub account. Before you start a Codespace, there are a few settings you should to be aware of.</p>"},{"location":"contributing/#cost-and-spending-limit","title":"Cost and spending limit","text":"<p>GitHub provides 120 core hours and 15 GB-month storage for free accounts. Please read GitHub's notes in detail to understand how much that provides. For clarity, here is the explanation of GB-month storage and core hour compute usage.</p> <ul> <li>The GB-month unit of storage is a time-based measurement, 1 GB-month being 1 GB of storage usage for one whole month. The disk space used by all of your codespaces and prebuilds is assessed once an hour and your current GB-month usage is recalculated. Therefore, while you have codespaces and prebuilds, your GB-month usage will increase throughout the month. For example, if the storage totals 15 GB, and remains unchanged throughout your monthly billing cycle, then you will have used 7.5 GB halfway through the month, and 15 GB at the end of the month. For more information, see \"About billing for storage usage\" later in this article.</li> <li>A \"core hour\" is a measure used for included compute usage. To calculate core hours, multiply the number of hours for which a codespace has been active by the multiplier in the pricing table later in this article. For the basic machine types, the multiplier is the number of processor cores in the machine that hosts the codespace. For example, if you use a 2-core machine for your codespace and it's active for an hour, you have used 2 core hours. If you use an 8-core machine for an hour, you have used 8 core hours. If you use an 8-core machine for two hours, you have used 16 core hours.</li> </ul> <p>By default, the spending limit is $0. This means the devcontainer will stop after the free tier has been exhausted. </p>"},{"location":"contributing/#creating-the-codespace","title":"Creating the codespace","text":"<p>Codespaces are created by clicking the <code>code</code> button and then the Codespaces tab. Codespaces are specific to a branch! If needed, create a new branch for your changes. Clicking the <code>+</code> will create the Codespace. Codespaces are paid for by you using the spencing limit mentioned above. This screenshot is from my account where I already have a codespace on this branch, <code>scaling pancake</code>.</p> <p></p>"},{"location":"contributing/#using-the-codespace","title":"Using the Codespace","text":"<p>It takes about 15 seconds for the Codespace to start in the browser. If you want to use Code on the desktop, click the <code>Codespaces</code> in the lower left corner (to open the command menu at top) and selection the option to \"Open in VS Code Desktop\". Once VS Code is open on the desktop, you can close the browser tab.</p> <p></p>"},{"location":"contributing/#committing-your-code","title":"Committing your code","text":"<p>As stated above, you don't need SSH keys to commit your changes. The Codespace is already authenticated with your GitHub account, and <code>git push</code> \"just works(tm)\". Of course you still need to <code>git add --update</code> or <code>git add .</code> followed by <code>git commit --message \"Some descriptive message for your change\"</code>.</p>"},{"location":"contributing/#stopping-the-codespace","title":"Stopping the Codespace","text":"<p>After committing your message, stop the Codespace by clicking the <code>Codespaces</code> in the lower left corner (to open the command menu at top) and selection the option to \"Stop Current Codespace\". See the screenshot above.</p>"},{"location":"contributing/#deleting-the-codespace","title":"Deleting the Codespace","text":"<p>Since you are billed for storage on a GB-month basis, it's best to delete the Codespace. Codespaces are disposable! Go to https://github.com/codespaces/ to view all your codespaces. Clicking on the Codespace will launch it! Instead, click the kebab menu on the right and select Delete. </p>"},{"location":"contributing/#help-somethings-wrong","title":"Help! Something's wrong","text":"<p>Remember, Codespaces are disposable! If something is wrong, go to your Codespace dashboard, https://github.com/codespaces/, and delete the Codespace. Uncommitted changes will be deleted. Create another Codespace and try again.</p>"},{"location":"contributing/#wrapping-up","title":"Wrapping up","text":"<p>Codespaces help the developer workflow but it doesn't replace the pull request process. You still need to submit the pull request like you normally would. The main advantage of using Codespaces is not having to <code>git clone</code> the repository.</p>"},{"location":"contributing_community_scripts/","title":"Community Scripts","text":""},{"location":"contributing_community_scripts/#script-library-naming-conventions","title":"Script Library Naming Conventions","text":""},{"location":"contributing_community_scripts/#file-names","title":"File Names","text":"<p>Under <code>/scripts</code> the file name should generally follow this format:</p> <pre><code>(Platform)_(Category or Function)_(What It Does).xxx\n</code></pre> <p>Platforms for now are:</p> <pre><code>all_\nWin_\nnix_bash_\nnix_zsh_macos_\nnix_sh_\nnix_sh_truenas_\nnix_bash_freepbx_\nios_\nandroid_\n</code></pre> <p>Good filename examples include:</p> <pre><code>Win_Azure_Mars_Cloud_Backup_Status.ps1\nWin_AzureAD_Check_Connection_Status.ps1\nWin_Network_DHCP_Set.bat\nWin_Network_DNS_Set_to_1.1.1.2.ps1\n</code></pre> <p>Info</p> <p>This is so that at a glance you can see if there is already a script with that function, and you can avoid duplication of functionality.</p>"},{"location":"contributing_community_scripts/#name-field-in-community_scriptsjson","title":"Name Field (in community_scripts.json)","text":"<p>Consider they are viewed in 3 different locations:</p> <p>Script Manager</p> <ul> <li> <p>List View (sortable by any column)</p> </li> <li> <p>Folder View (Grouped by Categories)</p> </li> </ul> <p>Run or Add Script</p> <ul> <li>Running scripts manually or adding tasks (or adding in Automation Manager).</li> </ul> <p>Info</p> <p>A good max length is 50-60 chars or less for display in these 3 locations.</p> <p>Make sure your Name roughly follows the order of file naming as above.</p> <pre><code>Category or Function - What It Does\n</code></pre> <p>Consider how the alphabetic sort will affect display.</p> <p></p>"},{"location":"contributing_community_scripts/#json-field-names","title":"JSON Field Names","text":"<p>Example</p> <pre><code>{\n    \"guid\": \"bfd61545-839b-45da-8b3d-75ffc4d43272\",\n    \"filename\": \"Win_Sophos_EndpointProtection_Install.ps1\",\n    \"submittedBy\": \"https://github.com/bc24fl/\",\n    \"name\": \"Sophos Endpoint Protection Install\",\n    \"description\": \"Installs Sophos Endpoint Protection via the Sophos API.  Products include Antivirus, InterceptX, MDR, Device Encryption.  The script requires API credentials, Custom Fields, and Arguments passed to script.  See script comments for details\",\n    \"args\": [\n      \"-ClientId {{client.SophosClientId}}\",\n      \"-ClientSecret {{client.SophosClientSecret}}\",\n      \"-TenantName {{client.SophosTenantName}}\",\n      \"-Products antivirus,intercept\"\n    ],\n    \"default_timeout\": \"3600\",\n    \"supported_platforms\": [\"windows\"],\n    \"shell\": \"powershell\",\n    \"category\": \"TRMM (Win):3rd Party Software\"\n  },\n</code></pre> <p>Notes</p> <p><code>guid</code>: Must be unique in the file.</p> <p><code>filename</code>: File with that name must exist in <code>/scripts</code> folder.</p> <p><code>submittedBy</code>: Get credit for creator.</p> <p><code>args</code>: default args pre-filled in arg field.</p> <p><code>default_timeout</code>: Sets the default timeout for the script.</p> <p><code>supported_platforms</code>: [\"windows\", \"linux\", \"darwin\"] (case sensitive, if missing, assumes all platforms are supported). <code>darwin</code>=macOS</p> <p><code>shell</code>: can be <code>powershell</code>, <code>cmd</code>, <code>python</code> or <code>shell</code></p> <p><code>syntax</code>: See scripting</p> <p><code>category</code>: Preferably use existing categories and format structure for library sorting, add new as needed.</p>"},{"location":"contributing_community_scripts/#making-script-files","title":"Making Script Files","text":"<p>Use the template to start with a good common structure.</p>"},{"location":"contributing_community_scripts/#good-habits","title":"Good Habits","text":"<ul> <li> <p>Try and make them fully self-contained.</p> </li> <li> <p>If they pull data from elsewhere, create comment notes at the top with references for others to audit/validate.</p> </li> <li> <p>Good folder locations to use for standardized things:</p> </li> </ul> <pre><code>c:\\ProgramData\\TacticalRMM\\\nc:\\ProgramData\\TacticalRMM\\scripts\nc:\\ProgramData\\TacticalRMM\\toolbox\nc:\\ProgramData\\TacticalRMM\\logs\nc:\\ProgramData\\TacticalRMM\\temp\n</code></pre> <ul> <li>Command Parameters are good. Optional command parameters for extra functions are better.</li> </ul> <pre><code>param(\n    [string] $Username,\n    [switch] $log,\n    [int] $numberofdays,\n    [array] $packages #separated by commas\n)\n</code></pre> <ul> <li>Add standardized Comment headers to scripts (include the first 2, more if appropriate):</li> </ul> <pre><code>&lt;#\n.SYNOPSIS\n    Short description\n    eg Check IP address\n\n.DESCRIPTION\n    Long description\n    eg Checks IP address on all local network adapters, and returns results\n\n.PARAMETER xx\n    Inputs to this cmdlet (if any)\n\n.PARAMETER yy\n    Inputs to this cmdlet (if any)\n\n.OUTPUTS\n    Output from this cmdlet (if any)\n\n.EXAMPLE\n    Example of how to use this cmdlet\n\n.EXAMPLE\n    Another example of how to use this cmdlet\n\n.NOTES\n    v1.0 1/1/2020 username notes\n    General notes\n#&gt;\n</code></pre>"},{"location":"contributing_community_scripts/#bad-habits","title":"Bad Habits","text":"<ul> <li> <p>Assumes non-standard configurations.</p> </li> <li> <p>Doesn't play well with other community scripts (reused names etc.).</p> </li> </ul>"},{"location":"contributing_community_scripts/#script-parameters","title":"Script Parameters","text":"<p>Easy for agent to see information passed this way. Shows up in logs. Has difficulty with parsing quotes <code>\"</code> and spaces.</p>"},{"location":"contributing_community_scripts/#script-env-vars-environment-variables","title":"Script Env vars (Environment Variables)","text":"<p>Good for things you want kept secret (API keys), and things that have quotes <code>\"</code> and spaces in them (eg paths).</p>"},{"location":"contributing_community_scripts/#useful-reference-script-examples","title":"Useful Reference Script Examples","text":"<p>RunAsUser (since Tactical RMM runs as system) https://github.com/amidaware/community-scripts/blob/main/scripts/Win_Display_Message_To_User.ps1</p> <p>Command Parameter Ninja https://github.com/amidaware/community-scripts/blob/main/scripts/Win_ScreenConnectAIO.ps1</p> <p>Optional Command Parameters and testing for errors https://github.com/amidaware/community-scripts/blob/main/scripts/Win_Computer_Rename.ps1</p>"},{"location":"contributing_community_scripts/#volunteers-needed","title":"Volunteers Needed","text":"<p>If you want to contribute back to the project there are a lot of scripts that need some TLC (Tender Loving Care) please peruse thru them in The Script WIP (Work In Progress): https://github.com/amidaware/community-scripts/tree/main/scripts_wip</p> <p>Discuss/ask questions in the Discord group here.</p> <p>What you can add is:</p> <ul> <li>Add standardized Comment headers per above.</li> <li>Consolidate and parameterize scripts where appropriate.</li> <li>Add $ExitCode and error conditions as appropriate.</li> <li>Contact @silversword in Discord if you need help doing Github additions/edits/adding to the community Library and have questions about Script Library Naming Conventions.</li> </ul>"},{"location":"contributing_reporting_templates/","title":"Reporting Templates","text":""},{"location":"contributing_reporting_templates/#template-names","title":"Template Names","text":"<p>Templates should be named in such a way it is clear and concise for others to know what the template does. </p>"},{"location":"contributing_reporting_templates/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, ensure you are:</p> <ul> <li>Familiar with the report data available in Tactical RMM. Read more about reporting here.</li> <li>Up and running with Tactical RMM, for testing purposes (you can safely use your live environment).</li> <li>Creating a new/unique Report Template, existing templates are available here.</li> </ul>"},{"location":"contributing_reporting_templates/#once-your-template-is-ready","title":"Once your template is ready:","text":"<ol> <li>Fork the Tactical RMM template repository on GitHub.</li> <li>Export your template from Tactical RMM Reporting manager by right clicking and clicking export.</li> <li>Create a new template in the templates folder and copy and paste in code or upload exported template.</li> <li>Create a pull request with a brief description of your template and why it's useful.</li> <li>The Tactical RMM team will review your submission and test it, provide tests pass etc your PR will be accepted, if theres issues feedback will be provided in the comments section of the PR.</li> </ol> <p>Thank you for contributing to Tactical RMM and helping enhance the reporting capabilities for all users!</p>"},{"location":"contributing_using_a_remote_server/","title":"Contributing Using a Remote Server","text":"<p>The below instructions are for a non-production server that has Tactical RMM installed and configured with a real domain. You can then use your own GitHub to push changes to and then submit a PR request to the TRMM <code>develop</code> branch (https://github.com/amidaware/tacticalrmm).</p> <p>Warning</p> <p>Do not attempt development of this kind on your production server.</p>"},{"location":"contributing_using_a_remote_server/#install-tactical-rmm","title":"Install Tactical RMM","text":""},{"location":"contributing_using_a_remote_server/#traditional-install","title":"Traditional install","text":"<p>This guide assumes you have done a Traditional Install.</p> <p>This is going to install your dev server at latest release version. If you want it to install latest dev, edit <code>install.sh</code> and remove this line after</p> <pre><code>git clone https://github.com/amidaware/tacticalrmm.git /rmm/\ncd /rmm\ngit config user.email \"admin@example.com\"\ngit config user.name \"Bob\"\ngit checkout master  # &lt;-------------Remove this line to be on latest code\n</code></pre>"},{"location":"contributing_using_a_remote_server/#install-vs-code-and-extensions","title":"Install VS Code and Extensions","text":"<p>Download VS Code here</p> <p>Download the Remote SSH Development Pack here</p>"},{"location":"contributing_using_a_remote_server/#configure-the-remote-development-server","title":"Configure the Remote Development Server","text":""},{"location":"contributing_using_a_remote_server/#connect","title":"Connect","text":"<p>The remote development server should already have Tactical RMM installed via the traditional install method.</p> <p>After the extension pack is installed in VS Code you will have a new button at the bottom-left of VS Code. You can select it and add your remote SSH host information.</p> <p></p>"},{"location":"contributing_using_a_remote_server/#configure","title":"Configure","text":"<p>Configuring a remote server for development work is necessary so that as you make changes to the code base it will automatically refresh and you can see the changes. It may be necessary to do a full browser refresh if changing styles.</p> <p>Disable RMM and Daphne services:</p> <pre><code>sudo systemctl disable --now rmm.service &amp;&amp; sudo systemctl disable --now daphne.service\n</code></pre> <p>Open /rmm/web/.env and make it look like the following:</p> <pre><code>DEV_URL = \"http://api.EXAMPLE.COM:8000\"\nAPP_URL = \"http://rmm.EXAMPLE.COM:8080\"\n</code></pre> <p>Open /rmm/api/tacticalrmm/tacticalrmm/local_settings.py</p> <p>Change:</p> <pre><code>DEBUG = True\nADMIN_ENABLED = True\n</code></pre> <p>Comment out:</p> <pre><code>#CORS_ORIGIN_WHITELIST = [\n#    \"https://rmm.example.com\"\n#]\n</code></pre> <p>Add</p> <pre><code>CORS_ORIGIN_ALLOW_ALL = True\n</code></pre> <p>Add the following to the ALLOWED HOSTS:</p> <pre><code>rmm.EXAMPLE.COM\n</code></pre>"},{"location":"contributing_using_a_remote_server/#install-dev-requirements-and-start-python","title":"Install dev requirements and start Python","text":"<p><code>cd /rmm/api/tacticalrmm/</code></p> <pre><code>source ../env/bin/activate\n</code></pre> <p>Install requirements</p> <pre><code>pip install -r requirements-dev.txt -r requirements-test.txt\n</code></pre> <p>Merge migrations</p> <pre><code>python manage.py migrate\n</code></pre> <p>Start Django backend</p> <pre><code>python manage.py runserver 0:8000\n</code></pre>"},{"location":"contributing_using_a_remote_server/#get-frontend-working","title":"Get frontend working","text":"<p>Open a new terminal and compile Quasar frontend.</p> <p>Change to any directory (your user home folder in Linux is fine)</p> <pre><code>cd ~\ngit clone https://github.com/amidaware/tacticalrmm-web.git\ncd tacticalrmm-web\n</code></pre> <p>Create .env file and put in:</p> <pre><code>PROD_URL = \"https://api.example.com\"\nDEV_URL = \"http://api.example.com:8000\"\nAPP_URL = \"http://rmm.example.com:8080\"\nDEV_PORT = \"8080\"\nUSE_HTTPS = false\n</code></pre> <p>Close and save.</p> <pre><code>npm install\nnpm install -g @quasar/cli\nquasar dev\n</code></pre> <p>Info</p> <p>If you receive a CORS error when trying to log into your server via localhost or IP, try the following:</p> <pre><code>rm -rf node_modules .quasar\nnpm install\nquasar dev\n</code></pre> <p>You should now have a localhost and IP based URL to view that has a live reload feature.</p>"},{"location":"contributing_using_a_remote_server/#configure-github-with-vs-code","title":"Configure GitHub with VS Code","text":"<p>Info</p> <p>Make sure you are submitting Pull Requests to the develop branch. Follow this guide for a good introduction to GitHub: https://www.digitalocean.com/community/tutorials/how-to-create-a-pull-request-on-github</p> <p>Make sure you are on develop branch:</p> <pre><code>git checkout develop\n</code></pre> <p>git remote -v should look like the following:</p> <pre><code>origin  https://github.com/yourusername/tacticalrmm.git (fetch)\norigin  https://github.com/yourusername/tacticalrmm.git (push)\nupstream https://github.com/amidaware/tacticalrmm.git (fetch)\nupstream https://github.com/amidaware/tacticalrmm.git (push)\n</code></pre> <p>You will commit the change to your GitHub and from within GitHub you can then submit a PR to the develop branch of wh1te909 Tactical RMM.</p> <p>More to come...</p>"},{"location":"contributing_using_browser/","title":"Contributing Using Web Browser","text":""},{"location":"contributing_using_browser/#getting-started","title":"Getting Started","text":""},{"location":"contributing_using_browser/#fork-project-in-github","title":"Fork project in Github","text":"<p>This is making a duplicate of the code under your Github that you can edit</p> <p>https://github.com/amidaware/tacticalrmm</p> <p></p>"},{"location":"contributing_using_browser/#make-edits","title":"Make edits","text":"<p>Make some changes</p> <p></p> <p></p>"},{"location":"contributing_using_browser/#request-your-changes-to-be-pulled-into-the-primary-repo-pull-request","title":"Request your changes to be pulled into the primary repo (Pull Request)","text":"<p>This is taking your changes and requesting they be integrated into the Tactical RMM develop branch.</p>"},{"location":"contributing_using_browser/#check-the-status-of-your-pr","title":"Check the status of your PR","text":"<p>Look at a summary of the changes you've requested, monitor for them to be accepted, or commented on.</p> <p>https://github.com/amidaware/tacticalrmm/pulls</p> <p>Once they're accepted you can either: * Delete your fork * Sync your local fork</p>"},{"location":"contributing_using_browser/#sync-your-fork","title":"Sync your fork","text":"<p>Bring changes from original repo to your fork so you're current with changes made in original Github repo:</p> <p></p> <p></p> <p>...or Official Github Docs</p>"},{"location":"contributing_using_browser/#lather-rinse-repeat","title":"Lather, rinse, repeat","text":"<p>Go to Step 2. and contribute some more.</p>"},{"location":"contributing_using_browser/#notes","title":"Notes","text":"<p>After your changes are accepted, they won't be live in Tactical RMM until there is a new release. #BePatient</p>"},{"location":"contributing_using_docker/","title":"Contributing Using Docker","text":""},{"location":"contributing_using_docker/#install-wsl2","title":"Install WSL2","text":"<p>https://docs.microsoft.com/en-us/windows/wsl/install-win10</p>"},{"location":"contributing_using_docker/#install-docker-desktop","title":"Install Docker Desktop","text":"<p>https://www.docker.com/products/docker-desktop</p>"},{"location":"contributing_using_docker/#configure-docker","title":"Configure Docker","text":"<p>Make sure it doesn't look like this:</p> <p></p> <p>This is better:</p> <p></p>"},{"location":"contributing_using_docker/#check-and-make-sure-wsl-is-v2-and-set-ubuntu-as-default","title":"Check and Make Sure WSL is v2 and Set Ubuntu as Default","text":"<p>https://docs.microsoft.com/en-us/windows/wsl/install-win10#set-your-distribution-version-to-wsl-1-or-wsl-2</p> <p></p>"},{"location":"contributing_using_docker/#install-vs-code-extensions","title":"Install VS Code Extensions","text":"<p>Remote - Containers</p> <p>Docker</p>"},{"location":"contributing_using_docker/#connect-to-wsl-and-clone-your-github-fork","title":"Connect to WSL and Clone Your Github Fork","text":""},{"location":"contributing_using_docker/#create-env-file","title":"Create .env File","text":"<p>Under .devcontainer duplicate:</p> <pre><code>.env.example\n</code></pre> <p>as</p> <pre><code>.env\n</code></pre> <p>Customize to your tastes (it doesn't need to be internet configured, just add records in your <code>hosts</code> file) eg:</p> <pre><code>127.0.0.1    rmm.example.com api.example.com mesh.example.com\n</code></pre>"},{"location":"contributing_using_docker/#launch-your-dev-vm-in-docker","title":"Launch your Dev VM in Docker","text":"<p>Right-click <code>docker-compose.yml</code> and choose <code>Compose Up</code>.</p> <p>Wait, it'll take a while as docker downloads all the modules and gets running.</p>"},{"location":"contributing_using_docker/#develop","title":"Develop","text":"<p>You're operational!</p> <p>Note</p> <p>Self-signed certs are in your dev environment. Navigate to https://api.example.com and https://rmm.example.com and accept the self signed certs to get rid of errors.</p>"},{"location":"contributing_using_docker/#view-mkdocks-live-edits-in-browser","title":"View MKDocks Live Edits in Browser","text":"<p>Change stuff in <code>/docs/docs/</code></p> <p>MKDocs is Exposed on Port: 8005</p> <p>Open: http://rmm.example.com:8005/</p> <p>Note</p> <p>If you add new MKDocs extensions you might need to: - <code>docker compose down</code> - Then delete the <code>/api/tacticalrmm/env/</code> folder. - Then <code>docker compose up</code> and it will download / rebuild new extensions.</p>"},{"location":"contributing_using_docker/#view-django-administration","title":"View Django Administration","text":"<p>Open: http://rmm.example.com:8000/admin/</p>"},{"location":"contributing_using_vscode/","title":"Contributing Using VS Code","text":""},{"location":"contributing_using_vscode/#getting-started","title":"Getting Started","text":""},{"location":"contributing_using_vscode/#install-vs-code","title":"Install VS Code","text":"<p>https://code.visualstudio.com/download</p>"},{"location":"contributing_using_vscode/#fork-project-in-github","title":"Fork Project in Github","text":"<p>This is making a duplicate of the code under your Github that you can edit.</p> <p>https://github.com/amidaware/tacticalrmm</p> <p></p>"},{"location":"contributing_using_vscode/#add-your-forked-repo-to-vs-code","title":"Add your (forked) repo to VS Code","text":"<ol> <li> <p>Clone repository.</p> </li> <li> <p>Login to your Github.</p> </li> <li> <p>Choose local folder.</p> </li> </ol>"},{"location":"contributing_using_vscode/#install-extra-vs-code-extensions","title":"Install extra VS Code Extensions","text":"<ul> <li> <p>GitLens</p> </li> <li> <p>Remote - SSH</p> </li> </ul>"},{"location":"contributing_using_vscode/#open-terminal","title":"Open Terminal","text":"<p>https://code.visualstudio.com/docs/editor/integrated-terminal</p> <pre><code>Ctrl+`\n</code></pre>"},{"location":"contributing_using_vscode/#configure-a-remote-for-your-fork-in-vs-code","title":"Configure a remote for your fork (in VS Code)","text":"<p>https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/configuring-a-remote-for-a-fork</p> <p>Configure your local fork and tell it where the original code repo is so you can compare and merge updates later when official repo is updated.</p> <p>Check repos:</p> <pre><code>git remote -v\n</code></pre> <p>Add upstream repo:</p> <pre><code>git remote add upstream https://github.com/amidaware/tacticalrmm\n</code></pre> <p>Confirm changes:</p> <pre><code>git remote -v\n</code></pre>"},{"location":"contributing_using_vscode/#contribute-code","title":"Contribute code","text":"<ol> <li> <p>Make changes to something.</p> </li> <li> <p><code>Commit</code> (update something) and notate what you did.</p> </li> <li> <p><code>Push</code> (from your local VS Code to your github fork).</p> </li> <li> <p>Open your browser and look at your repo (It should reflect your commit).</p> </li> </ol>"},{"location":"contributing_using_vscode/#request-your-changes-to-be-pulled-into-the-primary-repo-pull-request","title":"Request your changes to be pulled into the primary repo (Pull Request)","text":"<p>In your browser, create a pull request.</p>"},{"location":"contributing_using_vscode/#sync-your-local-fork","title":"Sync your local fork","text":"<p>https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/syncing-a-fork</p> <p>Bring changes from original repo to your local VS Code copy so you're current with changes made in original Github repo:</p> <p></p> <p>In VS Code open TERMINAL:</p> <pre><code>Ctrl+`\n</code></pre> <p>Tell git to pull from the GitHub upstream repo all new changes into your local directory:</p> <pre><code>git pull --rebase upstream develop\n</code></pre>"},{"location":"contributing_using_vscode/#push-your-local-updated-copy-to-your-github-fork","title":"Push your local updated copy to your Github fork","text":"<p>Then you're <code>push</code>ing that updated local repo to your online Github fork:</p> <p></p>"},{"location":"contributing_using_vscode/#verify-and-repeat","title":"Verify and Repeat","text":"<p>Check your Github fork in browser, it should be up to date now with original. Repeat 6 or 7 as necessary.</p>"},{"location":"contributing_using_vscode/#reference","title":"Reference","text":""},{"location":"contributing_using_vscode/#customizing-the-admin-web-interface","title":"Customizing the Admin Web Interface","text":"<p>Created using Quasar, it's all your .vue files in <code>web/src/components/modals/agents/RunScript.vue</code>.</p> <p>Learn stuff here:</p> <p>https://quasar.dev/</p>"},{"location":"faq/","title":"FAQ","text":""},{"location":"faq/#how-do-i-get-reporting","title":"How do I get Reporting?","text":"<p>Please see the Reporting FAQ</p>"},{"location":"faq/#help-ive-been-hacked-and-there-are-weird-agents-appearing-in-my-tactical-rmm","title":"Help! I've been hacked and there are weird agents appearing in my Tactical RMM!","text":"<p>No, you haven't.</p> <ol> <li> <p>You used the Dynamic EXE/Deployment EXE installation method, and the installer was scanned by an antivirus.</p> </li> <li> <p>It didn't recognize the exe.</p> </li> <li> <p>You have the option enabled to submit unknown applications for analysis.</p> <p></p> </li> <li> <p>They ran it against their virtualization testing cluster.</p> </li> </ol> <p>To prevent this from happening: either turn off file uploads in your AV settings, or use the Powershell or Manual install methods.</p> <p>Here are some examples of what that looks like.</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"faq/#can-i-____","title":"Can I ____?","text":"<p>If you've been sent a link to this, we are not going to allow or support things like your request. The reason is because it would facilitate people avoiding to pay for/supporting Tactical RMM for these/similar premium paid features.</p> <p>So the answer is No.</p>"},{"location":"faq/#id-like-to-be-able-to-____","title":"I'd like to be able to ____?","text":"<p>If you've been sent a link to this, it's possible that we could support this but it would most likely be a paid premium feature. Please contact Commercial Support to discuss further.</p>"},{"location":"faq/#why-isnt-the-code-signing-free","title":"Why isn't the Code Signing free?","text":"<p>It is recommended because it helps the project mature, Tactical is source available and free. Community support is also free on top of this we have spent a lot of time developing the docs, please follow them!  With many source available (and similar) projects devs get bored of them because they don't make money out of it. So here is your reasons to pay for code signing and also why it was discussed and implemented. </p> <ol> <li>Code signing costs a lot of money. OV code signing requires a legitimate legal business...Amidaware was setup for this purpose. Code signing + operating a business costs thousands of dollars a year.</li> <li>It helps the project move forward and it can support devs spending time on it, they have lives, wives, jobs and kids which all demands attention.</li> <li>It should stop bad actors using it maliciously.</li> <li>It helps with AVs detecting it as anything malicious.</li> </ol> <p>We had github sponsors up for many months before code signing. Very few people donated, some $5 and $10. maybe $40 a month. Once we announced code signing, sponsors came in like crazy, and many people upgraded their $5 to $55 so whilst everyone believes people would gladly donate, that's just not the case. We already tried.</p>"},{"location":"faq/#is-tactical-rmm-compliant-with-privacy-laws","title":"Is Tactical RMM Compliant with Privacy Laws?","text":"<p>Tactical, as a self-hosted solution, offers the potential for GDPR and HIPAA compliance as well as many other privacy laws, but its adherence largely depends on the hosting environment and how it's configured. Since you have full control over the hosting, you bear a significant responsibility for compliance. By default, the Tactical server collects essential information which is displayed in the dashboard on each agent. None of this data is transmitted outside of the Tactical server, enhancing data security. Encryption at rest is possible at the file system level, contingent on your hosting infrastructure. Additionally, all communications between the Tactical server and your clients are encrypted in transit, enhancing security. Furthermore, Tactical incorporates an audit log that records all actions, assisting in tracking and ensuring accountability. However, it's crucial to be cautious about collector scripts, as they could potentially alter data collection practices, potentially leading to non-compliance if not carefully managed and configured in accordance with GDPR and HIPAA regulations. Therefore, maintaining a vigilant approach to configuration and monitoring is essential when utilizing Tactical for compliance purposes.</p>"},{"location":"faq/#linuxmacos-agents","title":"Linux/macOS Agents","text":"<p>Why do I see?</p> <pre><code>Missing code signing token\n400: Bad Request\n</code></pre> <p>You must have a paid code signing certificate while Linux/macOS support is in the post-alpha/beta:</p> <ul> <li>Code signing makes these installs easy and is a benefit offered to code signing sponsors. So become a sponsor and enjoy the easy life</li> <li>DIYer can read thru the code and... DIY.</li> </ul> <p>This is primarily for 2 reasons: </p> <ol> <li>As this has been a sponsorship goal it seems only fair that those who contributed to make this a reality get early access to easy agent installs.</li> <li>We're looking for good bug reports from active users to get these agent into production ready code. </li> </ol>"},{"location":"faq/#who-is-amidaware-inc","title":"Who is Amidaware Inc?","text":"<p>The Legal entity behind Tactical RMM.</p>"},{"location":"faq/#how-do-i-move-an-agent-to-another-clientsite","title":"How do I move an agent to another client/site?","text":"<p>Right click on the agent &gt; Edit agent. Then select the new site from the dropdown.</p>"},{"location":"faq/#is-it-possible-to-use-xxx-with-tactical-rmm","title":"Is it possible to use XXX with Tactical RMM","text":"<p>While it may be possible to use XXX, we have not configured it and therefore it is Unsupported. We cannot help you configure XXX as it pertains to your environment.</p>"},{"location":"faq/#is-it-possible-to-use-xxx-proxy-server-with-tactical-rmm","title":"Is it possible to use XXX proxy server with Tactical RMM","text":"<p>If you wish to stray from the easy install of a standard install in a VPS, you need to have the knowledge on how to troubleshoot your own custom environment.</p> <p>The most common reasons you're running a proxy are:</p> <ol> <li>Because you only have a single public IP and you already have something on Port 443. Workaround: Get another public IP from your ISP.</li> <li>Because you want to monitor traffic for security reasons: You're a Networking Wizard.</li> </ol> <p>There are some implementations that others have done, but be aware it is Unsupported and if you're requesting help in Discord please let us know in advance.</p>"},{"location":"faq/#i-want-to-use-a-different-port-other-than-443","title":"I want to use a different port other than 443","text":"<p>I want to use a different port for Tactical RMM because my public IP on 443 is currently being used by something else. PAT (aka Port Address Translation)</p> <p>That is not possible at this time.</p> <p>Your options are: </p> <ul> <li>Run in a VPS</li> <li>Get another Public IP from your ISP</li> <li>Use another proxy server in an unsupported configuration</li> <li>Run TRMM in a SDWAN like Netmaker/Zerotier/Tailscale/Sunbird etc</li> </ul>"},{"location":"faq/#how-do-i-do-x-feature-in-the-web-ui","title":"How do I do X feature in the web UI?","text":"<p>A lot of features in the web UI are hidden behind right-click menus. Almost everything has a right click menu so if you don't see something, try right clicking on it.</p>"},{"location":"faq/#can-i-run-tactical-rmm-locally-behind-nat-without-exposing-my-rmm-server-to-the-internet","title":"Can I run Tactical RMM locally behind NAT without exposing my RMM server to the internet?","text":"<p>Yes, you will just need to setup local DNS for the 3 subdomains, either by editing host files on all your agents or through a local DNS server.</p> <p>Similarly asked: Can I use onsite DNS servers (I don\u2019t want my server accessible from the internet).</p> <p>Yes, you can use (only) internal DNS (if you want) for api, mesh and rmm domains. You don't have to put these records in your public DNS servers.</p> <p>The Let's Encrypt DNS <code>TXT</code> wildcard cert request process does not require any inbound connection from the internet (port forwarding etc) to be enabled. This does not expose your RMM server to the internet in any way.</p>"},{"location":"faq/#i-forgot-my-username-to-login-to-the-web-ui-how-can-i-find-it","title":"I forgot my username to login to the web UI, how can I find it?","text":"<p>Do the following as the <code>tactical</code> user which will list all user accounts:</p> <pre><code>tactical@trmm:~$ /rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py shell\nPython 3.11.3 (main, Apr  9 2023, 04:41:05) [GCC 10.2.1 20210110] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n(InteractiveConsole)\n&gt;&gt;&gt; from accounts.models import User\n&gt;&gt;&gt; User.objects.exclude(is_installer_user=True).filter(agent__isnull=True)\n</code></pre>"},{"location":"faq/#how-do-i-make-another-superuser-for-logging-into-rmm","title":"How do I make another superuser for logging into <code>rmm.</code>","text":"<pre><code>cd /rmm/api/tacticalrmm/\nsource ../env/bin/activate\npython manage.py createsuperuser\n</code></pre>"},{"location":"faq/#i-am-locked-out-of-the-web-ui-how-do-i-reset-my-password","title":"I am locked out of the web UI. How do I reset my password?","text":"<p>SSH into your server and run:</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py reset_password &lt;username&gt;\n</code></pre>"},{"location":"faq/#how-do-i-reset-password-or-2-factor-token","title":"How do I reset password or 2 factor token?","text":""},{"location":"faq/#from-trmm-admin-gui","title":"From TRMM Admin GUI","text":"<p>From the web UI, click Settings &gt; User Administration and then right-click on a user: </p>"},{"location":"faq/#from-ssh","title":"From SSH","text":"<p>Login with SSH using your install ID (eg <code>tactical</code>)</p> <p>and Reset Password</p> <p>OR</p> Reset 2FA token for a TRMM user  standard docker <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py reset_2fa &lt;username&gt;\n</code></pre> <pre><code>docker exec -it trmm-backend /bin/bash\n</code></pre> <p>Then simply log out of the web UI and next time the user logs in they will be redirected to the 2FA setup page which will present a barcode to be scanned with the Authenticator app.</p>"},{"location":"faq/#how-do-i-recover-my-meshcentral-login-credentials","title":"How do I recover my MeshCentral login credentials?","text":"<p>From Tactical's web UI: Settings &gt; Global Settings &gt; MeshCentral</p> <p>Copy the username, then ssh into the server and run:</p> <pre><code>cd /meshcentral/\nsudo systemctl stop meshcentral.service\nnode node_modules/meshcentral --resetaccount &lt;username&gt; --pass &lt;newpassword&gt;\nsudo systemctl start meshcentral.service\n</code></pre> <p>to reset Mesh password for user.</p> <p>Warning</p> <p>Resetting the default admin in mesh will break agent installs if you don't also update the mesh connection into in Settings &gt; General &gt; Meshcentral and make sure it's working</p>"},{"location":"faq/#dns-cant-find-record","title":"DNS can't find record","text":"<p>Q. My DNS isn\u2019t working.</p> <p>A. Make sure it\u2019s correctly formatted, as most DNS providers add in the domain automatically.</p> <p></p>"},{"location":"faq/#license-faq","title":"License FAQ","text":"<p>If you're not certain if your business use case is allowed by the license please open a ticket and let us know how you're planning on using it.</p>"},{"location":"faq/#can-i-password-protect-the-uninstalling-of-the-trmm-agent","title":"Can I password protect the uninstalling of the TRMM agent?","text":"<p>From the client / agent side: Installing and uninstalling software is part of system administration. Administrators can install / uninstall. Users cannot. Configure your system appropriately.</p> <p>From the TRMM Admin panel: Use <code>Permissions Manager</code> to restrict your techs permissions.</p> <p>To hide Tactical RMM from the Control Panel's Program and Features, use the following PowerShell command:</p> <pre><code>Set-ItemProperty -Path 'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{0D34D278-5FAF-4159-A4A0-4E2D2C08139D}_is1' -Name 'SystemComponent' -Value 1 -Type DWord\n</code></pre> <p>To undo the changes and make Tactical RMM visible again in the Control Panel, use the following PowerShell command:</p> <p><pre><code>Remove-ItemProperty -Path 'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{0D34D278-5FAF-4159-A4A0-4E2D2C08139D}_is1' -Name 'SystemComponent'\n</code></pre> Alternative: Check out some scripts</p>"},{"location":"faq/#i-want-to-move-andor-migrate-my-server-how-do-i-do-it","title":"I want to move and/or migrate my server? How do I do it?","text":""},{"location":"faq/#changing-a-public-ip-or-private-lan-ip-address","title":"Changing a public IP or private LAN IP address?","text":"<p>TRMM doesn't care about that. TRMM uses DNS, and only the 3 configured DNS names used during install. Make them right, and you'll be fine (with a backup/restore script if necessary)</p>"},{"location":"faq/#are-you-keeping-the-same-dns-names","title":"Are you keeping the same DNS names?","text":"<p>Use the backup and restore process. </p> <p>Note</p> <p>It's best practice to make sure you're running the latest version before running the backup script, and make sure you have the latest backup script. It does change.</p>"},{"location":"faq/#are-you-wanting-to-change-the-dns-names-on-the-server","title":"Are you wanting to change the DNS names on the server?","text":"<p>We warned you you should choose the right DNS names during install. There is no supported way to do this because of the complexities involved. We do offer a paid migration service, please open a ticket for pricing.</p> <p>If you want to try it yourself, your best bet is to use another service outside of TRMM to uninstall and reinstall your agents to a new TRMM server. Then you'll need to migrate all your automation policies, alert policies, patch policies, custom scripts, reports, users, user permissions, user settings, custom fields, api keys, key store items, email configuration, sms configuration etc from your old TRMM server to the new one manually.</p>"},{"location":"faq/#if-you-received-this-link","title":"If you received this link","text":"<p>You have asked for assistance in Discord or Github, and you have not provided enough information.</p> <p>Please provide the following information by submitting this, or copy/pasting this text and answering the questions:</p> <pre><code>Install type (Standard/Docker) and amount of RAM on server?\nDid you deviate IN ANY WAY from these Standard server install instructions https://docs.tacticalrmm.com/install_server/ ?\nDid you deviate IN ANY WAY from these Docker server install instructions https://docs.tacticalrmm.com/install_docker/ ?\nWhere is the server (VPS/onprem)?\nNew/old install? Rough age of TRMM server (days/weeks/months)?\n\nServer Install Specific questions:\nWhat OS/version is TRMM installed on.\nUsing a real domain?\nDid letsencrypt finalize and work?\nHave you looked at the troubleshooting steps to see if something there is appropriate to you situation? Test DNS from an agent etc. https://docs.tacticalrmm.com/troubleshooting/\nRun the Server Troubleshooting Script and DM the person (from @Support) that is working with you https://docs.tacticalrmm.com/troubleshooting/#server-troubleshooting-script\nWhat kind of ssl certs? Let's Encrypt, or purchased.\nCheck Expiry date of your certificates in the browser (at https://rmm.example.com/ )\n\nNetwork Troubleshooting\nAre you using a proxy?\nAre you a wizard? See https://docs.tacticalrmm.com/unsupported_guidelines/\nIf so, what's in the network between agent and server?\n\nAgent Troubleshooting\nIs there ANY 3rd party Antivirus installed on the computer?\nIs there any network based filtering/AV filtering?\n\nAsking yourself questions like: When did it go from working to broken? What changed during that time? This will help you. \n</code></pre> <p>We can not help you until we understand your setup. Just posting an error log is not enough information.</p> <p>You can help yourself by running this and this that will test your server and and tell you common problems.</p> <p>If you would like us to do it for you please contact support.</p>"},{"location":"faq/#should-i-use-a-check-or-a-task","title":"Should I use a Check or a Task?","text":"<p>Checks</p> <ul> <li>Run every 2-1440 mins (1 day max)</li> <li>Results are naturally graphed, and not logged to the agents \"History\" tab</li> </ul> <p>Tasks</p> <ul> <li>Is run using the Windows Task Scheduler on the agent.</li> <li>Although multiple times/day can be scheduled it's complicated and will clutter up your \"History\" tab.</li> <li>Best for periodic script runs that run daily/weekly/monthly/onboarding/once</li> </ul>"},{"location":"faq/#is-tactical-rmm-vulnerable-to-log4j","title":"Is Tactical RMM vulnerable to Log4j","text":"<p>No.</p>"},{"location":"faq/#terminology","title":"Terminology","text":"<p>Code Signing: A windows .exe cryptographic signing process that can't be forged. The only want to reliably whitelist your TRMM agent is to have a Code signed agent that you can give the signers public key to your security software to whitelist.</p> <p>Mac/Linux Pre-Compiled binaries: Are provided by Amidaware so you can install agents on Mac and Linux. This requires sponsorship. If you want to test Mac/Linux agents please contact support and open a ticket to request a 7 day hosted trial.</p>"},{"location":"guide_gettingstarted/","title":"Getting Started Guide","text":"<p>Install the server, choose the best path</p>"},{"location":"guide_gettingstarted/#post-install","title":"Post Install","text":"<ul> <li> Setup Email Alerts</li> <li> Setup SMS Alerts</li> <li> Create a Default Alert Template and assign (either Global, or using Automation Policies)</li> <li> Set Server Preferences Under <code>Global Settings &gt; General</code></li> <li> Review User Settings</li> <li> Set Retention Policies under Under <code>Global Settings &gt; Retention</code></li> <li> Read thru the FAQ</li> <li> Setup AV exclusions in the appropriate Anti-virus products for your managed base</li> </ul>"},{"location":"guide_gettingstarted/#setup-automation-policies","title":"Setup Automation Policies","text":"<ul> <li> Default Profile for workstations <code>Settings menu &gt; Global Settings &gt; General</code></li> <li> Default Profile for servers <code>Settings menu &gt; Global Settings &gt; General</code></li> <li> Decide on Windows Updates policy</li> <li> Create Onboarding Tasks and apply according to how you want to manage them.</li> </ul>"},{"location":"guide_gettingstarted/#multiple-users","title":"Multiple Users","text":"<ul> <li> Setup Permission Manager <code>Settings menu &gt; Permission Manager</code></li> <li> Add users to Permission Groups <code>Settings menu &gt; User Administration</code></li> </ul>"},{"location":"guide_gettingstarted/#every-75-days","title":"Every 75 days","text":"<ul> <li> TRMM Server OS updates</li> <li> Reboot TRMM server</li> <li> Renew LetsEncrypt Certs</li> <li> Update TRMM</li> <li> Check your backups. Especially scheduled ones and make sure you're running the latest <code>./backup.sh</code> (You're reading the release notes at every update, right?)</li> </ul>"},{"location":"guide_gettingstarted/#bi-annually","title":"Bi-annually","text":"<ul> <li> Clean up old agents</li> </ul>"},{"location":"guide_gettingstarted/#dont-do-these-things","title":"Don't do these things","text":"<p>Your Tactical NoNo List</p> <ul> <li>Clone agents with TRMM agent installed. Make your master image with no TRMM agent installed, script the install for first time boot after imaging.</li> <li>Do in place distro upgrades or move vms to new hardware, instead use Backup and Restore scripts to move the server to new vm's</li> <li>Run <code>install.sh</code> or <code>restore.sh</code> more than once. They're one-shot scripts to be ran on clean VMs only.</li> <li>Use TRMMs powers for Evil. Just don't, make better choices!</li> </ul>"},{"location":"howitallworks/","title":"How It All Works","text":""},{"location":"howitallworks/#understanding-trmm","title":"Understanding TRMM","text":"<p>Anything you configure: scripts, tasks, patching, etc is queued and scheduled on the server to do something. Everything that is queued, happens immediately when agents are online. The agent gets a NATS command, the server tells it to do xyz and it does it.</p> <p>When agents are not connected to the server nothing happens. The Windows Task Scheduler says do x at some time, what it's asked to do is get x command from the server. If the server is offline, nothing happens. If an agent comes online, every x interval (Windows Update, pending tasks etc) check and see if there is something for me to do that I missed while I was offline. When that time occurs (eg agent sees if it needs to update itself at 35 minutes past every hour Update Agents ) it'll get requested on the online agent.</p> <p>That's the simplified general rule for everything TRMM.</p> <p></p> <p>Image Source</p> <p>Still need graphics for:</p> <pre><code>1. Agent installer steps\n\n2. Agent checks / tasks and how they work on the workstation/interact with server\n</code></pre>"},{"location":"howitallworks/#server","title":"Server","text":"<p>Has a Postgres database located here:</p> <p>Django Admin</p> <p>Description</p> <p>A web interface for the Postgres database</p> <p>All Tactical RMM dependencies are listed here.</p> <p>A complete list of all packages used by Tactical RMM are listed here.</p>"},{"location":"howitallworks/#outbound-firewall-rules","title":"Outbound Firewall Rules","text":"<p>If you have strict outbound firewall rules these are the outbound rules needed for all functionality:</p>"},{"location":"howitallworks/#regular-use","title":"Regular Use","text":"<ol> <li>Access to Github for downloading and installing TRMM, and checking if new TRMM version is available to show in the admin web panel.</li> <li>Access to nginx.org to install</li> <li>Access to mongodb.org to install</li> <li>Access to python.org to install</li> <li>Access to postgresql.org to install</li> <li>Whatever servers Let's Encrypt uses for DNS-01 challenges</li> <li>Cloudflare is for the licensing servers.</li> </ol>"},{"location":"howitallworks/#server-without-code-signing-key","title":"Server Without Code Signing Key","text":"<p>No additional rules needed.</p>"},{"location":"howitallworks/#server-with-code-signing-key","title":"Server With Code Signing Key","text":"<p>No additional rules needed.</p>"},{"location":"howitallworks/#system-services","title":"System Services","text":"<p>This lists the system services used by the server.</p> <p>Quick server health inspection</p> <pre><code>cd /rmm/api/tacticalrmm/\nsource ../env/bin/activate\nfor i in active reserved scheduled stats; do celery -A tacticalrmm inspect $i; done\n</code></pre>"},{"location":"howitallworks/#nginx-web-server","title":"Nginx Web Server","text":"<p>Nginx is the web server for the <code>rmm</code>, <code>api</code>, and <code>mesh</code> domains. All sites redirect port 80 (HTTP) to port 443 (HTTPS).</p> nginx configuration (a.k.a. sites available) <ul> <li>nginx configuration docs</li> </ul> <code>rmm.example.com</code> <code>api.example.com</code> <code>mesh.example.com</code> default <p>This serves the frontend website that you interact with.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/frontend.conf</code></li> <li>root: <code>/var/www/rmm/dist</code></li> <li>Access log: <code>/var/log/nginx/frontend-access.log</code></li> <li>Error log: <code>/var/log/nginx/frontend-error.log</code></li> <li>TLS certificate: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> <p>This serves the TRMM API for the frontend and agents.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/rmm.conf</code></li> <li>roots:<ul> <li><code>/rmm/api/tacticalrmm/static/</code></li> <li><code>/rmm/api/tacticalrmm/tacticalrmm/private/</code></li> </ul> </li> <li>Upstreams:<ul> <li><code>unix://rmm/api/tacticalrmm/tacticalrmm.sock</code></li> <li><code>unix://rmm/daphne.sock</code></li> </ul> </li> <li>Access log: <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/access.log</code></li> <li>Error log: <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/error.log</code></li> <li>TLS certificate: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> <p>This serves MeshCentral for remote access.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/meshcentral.conf</code></li> <li>Upstream: <code>http://127.0.0.1:4430/</code></li> <li>Access log: <code>/var/log/nginx/access.log</code> (uses default)</li> <li>Error log: <code>/var/log/nginx/error.log</code> (uses default)</li> <li>TLS certificate: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> <p>This is the default site installed with nginx. This listens on port 80 only.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/default</code></li> <li>root: <code>/var/www/rmm/dist</code></li> <li>Access log: <code>/var/log/nginx/access.log</code> (uses default)</li> <li>Error log: <code>/var/log/nginx/error.log</code> (uses default)</li> </ul> systemd config  status commands standard docker <ul> <li>Status: <code>systemctl status --full nginx.service</code></li> <li>Stop: <code>systemctl stop nginx.service</code></li> <li>Start: <code>systemctl start nginx.service</code></li> <li>Restart: <code>systemctl restart nginx.service</code></li> <li>Restart: <code>systemctl reload nginx.service</code> reloads the config without restarting</li> <li>Test config: <code>nginx -t</code></li> <li>Listening process: <code>ss -tulnp | grep nginx</code></li> </ul> <ul> <li>Service: <code>nginx.service</code></li> <li>Address: <code>0.0.0.0</code></li> <li>Port: 443</li> <li>Exec: <code>/usr/sbin/nginx -g 'daemon on; master_process on;'</code></li> <li>Version: 1.18.0</li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-nginx\"</code></li> <li>View logs: <code>docker compose logs tactical-nginx</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-nginx | tail</code></li> <li>Shell access: <code>docker exec -it trmm-nginx /bin/bash</code></li> </ul>"},{"location":"howitallworks/#tactical-rmm-django-uwsgi-service","title":"Tactical RMM (Django uWSGI) Service","text":"<p>Built on the Django framework, the Tactical RMM service is the heart of the system by serving the API for the frontend and agents.</p> uWSGI config <ul> <li>uWSGI docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full rmm.service</code></li> <li>Stop: <code>systemctl stop rmm.service</code></li> <li>Start: <code>systemctl start rmm.service</code></li> <li>Restart: <code>systemctl restart rmm.service</code></li> <li>journalctl:<ul> <li>\"tail\" the logs: <code>journalctl --identifier uwsgi --follow</code></li> <li>View the logs: <code>journalctl --identifier uwsgi --since \"30 minutes ago\" | less</code></li> <li>Debug logs for 5xx errors will be located in <code>/rmm/api/tacticalrmm/tacticalrmm/private/log</code></li> </ul> </li> </ul> <ul> <li>Service: <code>rmm.service</code></li> <li>Socket: <code>/rmm/api/tacticalrmm/tacticalrmm.sock</code></li> <li>uWSGI config: <code>/rmm/api/tacticalrmm/app.ini</code></li> <li>Log: None</li> <li>Journal identifier: <code>uwsgi</code></li> <li>Version: 2.0.18</li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-backend\"</code></li> <li>View logs: <code>docker compose logs tactical-backend</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-backend | tail</code></li> <li>Shell access: <code>docker exec -it trmm-backend /bin/bash</code></li> </ul>"},{"location":"howitallworks/#daphne-django-channels-daemon","title":"Daphne: Django Channels Daemon","text":"<p>Daphne is the official ASGI HTTP / WebSocket server maintained by the Channels project.</p> Daphne config <ul> <li>Django Channels configuration docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full daphne.service</code></li> <li>Stop: <code>systemctl stop daphne.service</code></li> <li>Start: <code>systemctl start daphne.service</code></li> <li>Restart: <code>systemctl restart daphne.service</code></li> <li>journalctl (this provides only system start/stop logs, not the actual logs):<ul> <li>\"tail\" the logs: <code>journalctl --identifier daphne --follow</code></li> <li>View the logs: <code>journalctl --identifier daphne --since \"30 minutes ago\" | less</code></li> </ul> </li> </ul> <ul> <li>Service: <code>daphne.service</code></li> <li>Socket: <code>/rmm/daphne.sock</code></li> <li>Exec: <code>/rmm/api/env/bin/daphne -u /rmm/daphne.sock tacticalrmm.asgi:application</code></li> <li>Config: <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></li> <li>Log: <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/trmm_debug.log</code></li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-websockets\"</code></li> <li>View logs: <code>docker compose logs tactical-websockets</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-websockets | tail</code></li> <li>Shell access: <code>docker exec -it trmm-websockets /bin/bash</code></li> </ul>"},{"location":"howitallworks/#nats-server-service","title":"NATS Server Service","text":"<p>NATS is a messaging bus for \"live\" communication between the agent and server. NATS provides the framework for the server to push commands to the agent and receive information back.</p> NATS config <ul> <li>NATS server configuration docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full nats.service</code></li> <li>Stop: <code>systemctl stop nats.service</code></li> <li>Start: <code>systemctl start nats.service</code></li> <li>Restart: <code>systemctl restart nats.service</code></li> <li>Reload: <code>systemctl reload nats.service</code> reloads the config without restarting</li> <li>journalctl:<ul> <li>\"tail\" the logs: <code>journalctl --identifier nats-server --follow</code></li> <li>View the logs: <code>journalctl --identifier nats-server --since \"30 minutes ago\" | less</code></li> </ul> </li> <li>Listening process: <code>ss -tulnp | grep nats-server</code></li> <li>Checking for NATS or websocket problems <code>sudo journalctl --no-pager -u nats</code> and <code>sudo journalctl --no-pager -u nats-api</code></li> </ul> <ul> <li>Service: <code>nats.service</code></li> <li>Address: <code>0.0.0.0</code></li> <li>Port: <code>4222 (standard), 9235 (websocket)</code></li> <li>Exec: <code>/usr/local/bin/nats-server --config /rmm/api/tacticalrmm/nats-rmm.conf</code></li> <li>Config: <code>/rmm/api/tacticalrmm/nats-rmm.conf</code><ul> <li>TLS: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> </li> <li>Log: None</li> <li>Version: v2.3.3</li> </ul> <ul> <li>Get into bash in your docker with: <code>docker exec -it trmm-nats /bin/bash</code></li> <li>Log: <code>nats-api -log debug</code></li> <li>Shell access: <code>docker exec -it trmm-nats /bin/bash</code></li> </ul>"},{"location":"howitallworks/#nats-api-service","title":"NATS API Service","text":"NATS API config  status commands standard docker <ul> <li>Status: <code>systemctl status --full nats-api.service</code></li> <li>Stop: <code>systemctl stop nats-api.service</code></li> <li>Start: <code>systemctl start nats-api.service</code></li> <li>Restart: <code>systemctl restart nats-api.service</code></li> <li>journalctl: This application does not appear to log anything.</li> </ul> <ul> <li>Service: <code>nats-api.service</code></li> <li>Exec: <code>/usr/local/bin/nats-api --config /rmm/api/tacticalrmm/nats-api.conf</code></li> <li>Config: <code>/rmm/api/tacticalrmm/nats-api.conf</code><ul> <li>TLS: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> </li> <li>Log: None</li> </ul> <ul> <li>Get into bash in your docker with: <code>docker exec -it trmm-nats /bin/bash</code></li> <li>Log: <code>nats-api -log debug</code></li> </ul>"},{"location":"howitallworks/#celery-service","title":"Celery Service","text":"<p>Celery is a task queue focused on real-time processing and is responsible for scheduling tasks to be sent to agents.</p> <p>Log located at <code>/var/log/celery</code></p> Celery config <ul> <li>Celery docs</li> <li>Celery configuration docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full celery.service</code></li> <li>Stop: <code>systemctl stop celery.service</code></li> <li>Start: <code>systemctl start celery.service</code></li> <li>Restart: <code>systemctl restart celery.service</code></li> <li>journalctl: Celery executes <code>sh</code> causing the systemd identifier to be <code>sh</code>, thus mixing the <code>celery</code> and <code>celerybeat</code> logs together.<ul> <li>\"tail\" the logs: <code>journalctl --identifier sh --follow</code></li> <li>View the logs: <code>journalctl --identifier sh --since \"30 minutes ago\" | less</code></li> </ul> </li> <li>Tail logs: <code>tail -F /var/log/celery/w*-*.log</code></li> </ul> <ul> <li>Service: <code>celery.service</code></li> <li>Exec: <code>/bin/sh -c '${CELERY_BIN} -A $CELERY_APP multi start $CELERYD_NODES --pidfile=${CELERYD_PID_FILE} --logfile=${CELERYD_LOG_FILE} --loglevel=\"${CELERYD_LOG_LEVEL}\" $CELERYD_OPTS'</code></li> <li>Config: <code>/etc/conf.d/celery.conf</code></li> <li>Log: <code>/var/log/celery/w*-*.log</code></li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-celery\"</code></li> <li>View logs: <code>docker compose logs tactical-celery</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-celery | tail</code></li> <li>Shell access: <code>docker exec -it trmm-celery /bin/bash</code></li> </ul>"},{"location":"howitallworks/#celery-beat-service","title":"Celery Beat Service","text":"<p>Celery Beat is a scheduler. It kicks off tasks at regular intervals, that are then executed by available worker nodes in the cluster.</p> Celery Beat config <ul> <li>Celery beat docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full celerybeat.service</code></li> <li>Stop: <code>systemctl stop celerybeat.service</code></li> <li>Start: <code>systemctl start celerybeat.service</code></li> <li>Restart: <code>systemctl restart celerybeat.service</code></li> <li>journalctl: Celery executes <code>sh</code> causing the systemd identifier to be <code>sh</code>, thus mixing the <code>celery</code> and <code>celerybeat</code> logs together.<ul> <li>\"tail\" the logs: <code>journalctl --identifier sh --follow</code></li> <li>View the logs: <code>journalctl --identifier sh --since \"30 minutes ago\" | less</code></li> </ul> </li> <li>Tail logs: <code>tail -F /var/log/celery/beat.log</code></li> </ul> <ul> <li>Service: <code>celerybeat.service</code></li> <li>Exec: <code>/bin/sh -c '${CELERY_BIN} -A ${CELERY_APP} beat --pidfile=${CELERYBEAT_PID_FILE} --logfile=${CELERYBEAT_LOG_FILE} --loglevel=${CELERYD_LOG_LEVEL}'</code></li> <li>Config: <code>/etc/redis/redis.conf</code></li> <li>Log: <code>/var/log/celery/beat.log</code></li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-celerybeat\"</code></li> <li>View logs: <code>docker compose logs tactical-celerybeat</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-celerybeat | tail</code></li> <li>Shell access: <code>docker exec -it trmm-celerybeat /bin/bash</code></li> </ul>"},{"location":"howitallworks/#redis-service","title":"Redis Service","text":"<p>Redis is an in-memory data structure store used as a database, cache, and message broker for Django / Celery.</p> <p>Log located at <code>/var/log/redis</code></p> Redis config <ul> <li>Redis docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full redis-server.service</code></li> <li>Stop: <code>systemctl stop redis-server.service</code></li> <li>Start: <code>systemctl start redis-server.service</code></li> <li>Restart: <code>systemctl restart redis-server.service</code></li> <li>Tail logs: <code>tail -F /var/log/redis/redis-server.log</code></li> </ul> <ul> <li>Service: <code>redis-server.service</code></li> <li>Log: <code>/var/log/redis/redis-server.log</code></li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-redis\"</code></li> <li>View logs: <code>docker compose logs tactical-redis</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-redis | tail</code></li> <li>Shell access: <code>docker exec -it trmm-redis /bin/bash</code></li> </ul>"},{"location":"howitallworks/#meshcentral","title":"MeshCentral","text":"<p>MeshCentral is used for \"Take Control\" (connecting to machine for remote access), and 2 screens of the \"Remote Background\" (Terminal, and File Browser).</p> <p>Config file location:</p> <pre><code>/meshcentral/meshcentral-data/config.json\n</code></pre> <p>Customize with care.</p> <p>Info</p> <p>Mesh usernames are CaSe sEnSiTive. Tactical will make sure it's all lower case to avoid sync problems.</p> MeshCentral <ul> <li>MeshCentral docs</li> </ul>  status commands docker Debugging <ul> <li>Status: <code>systemctl status --full meshcentral</code></li> <li>Stop: <code>systemctl stop meshcentral</code></li> <li>Start: <code>systemctl start meshcentral</code></li> <li>Restart: <code>systemctl restart meshcentral</code></li> </ul> <ul> <li>From the docker host view container status - <code>docker ps --filter \"name=trmm-meshcentral\"</code></li> <li>View logs: <code>docker compose logs tactical-meshcentral</code></li> <li>\"tail\" logs: <code>docker compose logs tactical-meshcentral | tail</code></li> <li>Shell access: <code>docker exec -it trmm-meshcentral /bin/bash</code></li> </ul> <ul> <li>Open either \"Take Control\" or \"Remote Background\" to get mesh login token.</li> <li>Open https://mesh.example.com to open native mesh admin interface.</li> <li>Left-side \"My Server\" &gt; Choose \"Console\" &gt; type <code>agentstats</code></li> <li>To view detailed logging goto \"Trace\" &gt; click Tracing button and choose categories.</li> </ul> <p>If you run <code>sudo systemctl status --full --no-pager meshcentral</code> and you don't see <code>Active: active (running) since ...</code></p> <p>You can manually run meshcentral using this command to see the full output with errors.</p> <pre><code>sudo systemctl stop meshcentral\ncd /meshcentral/\n/usr/bin/node node_modules/meshcentral\n</code></pre>"},{"location":"howitallworks/#meshcentral-agent","title":"MeshCentral Agent","text":"<p>Get Mesh Agent Version info with this command. Should match server version.</p> <p><pre><code>\"C:\\Program Files\\Mesh Agent\\MeshAgent.exe\" -info\"\n</code></pre> Compare the hash with the tags in the repo at https://github.com/Ylianst/MeshAgent/tags.</p> <p>Checks / tasks / agent data uses regular http to Nginx.</p> <p>Agent status uses NATS websockets.</p>"},{"location":"howitallworks/#other-dependencies","title":"Other Dependencies","text":"<p>Django - Framework to enable the server to interact with browser.</p> Django dependencies <pre><code>future==0.18.2\nloguru==0.5.3\nmsgpack==1.0.2\npackaging==20.9\npsycopg2-binary==2.9.1\npycparser==2.20\npycryptodome==3.10.1\npyotp==2.6.0\npyparsing==2.4.7\npytz==2021.1\n</code></pre> <p>qrcode - Creating QR codes for 2FA.</p> qrcode dependencies <pre><code>requests==2.25.1\nsix==1.16.0\nsqlparse==0.4.1\n</code></pre> <p>Twilio - Python SMS notification integration.</p> twilio dependencies <pre><code>urllib3==1.26.5\nuWSGI==2.0.19.1\nvalidators==0.18.2\nvine==5.0.0\nwebsockets==9.1\nzipp==3.4.1\n</code></pre>"},{"location":"howitallworks/#windows-agent","title":"Windows Agent","text":"<p>Found in <code>%programfiles%\\TacticalAgent</code></p> <p>The Tactical RMM agent runs under the <code>SYSTEM</code> security context.</p> <p>When scripts / checks execute, they are:</p> <ol> <li>Transferred from the server via NATS.</li> <li>Saved to a randomly created file in <code>C:\\ProgramData\\TacticalRMM</code>.</li> <li>Executed.</li> <li>Return info is captured and returned to the server via NATS.</li> <li>File in <code>C:\\ProgramData\\TacticalRMM</code> is removed automatically after execution / timeout.</li> <li>Command Parameters for scripts stay in memory</li> </ol> <p>Also \"Send Command\" stay in memory as well.</p> <p>Having said that...Windows logs all things PowerShell: <code>Event Viewer</code> &gt; <code>Microsoft</code> &gt; <code>Windows</code> &gt; <code>PowerShell</code> &gt; <code>Operational</code> Log so be careful with fancy API calls and auth token using agents for execution.</p> <p>Warning</p> <p>Remember: Auth tokens are Username/Password/2FA verification all rolled into a single chunk of text!</p>"},{"location":"howitallworks/#runasuser-functionality","title":"RunAsUser functionality","text":"<p>Now that we know the agent runs under the <code>SYSTEM</code> security context and what that means, there is an option to \"RunAsUser\" (Windows only).</p> <p>There are multiple things to understand and consider.</p> <ol> <li>TRMMs native \"RunAsUser\" is only supported on workstations and non-RDP/terminal services servers.</li> <li>The user has to be logged in, if the computer is still sitting at the Login screen there will be no active user to discover, and fail. If you're using fast user switching, it is the active user that will be discovered and used.</li> </ol> <p>There are two ways to do RunAsUser with tactical in relation to scripting.</p> <ol> <li>The Tactical RMM \"RunAsUser\" checkbox associated with the script, and all code will be run under the actively logged in user only with their security permissions. The user access token that will be used is the limited user access token. You will not be able to do any admin level stuff because TRMM's RunAsUser doesn't have a UAC elevation capability to call and request a 2nd access token with admin privileges.</li> <li>Using the PowerShell \"RunAsUser\" 3rd party module</li> </ol>"},{"location":"howitallworks/#outbound-firewall-rules_1","title":"Outbound Firewall Rules","text":"<p>If you have strict firewall rules these are the only outbound rules from the agent needed for all functionality:</p> <ol> <li> <p>All agents have to be able to connect outbound to TRMM server on the 3 domain names on port 443.</p> </li> <li> <p>The agent uses <code>https://icanhazip.tacticalrmm.io/</code> to get public IP info. If this site is down for whatever reason, the agent will fallback to <code>https://icanhazip.com</code> and then <code>https://ifconfig.co/ip</code></p> </li> </ol>"},{"location":"howitallworks/#unsigned-agents","title":"Unsigned Agents","text":"<p>Unsigned agents require access to: <code>https://github.com/amidaware/rmmagent/releases/*</code> for downloading / updating agents.</p>"},{"location":"howitallworks/#signed-agents","title":"Signed Agents","text":"<p>Signed agents require access to: <code>https://agents.tacticalrmm.com</code> for downloading / updating agents.</p>"},{"location":"howitallworks/#agent-installation-process","title":"Agent Installation Process","text":"<ul> <li>Copies temp files to <code>C:\\ProgramData\\TacticalRMM</code> folder.</li> <li>INNO setup installs app into <code>%ProgramFiles%\\TacticalAgent\\</code> folder.</li> </ul>"},{"location":"howitallworks/#agent-update-process","title":"Agent Update Process","text":"<p>Downloads latest <code>tacticalagent-vx.x.x.exe</code> to <code>%PROGRAMDATA\\TacticalRMM%</code>.</p> <p>Executes the file (INNO setup exe).</p> <p>Log file <code>C:\\ProgramData\\TacticalRMM\\tacticalagent_update_vX.X.X.txt</code> is created.</p>"},{"location":"howitallworks/#tactical-agent-debugging","title":"Tactical Agent Debugging","text":"<p>Choose your method:</p>  Windows Automatically Windows Manually Linux Mac <p>If the Tactical agent is connecting to your server, you can use the Community scripts:</p> <ul> <li><code>TacticalRMM - TRMM Agent enable Debug Mode</code></li> <li><code>TacticalRMM - TRMM Agent disable Debug Mode</code></li> <li>and <code>TacticalRMM - Get Agent Logs</code></li> </ul> <p>Open CMD as admin on the problem computer and stop the agent services:</p> <pre><code>net stop tacticalrmm\n</code></pre> <p>Run the tacticalrmm service manually with debug logging:</p> <pre><code>\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m rpc -log debug -logto stdout\n</code></pre> <p>Note</p> <p>There's a Community script that will collect your agent log called <code>TacticalRMM - Get Agent Logs</code>.</p> <p>As root user, edit:</p> <pre><code>vi /etc/systemd/system/tacticalagent.service\n</code></pre> <p>Change</p> <pre><code>ExecStart=/usr/local/bin/tacticalagent -m svc\n</code></pre> <p>to</p> <pre><code>ExecStart=/usr/local/bin/tacticalagent -m svc -log debug\n</code></pre> <p>then</p> <pre><code>systemctl daemon-reload\nsystemctl restart tacticalagent.service\n</code></pre> <p>In terminal window:</p> <pre><code>sudo launchtl list | grep -e mesh -e tacticalagent\n</code></pre>"},{"location":"howitallworks/#mesh-agent-recovery","title":"Mesh Agent Recovery","text":"<p>Use Agents right click menu &gt; <code>Agent recovery</code> &gt; <code>Mesh Agent</code></p>"},{"location":"howitallworks/#tactical-agent-recovery","title":"Tactical Agent Recovery","text":"<p>Use Agents right click menu &gt; <code>Agent recovery</code> &gt; <code>Tactical Agent</code></p> <p>...OR</p>  MeshCentral is online From Local Machine <p>Connect to <code>Terminal</code> (Admin Shell)</p> <p>Run</p> <pre><code>net stop tacticalrmm\nnet start tacticalrmm\n</code></pre> <p>Check if Tactical RMM agent is online.</p> <p>Start / Restart Tactical RMM service from either <code>services.msc</code> or from Admin Command prompt:</p> <pre><code>net stop tacticalrmm\nnet start tacticalrmm\n</code></pre> <p>Open <code>C:\\Program Files\\TacticalAgent\\agent.log</code> to look for issues.</p>"},{"location":"howitallworks/#windows-update-management","title":"Windows Update Management","text":"<p>The current Tactical RMM Windows Update process is relatively simple atm. As of right now, it is in the top 3 big items to be reworked.</p>"},{"location":"howitallworks/#tldr-tactical-rmm-based-patching-recommendation","title":"TLDR: Tactical RMM Based Patching Recommendation","text":"<ul> <li>Use the <code>Automation Policy</code> &gt; <code>Patch Policy</code> to apply it to machines. The <code>Other</code> category is poorly named by Microsoft, those are the regular monthly updates and should be auto-approved.</li> <li>Be patient, and things will be patched (based on the policy).</li> <li>Trying to immediately approve patches to many machines OR block specific patches is a slow and manual process.</li> </ul> <p>Note</p> <p>If you want more control of Windows patching right now, look into a script-based implementation of PSWindowsUpdate.</p> <p>Be aware: When you install the Tactical RMM Agent on a Windows computer it sets this:</p> <pre><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\nAUOptions (REG_DWORD):\n1: Keep my computer up to date is disabled in Automatic Updates.\n</code></pre> <p>If you want to resume normal Windows patching and disable Tactical RMM updating functions, you should run this.</p> <p>Where does it get updates from? TRMM gets the list of Windows updates using this Microsoft API: https://docs.microsoft.com/en-us/windows/win32/api/_wua/</p> <p>The Tactical RMM server updates an agent's patch list every 8 hours based on the patch policy to check for what to update, and what's installed.</p> <p>Note</p> <p>Currently if the agent is not online at the time the patch policy is set to install, there is no \"install as soon as it comes online\".</p> <p>Tip</p> <p>Trying to get reboots to happen at specific times after Windows update? Set your <code>Reboot After Installation</code> to: Never Then create a task that reboots at your preferred date/time</p>"},{"location":"howitallworks/#log-files","title":"Log Files","text":"<p>You can find 3 sets of detailed logs at <code>/rmm/api/tacticalrmm/tacticalrmm/private/log</code>.</p> <ul> <li><code>error.log</code> Nginx log for all errors on all TRMM URL's: rmm, api and mesh</li> </ul> <pre><code>tail -f /rmm/api/tacticalrmm/tacticalrmm/private/log/error.log\n</code></pre> <ul> <li><code>access.log</code> Nginx log for auditing access on all URL's: rmm, api and mesh (this is a large file, and should be cleaned periodically)</li> </ul> <pre><code>tail -f /rmm/api/tacticalrmm/tacticalrmm/private/log/access.log\n</code></pre> <ul> <li><code>django_debug.log</code> created by Django webapp</li> </ul> <pre><code>tail -f /rmm/api/tacticalrmm/tacticalrmm/private/log/django_debug.log\n</code></pre>"},{"location":"howitallworks/#failed-successful-admin-logins","title":"Failed / Successful Admin logins","text":"<p>These are logged in <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/access.log</code></p> <p>Successful Login</p> <pre><code>10.0.0.18 - - [21/May/2025:00:01:43 -0400] \"POST /v2/checkcreds/ HTTP/1.1\" 200 13 \"https://rmm.example.com/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36\"\n</code></pre> <p>Failed Login</p> <pre><code>10.0.8.62 - - [21/May/2025:00:01:13 -0400] \"POST /v2/checkcreds/ HTTP/1.1\" 400 17 \"https://rmm.example.com/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36\"\n</code></pre> Field Description <code>10.0.0.18</code> Client IP address <code>-</code> Unused (RFC 1413 identity) <code>-</code> Unused (authenticated user ID) <code>[21/May/2025:00:01:43 -0400]</code> Timestamp (local time with timezone offset) <code>\"POST /v2/checkcreds/ HTTP/1.1\"</code> HTTP request method, path, and version <code>200</code> HTTP status code (200 = OK/success) (400 = Failed) <code>13</code> Response size in bytes (body only) <code>\"https://rmm.example.com/\"</code> Referer URL (origin of the request) <code>\"Mozilla/5.0 (Windows NT 10.0;...)</code> User-Agent string (browser and OS info) <p>Fail2Ban uses this to limit password guessing</p>"},{"location":"install_agent/","title":"Installing a Windows Agent","text":"<p>Warning</p> <p>You must add antivirus exclusions for the tactical agent. AV will usually flag the agent as a virus, since it technically is one due to the nature of this software. Adding the following exclusions will make sure everything works, including agent update: <pre><code>#Windows Defender Exclusions for Tactical\nAdd-MpPreference -ExclusionPath \"C:\\Program Files\\Mesh Agent\\*\"\nAdd-MpPreference -ExclusionPath \"C:\\Program Files\\TacticalAgent\\*\"\nAdd-MpPreference -ExclusionPath \"C:\\ProgramData\\TacticalRMM\\*\"\nAdd-MpPreference -ExclusionPath \"C:\\Windows\\Temp\\is-*.tmp\\tacticalagent*\"\nAdd-MpPreference -ExclusionProcess \"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\"\nAdd-MpPreference -ExclusionProcess \"C:\\ProgramData\\TacticalRMM\\tacticalagent*\"\nAdd-MpPreference -ExclusionProcess \"C:\\Windows\\Temp\\is-*.tmp\\tacticalagent*\"\n</code></pre> See here for other screenshot examples.</p>"},{"location":"install_agent/#ui","title":"UI","text":"<p>Click Agents &gt; Install Agent.</p> <p></p> <p>You can also right click on a site &gt; Install Agent. This will automatically fill in the client / site dropdown for you.</p> <p></p>"},{"location":"install_agent/#manual","title":"Manual","text":"<p>The 'Manual' installation method requires you to first download the Inno Setup installer and call it using command line args.</p> <p>This is useful for scripting the installation using Group Policy or some other batch deployment method.</p> <p>This or the Powershell method are also the preferred method of installing if you don't want this to happen.</p>"},{"location":"install_agent/#dynamically-generated-executable","title":"Dynamically Generated Executable","text":"<p>The dynamically generated exe is a standalone binary which is simply a wrapper around the Manual install method, using a single exe / command without the need to pass any command line flags to the installer. All it does is download the Inno Setup installer and call it using predefined command line args that you choose from the web UI. It \"bakes\" the command line args into the executable. Please note that using this method can result in this.</p> <p></p>"},{"location":"install_agent/#powershell","title":"PowerShell","text":"<p>The PowerShell method is also a wrapper around the Manual install method and functionally identical to the dynamically generated EXE installer but in powershell format instead of EXE format.</p> <p></p> <p>Tip</p> <p>You can reuse the installer for any of the deployment methods, you don't need to constantly create a new installer for each new agent. The installer will be valid for however long you specify the token expiry time when generating an agent.</p>"},{"location":"install_agent/#using-a-deployment-link","title":"Using a Deployment Link","text":"<p>The main benefit of this method is that the executable is generated only whenever the deployment download link is accessed, whereas with the other methods it's generated right away and the agent's version is hardcoded into the exe. Using a deployment link will allow you to not worry about installing using an older version of an agent, which will fail to install if you have updated your RMM to a version that is not compatible with an older installer you might have lying around. The deployment link method uses the dynamic EXE method behind the scenes.</p> <p>To create a deployment, from the web UI click Agents &gt; Manage Deployments. </p> <p>Tip</p> <p>Create a client / site named \"Default\" and create a deployment for it with a very long expiry to have a generic installer that can be deployed anytime at any client / site. You can then move the agent into the correct client / site from the web UI after it's been installed.</p> <p>Copy / paste the download link from the deployment into your browser. It will take a few seconds to dynamically generate the executable and then your browser will automatically download the exe.</p>"},{"location":"install_agent/#optional-installer-args","title":"Optional Installer Args","text":"<p>The following optional arguments can be passed to any of the installation method executables:</p> <pre><code>--log debug\n</code></pre> <p>Will print very verbose logging during agent install. Useful for troubleshooting agent install.</p> <pre><code>--silent\n</code></pre> <p>This will not popup any message boxes during install, including any error messages or the \"Installation was successful\" message box that pops up at the end of a successful install.</p> <pre><code>--proxy \"http://proxyserver:port\"\n</code></pre> <p>Use a http proxy.</p> <pre><code>--meshdir \"C:\\Program Files\\Your Company Name\\Mesh Agent\"\n</code></pre> <p>Specify the full path to the directory containing <code>MeshAgent.exe</code> if using custom agent branding for your MeshCentral instance.</p> <pre><code>--nomesh\n</code></pre> <p>Do not install MeshCentral agent during Tactical agent install. Note: Take Control, Remote Terminal and File Browser will not work.</p> <p>You can get full command line options from (<code>--help</code>).</p>"},{"location":"install_agent/#scripting-agent-installation","title":"Scripting Agent Installation","text":"<p>If you want to deploy the TRMM agent using AD, Intune, Mesh, TeamViewer, Group Policy GPO, etc, this is a sample CMD script for deploying Tactical.</p> Install Scripts  batch file powershell msi AD GPO <p>Note</p> <p>You will need to replace <code>deployment url</code> with your custom deployment URL:</p> <pre><code>@echo off\n\nREM Setup deployment URL\nset \"DeploymentURL=!!!REPLACEME!!!\"\n\nfor /f \"delims=\" %%g in ('powershell -NoProfile -Command \"(Get-Service -Name tacticalrmm -ErrorAction SilentlyContinue).Name\"') do (\nset \"Name=%%g\"\n)\n\nif not defined Name (\necho Tactical RMM not found, installing now.\nif not exist \"C:\\ProgramData\\TacticalRMM\\temp\" md \"C:\\ProgramData\\TacticalRMM\\temp\"\npowershell Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Force\npowershell Add-MpPreference -ExclusionPath \"C:\\Program Files\\TacticalAgent\\*\"\npowershell Add-MpPreference -ExclusionPath \"C:\\Program Files\\Mesh Agent\\*\"\npowershell Add-MpPreference -ExclusionPath \"C:\\ProgramData\\TacticalRMM\\*\"\npowershell Add-MpPreference -ExclusionProcess \"C:\\Windows\\Temp\\is-*.tmp\\tacticalagent*\"\ncd /d \"C:\\ProgramData\\TacticalRMM\\temp\"\npowershell Invoke-WebRequest \"%DeploymentURL%\" -Outfile tactical.exe\ntactical.exe\n) else (\necho Tactical RMM already installed Exiting\nexit 0\n)\n</code></pre> <pre><code># Update variables\n$deploymenturl = \"&lt;deployment URL&gt;\"\n$agentstoinstall = 1 # Replace with the number of agents to install if greater than 20\n\n# Do not modify below here\nAdd-MpPreference -ExclusionPath \"C:\\Program Files\\Mesh Agent\\*\"\nAdd-MpPreference -ExclusionPath \"C:\\Program Files\\TacticalAgent\\*\"\nAdd-MpPreference -ExclusionPath \"C:\\ProgramData\\TacticalRMM\\*\"\nAdd-MpPreference -ExclusionProcess \"C:\\Windows\\Temp\\is-*.tmp\\tacticalagent*\"\n$randomSleepTime = if ($agentstoinstall -gt 1) { Get-Random -Minimum 1 -Maximum (($agentstoinstall + 1) * 2) } else { 1 }\nStart-Sleep -Seconds $randomSleepTime\nInvoke-WebRequest $deploymenturl -OutFile (New-Item -Path \"c:\\ProgramData\\TacticalRMM\\temp\\trmminstall.exe\" -Force)\n$proc = Start-Process \"c:\\ProgramData\\TacticalRMM\\temp\\trmminstall.exe\" -ArgumentList '-silent' -PassThru\nWait-Process -InputObject $proc\nif ($proc.ExitCode -ne 0) {\n    Write-Warning \"$proc exited with status code $($proc.ExitCode)\"\n}\nRemove-Item -Path \"c:\\ProgramData\\TacticalRMM\\temp\\trmminstall.exe\" -Force\n</code></pre> <ul> <li>Use <code>Agents</code> menu &gt; <code>Manage Deployments</code></li> <li>Generate a deployment link with an expiry date set to very far in the future, then access the link to download the executable.</li> <li>Create the msi</li> <li>Apply via GPO software deployment to the appropriate machines</li> </ul> <p>For Active Directory Group Policy Deployment you can deploy via Batch File. It'll check to see if installed and only install when missing.</p> <pre><code>@echo off\n\nREM Setup deployment URL\nset \"DeploymentURL=snip\"\n\nSC query \"TacticalRMM\" &gt;nul 2&gt;&amp;1\n\nIF %ERRORLEVEL% EQU 1060 (\n    echo Tactical RMM not found, installing now.\n    if not exist c:\\ProgramData\\TacticalRMM\\temp md c:\\ProgramData\\TacticalRMM\\temp\n    powershell Set-ExecutionPolicy -ExecutionPolicy Unrestricted\n    powershell Add-MpPreference -ExclusionPath \"C:\\Program Files\\TacticalAgent\\*\"\n    powershell Add-MpPreference -ExclusionPath \"C:\\Program Files\\Mesh Agent\\*\"\n    powershell Add-MpPreference -ExclusionPath C:\\ProgramData\\TacticalRMM\\*\n    powershell Add-MpPreference -ExclusionProcess \"C:\\Windows\\Temp\\is-*.tmp\\tacticalagent*\"\n    cd c:\\ProgramData\\TacticalRMM\\temp\n    powershell Invoke-WebRequest \"%DeploymentURL%\" -Outfile tactical.exe\n    tactical.exe\n    exit /b 0\n) ELSE (\n    REM Service exists (it might be running or stopped, but it is installed)\n    EXIT /B 0\n)\n</code></pre>"},{"location":"install_agent/#script-for-full-agent-uninstall","title":"Script for Full Agent Uninstall","text":"<p>You can always use this to silently uninstall the agent on workstations:</p> <p>Choose your method:</p>  Windows Automatically Mac linux <pre><code>\"C:\\Program Files\\TacticalAgent\\unins000.exe\" /VERYSILENT\n</code></pre> <p>Run: https://github.com/amidaware/tacticalrmm/blob/develop/api/tacticalrmm/core/mac_uninstall.sh</p> <p>Download: https://raw.githubusercontent.com/amidaware/tacticalrmm/develop/api/tacticalrmm/core/agent_linux.sh</p> <p>Run: <code>chmod +x agent_linux.sh &amp;&amp; ./agent_linux.sh uninstall</code></p>"},{"location":"install_agent/#reinstalling-mesh-and-reconnecting-to-trmm","title":"Reinstalling Mesh and Reconnecting to TRMM","text":"<p>Run this from Send Command:</p> <pre><code>\"C:\\Program Files\\Mesh Agent\\meshagent.exe\" -fullinstall\n</code></pre> <p>Then use Agent Recovery &gt; Mesh Agent, and choose Recover:</p>"},{"location":"install_agent/#stuck-at-downloading-mesh-agent","title":"Stuck at \"Downloading mesh agent...\"?","text":"<p>Make sure TRMM can connect to Mesh. Run:</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py check_mesh\n</code></pre> <p>If there's an error, make sure you have it setup correctly.</p> <p></p>"},{"location":"install_agent/#install-linux-agent-beta","title":"Install Linux Agent (beta)","text":"<p>To install: 1. Go to rmm.yourdomain.com and login. 2. Click on Agents &gt; Install Agent. 3. Choose the Client, Site, Server or Workstation and Architecture (change expiry if required) as well as Linux. 4. Click Download. 5. If downloaded on the Linux machine you want to add as an agent (otherwise copy to machine using WinSCP or similar) open terminal.  6. cd to the folder you have downloaded the script to. 7. Run <code>chmod +x rmm-clientname-sitename-type.sh</code> 8. Run <code>sudo ./rmm-clientname-sitename-type.sh</code> and wait for script to complete.</p> <p>If you changed the expiry time you could upload the script to any accessible server and deploy to multiple devices.</p> <pre><code>-- debug\n</code></pre> <p>Will print very verbose logging during agent install. Useful for troubleshooting agent install.</p>"},{"location":"install_agent/#linux-deployment-link","title":"Linux Deployment Link","text":"<p>Currently there are no deploy links for Linux agents however you could use the following method if uploaded somewhere (website etc).</p> <p>An example deployment script would be (note there's an install token in that script, so delete it when done if you're concerned):</p> <pre><code>wget scripturl\nchmod +x rmm.sh\n./rmm.sh\n</code></pre>"},{"location":"install_agent/#mac-agent-permissions","title":"Mac Agent Permissions","text":"macOS 15+ Sequoia macOS 14 Sonoma and earlier <p>Enable Screen Sharing under settings.</p> <p></p> <p>Top switch is the only item needed for TRMM access.</p> <p>Do not enable anything else.</p> <p>Warning</p> <p>Enabling <code>Anyone may request permission to control screen</code> and <code>VNC viewers may control screen with password</code> will enable Mac-proprietary VNC options that will make TRMM's VNC implementation fail.</p> <p></p> <p>Note</p> <p>This enabled the native VNC client on MacOS. If you don't limit in the <code>Allow access for</code> to <code>Only theses users</code> make certain you don't have other users or users without passwords.</p> <p>Step 1: Open System Preferences Click on the Apple logo in the top-left corner of your screen. Select System Preferences from the dropdown menu.</p> <p>Step 2: Navigate to Security &amp; Privacy In the System Preferences window, click on Security &amp; Privacy. At the top of the Security &amp; Privacy window, click the Privacy tab.</p> <p></p> <p>Step 3: Grant Accessibility Permissions In the list on the left, scroll down and select Accessibility. If the padlock in the bottom-left corner is locked, click it and enter your password to make changes. Click the plus (+) button under the list on the right side. Navigate to and add tacticalagent from the /opt/tacticalagent/ folder and meshagent in the /opt/tacticalmesh/ folder. Ensure both are checked in the list to grant them Accessibility Permissions.</p> <p></p> <p>Step 4: Grant Screen Recording Permissions In the list on the left, find and select Screen Recording. Unlock the padlock if necessary as described above. Click the plus (+) button and add meshagent from the /opt/tacticalmesh/ folder, or check the boxes next to them if they're already listed. A prompt may appear asking you to quit Meshcentral. Please do so to enable the permissions.</p> <p></p> <p>Step 5: Grant Full Disk Access In the list on the left, scroll down and select Full Disk Access. Unlock the padlock if necessary as described above. Click the plus (+) button and add tacticalagent from the /opt/tacticalagent/ folder and meshagent from the /opt/tacticalmesh/ folder, or check the boxes next to them if they're already listed.</p> <p></p> <p>Finalizing the Setup Restart Your Applications: Quit and restart Tactical RMM and Meshcentral for the changes to take effect. Restart Your Mac: If the applications do not recognize the new permissions, a system restart may be necessary.</p>"},{"location":"install_considerations/","title":"Install Considerations","text":"<p>Exclamation</p> <p>Paid Hosted TRMM is available! Stop reading now and open a ticket for pricing.</p> <p>There's pluses and minuses to each install type (Standard vs Docker which is currently unsupported). Be aware that:</p> <ul> <li>There is no migration script. Once you've installed with one type there is no \"conversion\". You'll be installing a new server and migrating agents manually if you decide to go another way.</li> </ul> <p>Warning</p> <p>Tactical RMM does not support changing DNS names, so choose your names wisely. If you need to change your DNS name later a paid migration is possible.</p>"},{"location":"install_considerations/#debian-vs-ubuntu","title":"Debian vs Ubuntu","text":"Base RAM Usage OS 80MB Clean install of Debian 300MB Clean install of Ubuntu <p>Because of RAM usage alone, we recommend Debian 12.</p>"},{"location":"install_considerations/#traditional-install-officially-supported","title":"Traditional Install - Officially supported","text":"<ul> <li>It's a VM/machine. One storage device to backup if you want to do VM based backups.</li> <li>You have a backup and restore script.</li> <li>Much easier to troubleshoot when things go wrong.</li> <li>Faster performance / easier to fine tune and customize to your needs.</li> </ul>"},{"location":"install_considerations/#docker-install","title":"Docker Install","text":"<ul> <li>Docker is more complicated in concept: has volumes and images.</li> <li>Backup/restore is via Docker methods only.</li> <li>Docker has container replication/mirroring options for redundancy/multiple servers.</li> <li>NOT officially supported and NOT recommended for production use at the moment unless you are very comfortable managing/troubleshooting docker.</li> </ul>"},{"location":"install_considerations/#azure-vms","title":"Azure VMs","text":"<p>Azure ranks their VM's in Series https://azure.microsoft.com/en-us/pricing/details/virtual-machines/series/.</p> <p>Tactical RMM will run poorly in CPU limited VMs. So DO NOT use Series A or Series B VMs. You will need at least a Series F or better. Also, make sure there is no IO throttling / IOPS limits for the VM.</p> <p>The same applies for other big cloud providers that throttle low end VMs.</p>"},{"location":"install_considerations/#larger-installs","title":"Larger Installs","text":"<p>If you're having more than 200 agents, that's a larger install. You're probably also a business and making (and saving?) money with Tactical RMM, you're supporting the project right?</p> <p>You should be aware of server defaults like <code>Default script run time: 120 seconds</code></p> <p>Imagine you have 10 check, on 500 computers, running every 120 seconds. </p> <p>For checks alone, that's 5000 writes every 120 seconds, or 3.6 million database entries created every 24hrs. Default retention on check history is 30 days, so your check history database is probably averaging 108,000,000 records before regular data purges. That's a lot of write-wear on your SSD-based storage layer. </p> <p>Do you really need your Disk Space check running more than 1-2 times a day? Probably not. </p> <p>Also consider staggering the times of all your checks, so that each check is naturally spreading the load on your server at more random intervals instead of focusing all checks at exactly the same time. </p> <p>So in Summary:</p> <ul> <li>Please support the project, we do need it!</li> <li>Adjust script default run intervals</li> <li>Don't have checks (and tasks) all run at the same time</li> </ul> <p>If you have questions please open a ticket to discuss looking at your server and configuration, load testing, and giving recommendations.</p>"},{"location":"install_docker/","title":"Docker Setup","text":"<p>Danger</p> <p>Docker is not officially supported at the moment and not recommended for production use unless you are an advanced docker user and very comfortable managing and troubleshooting docker. Please read the docker install considerations before continuing.</p>"},{"location":"install_docker/#install-docker","title":"Install Docker","text":"<p>Install docker.</p> <p>Please keep in mind that the docker package is usually called docker.io in debian based distros including ubuntu</p>"},{"location":"install_docker/#create-the-dns-a-records","title":"Create the DNS A records","text":"<p>Warning</p> <p>All 3 domain names have to be at the same subdomain level because you only get one LetsEncrypt wildcard cert, and it'll only apply to that level of DNS name.</p> <p>We'll be using <code>example.com</code> as our domain for this example.</p> <p>Info</p> <p>The RMM uses 3 different sites. The Vue frontend e.g. <code>rmm.example.com</code> which is where you'll be accessing your RMM from the browser, the REST backend e.g. <code>api.example.com</code> and MeshCentral e.g. <code>mesh.example.com</code></p> <ol> <li>Get the public IP of your server with <code>curl https://icanhazip.tacticalrmm.io</code></li> <li>Open the DNS manager of wherever the domain you purchased is hosted.</li> <li>Create 3 A records: <code>rmm</code>, <code>api</code> and <code>mesh</code> and point them to the public IP of your server:</li> </ol> <p></p>"},{"location":"install_docker/#acquire-lets-encrypt-wildcard-certs-with-certbot","title":"Acquire Let's Encrypt wildcard certs with Certbot","text":"<p>Warning</p> <p>If the Let's Encrypt wildcard certificates are not provided, a self-signed certificate will be generated and most agent functions won't work.</p> <p>1 ) Install Certbot</p> <pre><code>sudo apt-get install certbot\n</code></pre> <p>2 ) Generate the wildcard Let's Encrypt certificates</p> <p>We're using the DNS-01 challenge method.</p> <p>3 ) Deploy the TXT record in your DNS manager</p> <p>Warning</p> <p>TXT records can take anywhere from 1 minute to a few hours to propagate depending on your DNS provider. You should verify the TXT record has been deployed first before pressing Enter. A quick way to check is with the following command: <code>dig -t txt _acme-challenge.example.com</code> or test using: https://viewdns.info/dnsrecord/ Enter: <code>_acme-challenge.example.com</code></p> <p></p> <p></p> <p>4 ) Request  ncrypt wildcard cert</p> <pre><code>sudo certbot certonly --manual -d *.example.com --agree-tos --no-bootstrap --preferred-challenges dns\n</code></pre> <p>Note</p> <p>Replace <code>example.com</code> with your root domain.</p>"},{"location":"install_docker/#configure-dns-and-firewall","title":"Configure DNS and firewall","text":"<p>You will need to add DNS entries so that the three subdomains resolve to the IP of the docker host. There is a reverse proxy running that will route the hostnames to the correct container. On the host, you will need to ensure the firewall is open on TCP port 443.</p>"},{"location":"install_docker/#setting-up-the-environment","title":"Setting up the environment","text":"<p>Get the docker-compose and .env.example file on the host you which to install on</p> <pre><code>wget https://raw.githubusercontent.com/amidaware/tacticalrmm/master/docker/docker-compose.yml\nwget https://raw.githubusercontent.com/amidaware/tacticalrmm/master/docker/.env.example\nmv .env.example .env\n</code></pre> <p>Change the values in .env to match your environment.</p> <p>When supplying certificates through Let's Encrypt, see the section below about base64 encoding the certificate files.</p>"},{"location":"install_docker/#base64-encoding-certificates-to-pass-as-env-variables","title":"Base64 encoding certificates to pass as env variables","text":"<p>Use the below command to add the the correct values to the .env.</p> <p>Running this command multiple times will add redundant entries, so those will need to be removed.</p> <p>Let's Encrypt certs paths are below. Replace ${rootdomain} with your own.</p> <p>public key <code>/etc/letsencrypt/live/${rootdomain}/fullchain.pem</code></p> <p>private key <code>/etc/letsencrypt/live/${rootdomain}/privkey.pem</code></p> <pre><code>echo \"CERT_PUB_KEY=$(sudo base64 -w 0 /path/to/pub/key)\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 /path/to/priv/key)\" &gt;&gt; .env\n</code></pre>"},{"location":"install_docker/#starting-the-environment","title":"Starting the environment","text":"<p>Run the below command to start the environment:</p> <pre><code>docker compose up -d\n</code></pre> <p>Removing the -d will start the containers in the foreground and is useful for debugging.</p> <p>If you get a error saying you don't have permission you can add yourself to the docker group with: <pre><code>sudo usermod -aG docker [user]\n</code></pre> You may need to log out and back in for it to take full effect.</p>"},{"location":"install_docker/#login","title":"Login","text":"<p>Navigate to <code>https://rmm.example.com</code> and login with the username/password you created during install.</p> <p>Once logged in, you will be redirected to the initial setup page.</p> <p>Create your first client/site and choose the default timezone.</p>"},{"location":"install_docker/#note-about-backups","title":"Note About Backups","text":"<p>The backup script does not work with docker. To backup your install use standard docker backup/restore processes.</p> <p>Or, you can look at larseberhardt/TRMM-Docker-Backup-Script.</p>"},{"location":"install_server/","title":"Installation","text":"<p>General Information</p> <p>Option 1: Easy Install on a VPS</p> <p>Option 2: Install behind NAT Router</p> <p>Option 3: Installs by Network Wizards</p> <p>Update Regularly</p>"},{"location":"install_server/#general-information","title":"General Information","text":"<p>Paid Hosting Available: Auto-maintained/updated servers with Code Signing for you. Get in touch to find out what we can do for you!</p>"},{"location":"install_server/#system-requirements","title":"System Requirements","text":"<p>A fresh Linux VM running either Debian 11, Debian 12 or Ubuntu 22.04 LTS with at least 4GB RAM on x64 or aarch64 (arm64) architecture.</p> <p>Warning</p> <p>The provided install script assumes a fresh server with no software installed on it. Attempting to run it on an existing server with other services will break things and the install will fail.</p> <p>Danger</p> <p>The installation script configures a production-grade reverse proxy using Nginx, which manages TLS termination and appropriately routes all requests to the correct backends. Consequently, there's no need for an additional proxy in front of your instance, as it will lead to complications. If you opt to use another reverse proxy (e.g., NPM, HAproxy) in conjunction with the existing Nginx reverse proxy (which is essential for TRMM to function correctly) you must address potential challenges arising from double proxying, and you should NOT expect your install to function properly out of the box. Be advised, configurations involving a secondary reverse proxy will be considered \"unsupported.\" This designation is not to deter modifications but stems from the development team's capacity constraints. Their primary focus remains on enhancing the core software, and they cannot support an endless variety of setups. Check unsupported proxies and unsupported guidelines for more info.</p> <p>Note</p> <p>The install script has been tested on the following public cloud providers: Oracle Cloud Free Tier (arm64), DigitalOcean, Linode, Vultr, Hetzner (highly recommended), AWS, Google Cloud and Azure, as well as behind NAT on Hyper-V, ESXi and Proxmox (CT's on Proxmox are unsupported, only use VMs).</p> <p>Note</p> <p>CPU: 1 core is fine for &lt; 200 agents with limited checks/tasks. Disk space and speed are dependent on your use case. Of course faster is better SSD/NVMe. Space is dependent on how long you're keeping historical data, how many checks/script runs and their output size. 50GB should be fine for &lt; 12months of history on &lt; 200 agents with &lt; 30 checks/tasks run at reasonable time intervals.</p> <p>Tip</p> <p>Enable logging of your terminal output. A good Windows SSH client is MobaXTerm. It'll automatically log everything so if you need it later (like install logs because you have a 50x error trying to login after) they'll be easy to grab and share with support. It has an integrated SCP client too!</p>"},{"location":"install_server/#install-requirements","title":"Install Requirements","text":"<ul> <li>A TOTP based authenticator app. Some popular ones are Google Authenticator, Authy, and Microsoft Authenticator.</li> </ul> <p>Warning</p> <ol> <li>Per RFC 1304 special chars in domain names are not allowed (like _ ). Only a-z 0-9 and the hyphen (-)</li> <li>Avoid sub-sub domains greater than 4. (Best: rmm.example.com Good: rmm.corp.example.com Bad: rmm.corp.xyz.example.com) Country TLDs like <code>co.uk</code> count as one layer.</li> </ol>"},{"location":"install_server/#option-1-easy-install-on-a-vps","title":"Option 1: Easy Install on a VPS","text":"<p>Install on a VPS: DigitalOcean, Linode, Vultr, Hetzner (highly recommended), AWS, Google Cloud and Azure to name a few.</p>"},{"location":"install_server/#step-1-run-updates-on-os","title":"Step 1 - Run Updates on OS","text":"<p>SSH into the server as root.</p> <p>Install the pre-reqs and apply the latest updates:</p> <pre><code>apt update\napt install -y wget curl sudo ufw\napt -y upgrade\n</code></pre> <p>If a new kernel is installed, reboot the server with the <code>reboot</code> command.</p>"},{"location":"install_server/#step-2-create-a-user","title":"Step 2 - Create a User","text":"<p>Create a user named <code>tactical</code> to run the RMM and add it to the sudoers group.</p> <pre><code>useradd -m -G sudo -s /bin/bash tactical\npasswd tactical\n</code></pre>"},{"location":"install_server/#step-3-setup-the-firewall-optional-but-highly-recommended","title":"Step 3 - Setup the firewall (optional but highly recommended)","text":"<p>Info</p> <p>Skip this step if your VM is not publicly exposed to the world e.g. running behind NAT. You should setup the firewall rules in your router instead. Port 443 TCP: For agents and tech login to rmm and mesh. Port 22 TCP: For SSH, server administration only</p> <pre><code>ufw default deny incoming\nufw default allow outgoing\nufw allow https\n</code></pre> <p>Info</p> <p>SSH (port 22 TCP) is only required for you to remotely login and do basic server administration for your RMM. It is not needed for any agent communication.</p> SSH Firewall Rule  Restrict SSH Allow all SSH <p>Allow SSH from only allowed IP's (highly recommended)</p> <pre><code>ufw allow proto tcp from X.X.X.X to any port 22\nufw allow proto tcp from X.X.X.X to any port 22\n</code></pre> <p>Allow SSH from everywhere (not recommended)</p> <pre><code>ufw allow ssh\n</code></pre> <p>Enable and activate the firewall:</p> <pre><code>ufw enable &amp;&amp; ufw reload\n</code></pre> <p>Note</p> <p>You should/will never login to the server as <code>root</code> again unless something has gone horribly wrong, and you're working with the developers.</p>"},{"location":"install_server/#step-4-create-dns-a-records","title":"Step 4 - Create DNS A records","text":"<p>Tactical RMM requires 3 separate subdomains: Frontend (<code>rmm</code>), Backend API (<code>api</code>), and MeshCentral (<code>mesh</code>). You can use different names if these are already in use.</p> <p>Important: All subdomains must be at the same level</p> <p>LetsEncrypt wildcard certificates cover only one subdomain level. All three domains must match that depth, and avoid nesting beyond 3 levels.</p> Status Example Domains Notes \u2705 Best <code>rmm.example.com</code><code>api.example.com</code><code>mesh.example.com</code><code>_acme-challenge.example.com</code> 2 levels (recommended) \u2705 Good <code>rmm.corp.example.com</code><code>api.corp.example.com</code><code>mesh.corp.example.com</code><code>_acme-challenge.corp.example.com</code> 3 levels, all at same depth \u2705 Good <code>rmm.example.co.uk</code><code>api.example.co.uk</code><code>mesh.example.co.uk</code><code>_acme-challenge.example.co.uk</code> Country TLD (<code>.co.uk</code> = 1 layer) \u274c Bad <code>rmm.example.com</code><code>api.rmm.example.com</code><code>mesh.rmm.example.com</code><code>_acme-challenge.example.com</code> Inconsistent levels \u274c Bad <code>rmm.corp.us.example.com</code><code>api.corp.us.example.com</code><code>mesh.corp.us.example.com</code> Too deep (4 levels) <p>We'll be using <code>example.com</code> as our domain for this example.</p> <ol> <li>Get the public IP of your server with <code>curl https://icanhazip.tacticalrmm.io</code>.</li> <li>Open the DNS manager of wherever the domain you purchased is hosted.</li> <li>Create 3 A records: <code>rmm</code>, <code>api</code> and <code>mesh</code> and point them to the public IP of your server:</li> </ol> <p></p>"},{"location":"install_server/#step-5-run-the-install-script","title":"Step 5 - Run the install script","text":"<p>Switch to the <code>tactical</code> user:</p> <pre><code>su - tactical\n</code></pre> <p>Tip</p> <p>If you can snapshot do that now so you can quickly restore to this point again and re-run the install in case something goes wrong with the install script.</p> <p>Download and run the install script:</p> <pre><code>wget https://raw.githubusercontent.com/amidaware/tacticalrmm/master/install.sh\nchmod +x install.sh\n./install.sh\n</code></pre> <p>Info</p> <p>Already have your own SSL certificate? Call the install script with the <code>--use-own-cert</code> flag, like this: <pre><code>./install.sh --use-own-cert\n</code></pre> Ensure your cert and private key exist on the server as the install script will prompt you for the locations of these 2 files.</p> <p>Also ensure that it is a legitimate, trusted certificate and includes the full chain for proper validation. Do not use this option with self-signed certs.</p> <p>Danger</p> <p>You can install with the <code>--insecure</code> switch to use any DNS name you want. Self signed certs will be generated for all the DNS names, and all SSL certificate chain validation will be disabled in TRMM.</p> <p><code>./install.sh --insecure</code></p> <p>Requirements: You MUST open all 3 subdomains in your web browser and accept the security warning for each site BEFORE LOGIN or you will get \"Backend is offline (network error)\" errors.</p> <p>\u2705 Quick install for easy test driving \u2705 No public DNS name needed. Use irulez.local or any DNS name you want. \u2705 No cert renewals \u274c All agent communication is vulnerable to MITM compromise and can be hacked. \u274c You can't convert from an <code>--insecure</code> to trusted cert install without reinstalling all your agents \u274c Can't use Agent install Deployment links. Manual installation method only \u274c Restore does not work</p> <p>Answer the initial questions when prompted. Replace <code>example.com</code> with your domain.</p> <p></p>"},{"location":"install_server/#step-6-deploy-the-txt-record-in-your-dns-manager-for-lets-encrypt-wildcard-certs","title":"Step 6 - Deploy the TXT record in your DNS manager for Let's Encrypt wildcard certs","text":"<p>Skip this step if using your own certs or using self-signed certs.</p> <p>Warning</p> <p>TXT records can take anywhere from 1 minute to a few hours to propagate depending on your DNS provider. You should verify the TXT record has been deployed first before pressing Enter. A quick way to check is with the following command: <code>dig -t txt _acme-challenge.example.com</code> (not from the TRMM server) or test using: https://viewdns.info/dnsrecord/ Enter: <code>_acme-challenge.example.com</code></p> <p></p> <p></p> <p>Create a login for the RMM web UI:</p> <p></p> <p>A bunch of URLS / usernames / passwords will be printed out at the end of the install script. Save these somewhere safe. Recover them if you didn't</p>"},{"location":"install_server/#step-7-login","title":"Step 7 - Login","text":"<p>Navigate to <code>https://rmm.example.com</code> and login with the username/password you created during install.</p> <p>Once logged in, you will be redirected to the initial setup page.</p> <p>Create your first client/site and choose the default timezone.</p> <p>You're Done</p> <p>Update Regularly</p>"},{"location":"install_server/#option-2-install-behind-nat-router","title":"Option 2: Install Behind NAT Router","text":"<p>Install in your local network using: Dedicated hardware, Hyper-V, Proxmox or ESXi. All been tested and work fine.</p> <p>Do everything from Option 1: Easy Install</p>"},{"location":"install_server/#if-you-only-have-agents-on-the-private-network-subnet","title":"If You Only Have Agents on the Private Network / Subnet","text":"<p>Make sure your local DNS server (or agents hosts file) have your Tactical RMM server IP addresses for the 3 domain names: <code>rmm</code>, <code>api</code> and <code>mesh</code></p>"},{"location":"install_server/#agents-exist-outside-the-private-network-subnet-setup-port-forwarding","title":"Agents Exist Outside the Private Network / Subnet - Setup Port Forwarding","text":"<p>If you have agents outside your local network: Make sure the public DNS servers have A records for the 3 Tactical RMM server domain names: <code>rmm</code>, <code>api</code> and <code>mesh</code></p> <p>Login to your router / NAT device.</p> <ol> <li>Set your TRMM server as a static IP (Using a DHCP reservation is usually safer).</li> <li>Port forward <code>TCP 443</code> to your TRMM servers private IP address.</li> </ol> <p>Note</p> <p>https://portforward.com/ can help with Port Forwarding setup</p> <p>You're Done</p> <p>Update Regularly</p>"},{"location":"install_server/#option-3-installs-by-network-wizards","title":"Option 3: Installs by Network Wizards","text":"<p>Use the scripts above.</p>"},{"location":"install_server/#requirements","title":"Requirements","text":"<ol> <li>TLD domain name which is internet resolvable (this is for a LetsEncrypt DNS wildcard request during the install script validated by DNS txt record).<ul> <li>Test using: https://viewdns.info/dnsrecord/ or https://dnschecker.org/. Enter: <code>_acme-challenge.example.com</code> as <code>TXT</code></li> </ul> </li> <li>Agents need to be able to connect to your server via DNS lookup (hosts file, local DNS, smoke signals etc.).<ul> <li>Test from agent: <code>ping rmm.example.com</code>. Should result in the IP of your Tactical RMM server.</li> <li>Test from agent: <code>ping api.example.com</code>. Should result in the IP of your Tactical RMM server.</li> <li>Test from agent: <code>ping mesh.example.com</code>. Should result in the IP of your Tactical RMM server.</li> </ul> </li> </ol> <p>Note</p> <p>Did you notice #2 doesn't need to be something publicly available?</p> <p>That's it. You're a wizard, you know how to satisfy these 2 items.</p> <p>You'll probably enjoy browsing thru the Unsupported section of the docs.</p>"},{"location":"install_server/#update-regularly","title":"Update Regularly","text":"<p>We've said it before, we'll say it again.</p> <ul> <li> <p>We recommend regular updates.</p> <ul> <li> <p>Every 2-3 months.</p> <ul> <li>Do it when you update your SSL certs.</li> </ul> </li> </ul> </li> </ul>"},{"location":"install_server/#install-video-walkthrus","title":"Install Video Walkthrus","text":""},{"location":"license/","title":"License","text":""},{"location":"license/#tactical-rmm-license-version-10","title":"Tactical RMM License Version 1.0","text":"<p>Text of license:\u2003\u2003\u2003Copyright \u00a9 2022 AmidaWare LLC.  All rights reserved. \u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u2003\u00a0Amending the text of this license is not permitted.</p> <p>Trade Mark:\u2003\u2003\u2003\u2003\"Tactical RMM\" is a trade mark of AmidaWare LLC.</p> <p>Licensor:\u2003\u2003\u2003\u2003\u2003\u00a0\u00a0AmidaWare LLC of 1968 S Coast Hwy PMB 3847 Laguna Beach, CA, USA.</p> <p>Licensed Software:\u2003\u00a0The software known as Tactical RMM Version v0.12.0 (and all subsequent releases and versions) and the Tactical RMM Agent v2.0.0 (and all subsequent releases and versions).</p>"},{"location":"license/#1-preamble","title":"1. Preamble","text":"<p>The Licensed Software is designed to facilitate the remote monitoring and management (RMM) of networks, systems, servers, computers and other devices.  The Licensed Software is made available primarily for use by organisations and managed service providers for monitoring and management purposes.</p> <p>The Tactical RMM License is not an open-source software license.  This license contains certain restrictions on the use of the Licensed Software.  For example the functionality of the Licensed Software may not be made available as part of a SaaS (Software-as-a-Service) service or product to provide a commercial or for-profit service without the express prior permission of the Licensor.</p>"},{"location":"license/#2-license-grant","title":"2. License Grant","text":"<p>Permission is hereby granted, free of charge, on a non-exclusive basis, to copy, modify, create derivative works and use the Licensed Software in source and binary forms subject to the following terms and conditions.  No additional rights will be implied under this license.</p> <ul> <li>The hosting and use of the Licensed Software to monitor and manage in-house networks/systems and/or customer networks/systems is permitted.</li> </ul> <p>This license does not allow the functionality of the Licensed Software (whether in whole or in part) or a modified version of the Licensed Software or a derivative work to be used or otherwise made available as part of any other commercial or for-profit service, including, without limitation, any of the following: * a service allowing third parties to interact remotely through a computer network; * as part of a SaaS service or product; * as part of the provision of a managed hosting service or product; * the offering of installation and/or configuration services; * the offer for sale, distribution or sale of any service or product (whether or not branded as Tactical RMM).</p> <p>The prior written approval of AmidaWare LLC must be obtained for all commercial use and/or for-profit service use of the (i) Licensed Software (whether in whole or in part), (ii) a modified version of the Licensed Software and/or (iii) a derivative work.</p> <p>The terms of this license apply to all copies of the Licensed Software (including modified versions) and derivative works.</p> <p>All use of the Licensed Software must immediately cease if use breaches the terms of this license.</p>"},{"location":"license/#3-derivative-works","title":"3. Derivative Works","text":"<p>If a derivative work is created which is based on or otherwise incorporates all or any part of the Licensed Software, and the derivative work is made available to any other person, the complete corresponding machine readable source code (including all changes made to the Licensed Software) must accompany the derivative work and be made publicly available online.</p>"},{"location":"license/#4-copyright-notice","title":"4. Copyright Notice","text":"<p>The following copyright notice shall be included in all copies of the Licensed Software:</p> <p>\u2003\u2003\u2003Copyright \u00a9 2022 AmidaWare LLC.</p> <p>\u2003\u2003\u2003Licensed under the Tactical RMM License Version 1.0 (the \u201cLicense\u201d). \u2003\u2003\u2003You may only use the Licensed Software in accordance with the License. \u2003\u2003\u2003A copy of the License is available at: https://license.tacticalrmm.com</p>"},{"location":"license/#5-disclaimer-of-warranty","title":"5. Disclaimer of Warranty","text":"<p>THE LICENSED SOFTWARE IS PROVIDED \"AS IS\".  TO THE FULLEST EXTENT PERMISSIBLE AT LAW ALL CONDITIONS, WARRANTIES OR OTHER TERMS OF ANY KIND WHICH MIGHT HAVE EFFECT OR BE IMPLIED OR INCORPORATED, WHETHER BY STATUTE, COMMON LAW OR OTHERWISE ARE HEREBY EXCLUDED, INCLUDING THE CONDITIONS, WARRANTIES OR OTHER TERMS AS TO SATISFACTORY QUALITY AND/OR MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, THE USE OF REASONABLE SKILL AND CARE AND NON-INFRINGEMENT.</p>"},{"location":"license/#6-limits-of-liability","title":"6. Limits of Liability","text":"<p>THE FOLLOWING EXCLUSIONS SHALL APPLY TO THE FULLEST EXTENT PERMISSIBLE AT LAW.  NEITHER THE AUTHORS NOR THE COPYRIGHT HOLDERS SHALL IN ANY CIRCUMSTANCES HAVE ANY LIABILITY FOR ANY CLAIM, LOSSES, DAMAGES OR OTHER LIABILITY, WHETHER THE SAME ARE SUFFERED DIRECTLY OR INDIRECTLY OR ARE IMMEDIATE OR CONSEQUENTIAL, AND WHETHER THE SAME ARISE IN CONTRACT, TORT OR DELICT (INCLUDING NEGLIGENCE) OR OTHERWISE HOWSOEVER ARISING FROM, OUT OF OR IN CONNECTION WITH THE LICENSED SOFTWARE OR THE USE OR INABILITY TO USE THE LICENSED SOFTWARE OR OTHER DEALINGS IN THE LICENSED SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH LOSS OR DAMAGE.  THE FOREGOING EXCLUSIONS SHALL INCLUDE, WITHOUT LIMITATION, LIABILITY FOR ANY LOSSES OR DAMAGES WHICH FALL WITHIN ANY OF THE FOLLOWING CATEGORIES: SPECIAL, EXEMPLARY, OR INCIDENTAL LOSS OR DAMAGE, LOSS OF PROFITS, LOSS OF ANTICIPATED SAVINGS, LOSS OF BUSINESS OPPORTUNITY, LOSS OF GOODWILL, AND LOSS OR CORRUPTION OF DATA.</p>"},{"location":"license/#7-termination","title":"7. Termination","text":"<p>This license shall terminate with immediate effect if there is a material breach of any of its terms.</p>"},{"location":"license/#8-no-partnership-agency-or-joint-venture","title":"8. No partnership, agency or joint venture","text":"<p>Nothing in this license agreement is intended to, or shall be deemed to, establish any partnership or joint venture or any relationship of agency between AmidaWare LLC and any other person.</p>"},{"location":"license/#9-no-endorsement","title":"9. No endorsement","text":"<p>The names of the authors and/or the copyright holders must not be used to promote or endorse any products or services which are in any way derived from the Licensed Software without prior written consent.</p>"},{"location":"license/#10-trademarks","title":"10. Trademarks","text":"<p>No permission is granted to use the trademark \u201cTactical RMM\u201d or any other trade name, trademark, service mark or product name of AmidaWare LLC except to the extent necessary to comply with the notice requirements in Section 4 (Copyright Notice).</p>"},{"location":"license/#11-entire-agreement","title":"11. Entire agreement","text":"<p>This license contains the whole agreement relating to its subject matter.</p>"},{"location":"license/#12-severance","title":"12. Severance","text":"<p>If any provision or part-provision of this license is or becomes invalid, illegal or unenforceable, it shall be deemed deleted, but that shall not affect the validity and enforceability of the rest of this license.</p>"},{"location":"license/#13-acceptance-of-these-terms","title":"13. Acceptance of these terms","text":"<p>The terms and conditions of this license are accepted by copying, downloading, installing, redistributing, or otherwise using the Licensed Software.</p>"},{"location":"management_cmds/","title":"Management Commands","text":"<p>To run any of the management commands first login to your server as the user used to install TRMM (eg <code>su - tactical</code>) and activate the python virtual env:</p> Activate python virtual env  standard docker Dev Docker <pre><code>cd /rmm/api/tacticalrmm\nsource ../env/bin/activate\n</code></pre> <pre><code>docker exec -it trmm-backend /bin/bash\n/opt/venv/bin/python /opt/tactical/api/manage.py shell\n</code></pre> <pre><code>docker exec -it trmm-api-dev env/bin/python manage.py shell\n</code></pre>"},{"location":"management_cmds/#bulk-delete-agents-last-check-in-agent-version-site-or-client","title":"Bulk Delete Agents (Last Check-In, Agent Version, Site, or Client)","text":"<p>If you want to remove old agents based on time, age, or location or for client offboarding - it\u2019s a best practice to first test the removal.</p> <pre><code>python manage.py bulk_delete_agents --days 60\npython manage.py bulk_delete_agents --agentver 1.5.0\npython manage.py bulk_delete_agents --site examplesite\npython manage.py bulk_delete_agents --client exampleclient\npython manage.py bulk_delete_agents --hostname examplehostname\n</code></pre> <p>Then run the deletion:</p> <pre><code>python manage.py bulk_delete_agents --days 60 --delete\npython manage.py bulk_delete_agents --agentver 1.5.0 --delete\npython manage.py bulk_delete_agents --site examplesite --delete\npython manage.py bulk_delete_agents --client exampleclient --delete\npython manage.py bulk_delete_agents --hostname examplehostname --delete\n</code></pre> <p>Note</p> <p>You must specify at least one of --days, --agentver, --site, --client, or --hostname.</p> <p>You can combine multiple parameters (e.g., --site examplesite --days 90) to narrow down agents further.</p> <p>Without the --delete flag, the command will only list agents that match.</p> <p>With the --delete flag, the agents will be uninstalled and deleted.</p> <p>Example Bash one-liner to delete multiple agents at once by hostname, <code>hosts.txt</code> file should contain one hostname per line.</p> <pre><code>for i in $(cat hosts.txt); do python manage.py bulk_delete_agents --hostname $i --delete; done\n</code></pre>"},{"location":"management_cmds/#reset-a-users-password","title":"Reset a Users Password","text":"<pre><code>python manage.py reset_password &lt;username&gt;\n</code></pre>"},{"location":"management_cmds/#reset-a-users-2fa-token","title":"Reset a User's 2FA Token","text":"<pre><code>python manage.py reset_2fa &lt;username&gt;\n</code></pre>"},{"location":"management_cmds/#delete-a-user","title":"Delete a User","text":"<pre><code>python manage.py shell\nfrom accounts.models import User\nUser.objects.get(username=\"changeme\").delete()\n</code></pre>"},{"location":"management_cmds/#find-all-agents-that-have-x-software-installed","title":"Find All Agents That Have X Software Installed","text":"<pre><code>python manage.py find_software \"adobe\"\n</code></pre>"},{"location":"management_cmds/#find-all-agents-that-have-x-windows-service-and-show-the-service-status","title":"Find All Agents That Have X Windows Service and Show the Service Status","text":"<pre><code>python manage.py find_services \"quickbooks\"\n</code></pre>"},{"location":"management_cmds/#set-a-specific-windows-update-to-not-install","title":"Set a Specific Windows Update to not Install","text":"<pre><code>python manage.py shell\nfrom winupdate.models import WinUpdate\nWinUpdate.objects.filter(kb=\"KB5007186\").update(action=\"ignore\", date_installed=None)\n</code></pre>"},{"location":"management_cmds/#show-outdated-online-agents","title":"Show Outdated Online Agents","text":"<pre><code>python manage.py show_outdated_agents\n</code></pre>"},{"location":"management_cmds/#log-out-all-active-web-sessions","title":"Log Out All Active Web Sessions","text":"<pre><code>python manage.py delete_tokens\n</code></pre>"},{"location":"management_cmds/#reset-all-auth-tokens-for-install-agents-and-web-sessions","title":"Reset All Auth Tokens for Install Agents and Web Sessions","text":"<pre><code>python manage.py shell\nfrom knox.models import AuthToken\nAuthToken.objects.all().delete()\n</code></pre>"},{"location":"management_cmds/#check-for-orphaned-tasks-on-all-agents-and-remove-them","title":"Check for Orphaned Tasks on All Agents and Remove Them","text":"<pre><code>python manage.py remove_orphaned_tasks\n</code></pre>"},{"location":"management_cmds/#get-a-url-to-login-to-mesh-as-the-mesh-superuser","title":"Get a url to login to mesh as the mesh superuser","text":"<pre><code>python manage.py get_mesh_login_url\n</code></pre>"},{"location":"management_cmds/#create-a-meshcentral-agent-invite-link","title":"Create a MeshCentral Agent Invite Link","text":"<pre><code>python manage.py get_mesh_exe_url\n</code></pre>"},{"location":"management_cmds/#bulk-update-agent-offline-overdue-time","title":"Bulk Update Agent Offline / Overdue Time","text":"<p>Change offline time on all agents to 5 minutes:</p> <pre><code>python manage.py bulk_change_checkin --offline --all 5\n</code></pre> <p>Change offline time on all agents in site named Example Site to 2 minutes:</p> <pre><code>python manage.py bulk_change_checkin --offline --site \"Example Site\" 2\n</code></pre> <p>Change offline time on all agents in client named Example Client to 12 minutes:</p> <pre><code>python manage.py bulk_change_checkin --offline --client \"Example Client\" 12\n</code></pre> <p>Change overdue time on all agents to 10 minutes:</p> <pre><code>python manage.py bulk_change_checkin --overdue --all 10\n</code></pre> <p>Change overdue time on all agents in site named Example Site to 4 minutes:</p> <pre><code>python manage.py bulk_change_checkin --overdue --site \"Example Site\" 4\n</code></pre> <p>Change overdue time on all agents in client named Example Client to 14 minutes:</p> <pre><code>python manage.py bulk_change_checkin --overdue --client \"Example Client\" 14\n</code></pre> <p>Tip</p> <p>You can cron it on the server to run every 30mins with something like <pre><code>*/30 * * * * /rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py bulk_change_checkin --overdue --all 10 &gt; /dev/null 2&gt;&amp;1\n</code></pre></p>"},{"location":"management_cmds/#script-based-functions","title":"Script based functions","text":"<p>Delete agents by client and site name by API</p>"},{"location":"mesh_integration/","title":"MeshCentral Integration","text":""},{"location":"mesh_integration/#overview","title":"Overview","text":"<p>Tactical RMM integrates with MeshCentral for the following 3 functions:</p> <ul> <li>Take Control.</li> <li>Real time shell.</li> <li>Real time file browser.</li> </ul> <p>Note</p> <p>MeshCentral has issues with Firefox, use a Chromium-based browser.</p> <p>It should be noted that Tactical RMM and MeshCentral are 2 completely separate products and can run independently of each other.</p> <p>They do not even have to run on the same box, however when you install Tactical RMM it simply installs MeshCentral for you with some pre-configured settings to allow integration.</p> <p>It is highly recommended to use the MeshCentral instance that Tactical installs, since it allows the developers more control over it and to ensure things don't break.</p>"},{"location":"mesh_integration/#how-does-it-work","title":"How does it work?","text":"<p>Please watch this video to fully understand how mesh integrations and permissions sync work.</p> <p>MeshCentral has an embedding feature that allows integration into existing products.</p> <p>See Section 14 - Embedding MeshCentral in the MeshCentral User Guide for a detailed explanation of how this works.</p> <p>The Tactical RMM agent keeps track of your Mesh agents, and periodically interacts with them to synchronize the Mesh agent's unique ID with the Tactical RMM database.</p> <p>When you do a take control / terminal / file browser on an agent using the Tactical UI, behind the scenes, Tactical generates a login token for MeshCentral's website and then \"wraps\" MeshCentral's UI in an iframe for that specific agent only, using it's unique ID to know what agent to render in the iframe.</p>"},{"location":"mesh_integration/#customize-take-control-username","title":"Customize Take Control Username","text":"<p>If you've enabled any of the remote control options such as \"Notify user\", \"Prompt for consent\" and \"Show connection toolbar\" and you'd like to change the name that users see, make sure the user has a First and/or Last name set TRMM (Settings &gt; User Administration). If you would also like your company name to show, you can set your company name in TRMM &gt; Settings &gt; Global Settings &gt; MeshCentral.</p>"},{"location":"mesh_integration/#turn-off-the-sync-feature","title":"Turn off the sync feature","text":"<p>If you're having issues with the new MeshCentral sync feature added in TRMM v0.18.0 you can simply disable it to revert back to the previous behavior prior to this release, although you're probably just looking for way to get the old mesh interface back:</p> <p>From TRMM's web interface go to Settings &gt; Global Settings &gt; MeshCentral</p> <ol> <li> <p>Un-check the \"Sync Mesh Perms with TRMM\" checkbox, and click Yes to the \"are you sure\" prompt.</p> </li> <li> <p>Click \"Save\"</p> </li> </ol> <p></p>"},{"location":"mesh_integration/#toggle-a-full-permissions-re-sync","title":"Toggle a full permissions re-sync","text":"<p>From TRMM's web interface go to Settings &gt; Global Settings &gt; MeshCentral</p> <ol> <li> <p>Un-check the \"Sync Mesh Perms with TRMM\" checkbox, and click Yes to the \"are you sure\" prompt.</p> </li> <li> <p>Click \"Save\"</p> </li> <li> <p>Re-open the same settings window and check the same checkbox, click yes to the prompt, and Save.</p> </li> <li> <p>Wait a few minutes for the sync to fully complete in the background.</p> </li> </ol> <p>Video</p> <p></p>"},{"location":"mesh_integration/#get-a-url-to-login-to-mesh-as-the-mesh-superuser","title":"Get a url to login to mesh as the mesh superuser","text":"<p>This will generate a url that will log you into meshcentral as the superuser, the same way it used to be prior to TRMM Release 0.18.0</p> <p>You should open this in a different browser than the one you're using for TRMM, or open in an incognito window.</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py get_mesh_login_url\n</code></pre>"},{"location":"mesh_integration/#modifying-the-internal-mesh-port-configuration","title":"Modifying the Internal Mesh Port Configuration","text":"<p>By default, Tactical RMM configures the Mesh service to listen on the internal port 4430. Should there be a need to modify this default port within the Nginx or Mesh configuration, it is imperative to update Tactical RMM with the new port information. To accomplish this, the following entry must be added to the file <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code>:</p> <pre><code>MESH_PORT = &lt;new_port_number&gt;\n</code></pre> <p>Replace <code>&lt;new_port_number&gt;</code> with the actual port number you have configured. For example, if the new port number is 1234, the entry should be as follows:</p> <pre><code>MESH_PORT = 1234\n</code></pre> <p>Then, restart your entire server for changes to take effect.</p>"},{"location":"mesh_integration/#running-your-own-existing-or-separate-meshcentral-server","title":"Running your own existing or separate MeshCentral server?","text":"<p>We do testing to make sure everything works with the version found here (look for MESH_VER).</p> <p>Installation instructions for using your own MeshCentral server:</p> <ol> <li>Run standard installation.</li> <li>After installation is complete, disable meshcentral <code>sudo systemctl disable --now meshcentral</code>.</li> <li>In TRMM Web UI go to Settings &gt; Global Settings &gt; MeshCentral and update values from your existing mesh (make sure to use a mesh superuser). Username MUST be all lowercase. Mesh Token find with this</li> <li>Add <code>USE_EXTERNAL_MESH = True</code> to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></li> <li>Restart TRMM server.</li> </ol> <p>Info</p> <p>Mesh usernames are CaSe sEnSiTive</p>"},{"location":"mesh_integration/#take-control-connect-vs-rdp-connect","title":"Take Control Connect vs RDP Connect","text":"<p>When using <code>Take Control</code> from Tactical RMM you are using the Desktop function in MeshCentral</p> <p><code>Connect</code> button: </p> <p>Right-click the button for options.</p> <p>About the same a VNC, but it's not compatible with VNC. The original VNC protocol did not use JPEG, instead it uses RLE encoding or ZRLE. MeshCentral's remote desktop only uses JPEG (or WEBP in some cases) because browsers can decode JPEG easily.</p> <p>The MeshAgent will split the desktop into 32x32 pixel tiles and see if any of the tiles have changed. If a group of tiles change since the last frame, a JPEG is sent to update the area.</p> <p><code>RDP Connect</code> button: </p> <p>Is a browser based RDP client. It connects to the native RDP in versions of Windows that support inbound RDP connects. Pro, Workstation, Enterprise, Server, Terminal Server, RDS Server etc. You must enable RDP in Windows to be able to connect to it, it's not enabled by default (or enable when installing agent if supported).</p> <p>Note</p> <p>It does not work for Windows Home because Home doesn't support incoming RDP connections.</p>"},{"location":"mesh_integration/#remote-terminal-how-it-works","title":"Remote Terminal how it works","text":"<p>For the remote terminal, we launch a shell on the remote system and pipe VT100 terminal emulation to/from the browser. On the browser, we use XTermJS to view the terminal session.</p>"},{"location":"mesh_integration/#meshcentral-options","title":"MeshCentral Options","text":"<p>There are MANY MeshCentral options that you can configure. Here are some you might want to investigate:</p> <p><code>allowHighQualityDesktop</code></p> <p><code>desktopMultiplex</code></p> <p><code>userAllowedIP</code></p> <p><code>agentAllowedIP</code></p> <p><code>tlsOffload</code> (for proxy users)</p> <p><code>maxInvalid2fa</code></p>"},{"location":"mesh_integration/#using-tactical-rmm-without-meshcentral","title":"Using Tactical RMM Without MeshCentral","text":"<p>Install Tactical RMM normally. Then, to disable the MeshCentral Server on the TRMM server run:</p> <pre><code>sudo systemctl disable --now meshcentral mongod\n</code></pre> <p>Then when installing an agent, make sure to pass the <code>-nomesh</code> flag to the installer</p>"},{"location":"mesh_integration/#fixing-missing-agents-in-trmm-or-mesh","title":"Fixing missing agents in TRMM or Mesh","text":"Fixing Missing agent  Agent Missing in Mesh Agent Missing in TRMM <p>From the Script Library run: <code>TacticalRMM - Install Mesh Agent if it's not installed</code></p> <p>Then from trmm web ui right click agent &gt; agent recovery &gt; mesh agent</p> <p>Use mesh to run the trmm agent installer with the <code>--nomesh</code> flag.</p> <p>Then from trmm web ui right click agent &gt; agent recovery &gt; mesh agent</p>"},{"location":"mesh_integration/#omg-meshcentral-isnt-maintained-anymore","title":"OMG MeshCentral isn't maintained anymore!","text":"<p>MeshCentral is still actively being maintained, the lead devs had jobs in which they were paid by a corporation to develop MeshCentral, they now have got other jobs which means they are supporting and developing MeshCentral in their free time (like alot of other projects) this means development is slower but not that it isn't maintained anymore. If this changes or it becomes necessary to fix something that breaks or packages needing updated we are prepared to begin maintaining our own fork. The features of MeshCentral that TRMM uses are only the 3 items above and are extremely mature.</p>"},{"location":"restore/","title":"Restore","text":"<p>Warning</p> <p>This script will only run on a freshly installed \u201cempty\u201d server with no TRMM installed or TRMM failed install. Plan accordingly (aka snapshot back to pre-<code>restore.sh</code> run or re-setup a new fresh VPS).</p> <p>Info</p> <p>The restore script will only restore to a different physical or virtual server. It cannot be used to restore to a different domain/subdomain. If you would like to restore to a different domain/subdomain, commercial support offers a paid domain name migration service.</p> <p>If the purpose of your restore is to migrate your instance from one machine to another e.g. to upgrade your install to a newer OS and/or different arch, then it is recommended to leave both the old and new instances up and running until all your agents have successfully migrated to the new instance. You can use the old instance to forcefully migrate stubborn agents that are still attached to it (see instructions below).</p>"},{"location":"restore/#setup-the-new-server","title":"Setup the new server","text":"<p>Follow the same instructions as a fresh install but stop when you reach the 'Run the install script' section (you'll be using the restore script instead of install).</p> <p>Tip</p> <p>Take a snapshot of your vm if possible so you can get back to this point if something doesn't work right and you have to try the restore again.</p>"},{"location":"restore/#change-dns-a-records","title":"Change DNS A records","text":"<p>Open the DNS manager of wherever your domain is hosted.</p> <p>Update the 3 A records <code>rmm</code>, <code>api</code> and <code>mesh</code> and point them to the public IP of your new server.</p>"},{"location":"restore/#run-the-restore-script","title":"Run the restore script","text":"<p>Switch to the <code>tactical</code> user (if you used a custom username, it must match the install you're coming from):</p> <pre><code>su - tactical\n</code></pre> <p>Copy the backup tarball you created during backup to the new server (eg in your <code>tactical</code> users home folder).</p> <p>Download the restore script:</p> <pre><code>wget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/master/restore.sh\nchmod +x restore.sh\n</code></pre> <p>Call the restore script, passing it the backup tarball as the first argument:</p> <pre><code>./restore.sh rmm-backup-XXXXXXXXX.tar\n</code></pre> <p>Note: the section below is only applicable if you are migrating to a new instance while still keeping the old instance. If you used the same VM to restore then you are done.</p> <p>Once the restore has completed, log into your OLD instance and from the Web UI do Tools &gt; Recover All Agents.</p> <p>Info</p> <p>You will most probably have to add entries to your host file (on the machine you're trying to access the web UI from) for your subdomains to access the old instance, since you'll already have updated DNS to point to the new server.</p> <p>What this will do is restart both the tacticalagent and meshagent services on any stubborn agents that are still connected to the old instance, which should be enough to get them connected to the new instance.</p>"},{"location":"restore/#restore-testing","title":"Restore Testing","text":"<p>If you want to validate your backups the best way to do that is to:</p> <ol> <li>Run the standard Restore to a new temp VM as above.</li> <li>Run <code>sudo systemctl stop celery celerybeat</code> to stop the restored test VM from sending agent offline false alerts.</li> <li>Change the hosts file on your computer so that only your computer overrides regular DNS and allows you to login and test your test restore. Add the server ip and names in one line like this <code>192.168.55.5 rmm.example.com api.example.com mesh.example.com</code>.</li> <li>Login and test things, see agents, policies, agent history etc.</li> <li>Undo hosts file entry and delete test VM</li> </ol>"},{"location":"roadmap/","title":"Roadmap","text":"<p>This roadmap provides a directional view of upcoming work. It is not exhaustive, and scope, sequencing, and timing may change. We also ship fixes and enhancements continuously in parallel with the items listed below.</p> Next Release <ul> <li>White Labeling - Comprehensive white labeling solution allowing full customization of branding and UI elements.</li> </ul> Future Releases <ul> <li>Windows Update Rework - Complete overhaul of the Windows Update management system for better reliability and performance.</li> <li>Tagging/Groups </li> <li>Bulk Edit Agents</li> <li>customizable columns in the agent list</li> <li>Internationalization support</li> </ul>"},{"location":"script_variables/","title":"Script Variables","text":"<p>Tactical RMM allows passing dashboard data into script as arguments or environment variables. This uses the syntax <code>{{model.field}}</code>. </p> <p>Info</p> <p>Nested relations are followed so something like <code>{{agent.site.name}}</code> will work.</p> <p>For a full list of available fields, refer to the variables in the <code>models.py</code> files:</p> <p>Info</p> <p>@property functions under the model will work as well</p> <p>Agent</p> <p>Client</p> <p>Site</p> <p>Alert</p> <p>Check</p> <p>CheckResult</p> <p>AutomatedTask</p> <p>TaskResult</p> <p>Below are some examples of available fields:</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p>"},{"location":"script_variables/#agent","title":"Agent","text":"<ul> <li>{{agent.version}} - Tactical RMM agent version.</li> <li>{{agent.operating_system}} - Agent operating system example: Windows 10 Pro, 64 bit (build 19042.928).</li> <li>{{agent.plat}} - Will show the platform example: windows.</li> <li>{{agent.hostname}} - The hostname of the agent.</li> <li>{{agent.local_ips}} - Local IP address of agent.</li> <li>{{agent.public_ip}} - Public IP address of agent.</li> <li>{{agent.agent_id}} - agent ID in database.</li> <li>{{agent.last_seen}} - Date and Time Agent last seen.</li> <li>{{agent.total_ram}} - Total RAM on agent. Returns an integer - example: 16.</li> <li>{{agent.boot_time}} - Uptime of agent. Returns unix timestamp. example: 1619439603.0.</li> <li>{{agent.logged_in_username}} - Username of logged in user.</li> <li>{{agent.last_logged_in_user}} - Username of last logged in user.</li> <li>{{agent.monitoring_type}} - Returns a string of workstation or server.</li> <li>{{agent.description}} - Description of agent in dashboard.</li> <li>{{agent.mesh_node_id}} - The mesh node id used for linking the tactical agent to mesh.</li> <li>{{agent.overdue_email_alert}} - Returns true if overdue email alerts is enabled in TRMM.</li> <li>{{agent.overdue_text_alert}} - Returns true if overdue SMS alerts is enabled in TRMM.</li> <li>{{agent.overdue_dashboard_alert}} - Returns true if overdue agent alerts is enabled in TRMM.</li> <li>{{agent.offline_time}} - Returns offline time setting for agent in TRMM.</li> <li>{{agent.overdue_time}} - Returns overdue time setting for agent in TRMM.</li> <li>{{agent.check_interval}} - Returns check interval time setting for agent in TRMM.</li> <li>{{agent.needs_reboot}} - Returns true if reboot is pending on agent.</li> <li>{{agent.choco_installed}} - Returns true if Chocolatey is installed.</li> <li>{{agent.patches_last_installed}} - The date that patches were last installed by Tactical RMM.</li> <li>{{agent.timezone}} - Returns timezone configured on agent.</li> <li>{{agent.maintenance_mode}} - Returns true if agent is in maintenance mode.</li> <li>{{agent.block_policy_inheritance}} - Returns true if agent has block policy inheritance.</li> <li>{{agent.alert_template}} - Returns true if agent has block policy inheritance.</li> <li>{{agent.site}} - The site that the agent belongs too. Can be used for nesting. See Site above for properties</li> </ul>"},{"location":"script_variables/#client","title":"Client","text":"<ul> <li>{{client.name}} - Returns name of client.</li> </ul>"},{"location":"script_variables/#site","title":"Site","text":"<ul> <li>{{site.name}} - Returns name of Site.</li> <li>{{site.client}} - The client that the site belongs too. Can be used for nesting. See Client above for properties</li> </ul>"},{"location":"script_variables/#alert","title":"Alert","text":"<p>Info</p> <p>Only available in failure and resolve actions on alert templates!</p> <ul> <li>{{alert.alert_time}} - Time of the alert.</li> <li>{{alert.message}} - Alert message.</li> <li>{{alert.severity}} - Severity of the alert info, warning, or error.</li> <li>{{alert.alert_type}} - The type of alert. Will be availability, check, task, or custom.</li> <li>{{alert.snoozed}} - Returns true if the alert is snoozed.</li> <li>{{alert.snoozed_until}} - Returns the datetime that the alert is unsnoozed.</li> <li>{{alert.email_sent}} - Returns true if this alert has triggered a failure email.</li> <li>{{alert.resolved_email_sent}} - Returns true if this alert has triggered a resolved email.</li> <li>{{alert.sms_sent}} - Returns true if this alert has triggered a failure text.</li> <li>{{alert.resolved_sms_sent}} - Returns true if this alert has triggered a resolved text.</li> <li>{{alert.hidden}} - Returns true if this alert is hidden. It won't show in the alerts icon in the dashboard</li> <li>{{alert.action_run}} - Returns datetime that an alert failure action was run.</li> <li>{{alert.action_stdout}} - Returns standard output of the alert failure action results.</li> <li>{{alert.action_stderr}} - Returns error output of the alert failure action results.</li> <li>{{alert.action_retcode}} - Returns return code of the alert failure action.</li> <li>{{alert.resolved_action_run}} - Returns datetime that an alert resolved action was run.</li> <li>{{alert.resolved_action_stdout}} - Returns standard output of the alert resolved action results.</li> <li>{{alert.resolved_action_stderr}} - Returns error output of the alert resolved action results.</li> <li> <p>{{alert.resolved_action_retcode}} - Returns return code of the alert resolved action.</p> </li> <li> <p>{{alert.agent}} - The agent that triggered the alert. Can be used for nesting. See Agent above for properties.</p> </li> <li>{{alert.assigned_check}} - The check that triggered the alert. Can be used for nesting. See Check above for properties.</li> <li>{{alert.assigned_check.readable_desc}} - This will return the name that is used in the UI for the check. </li> <li>{{alert.assigned_task}} - The automated task that triggered the alert. Can be used for nesting. See Automated Task above for properties.</li> <li>{{alert.assigned_task.name}} - This will return the name that is used in the UI for the automated task. </li> <li>{{alert.site}} - The site associated with the agent that triggered the alert. Can be used for nesting. See Site above for properties.</li> <li> <p>{{alert.client}} - The client associated with the agent that triggered the alert. Can be used for nesting. See Client above for properties.</p> </li> <li> <p>{{alert.get_result}} - Will return the results of the associated check or automated task. Can be used for nesting. See CheckResult or TaskResult above for properties. This will be blank for agent availability alerts. For example to get the standard output of the check that failed, do <code>{{ alert.get_result.stdout }}</code></p> </li> </ul>"},{"location":"script_variables/#custom-fields","title":"Custom Fields","text":"<p>You can use custom fields as variables by referencing the object that contains the custom field and using the exact name of the field as the property. For example, {{agent.Custom field Name}}. This reference is case sensitive, and spaces in the field name are supported.</p> <p>Currently, custom fields are supported only for the following objects: Client, Site, and Agent. If the custom field cannot be found, the text will be passed as-is to the script.</p>"},{"location":"securing_nginx/","title":"DISCLAIMER","text":"<p>All the settings covered in this document have been tested against Tactical RMM v0.7.2 and v0.8.0.</p> <p>Before applying these settings in production, use a pre-production environment so potential disruptions in your own environment and the service that you provide to your clients can be avoided.</p> <p>Warning</p> <p>Use the contents included in this guide and apply the security settings detailed here at your own discretion.</p> <p>Info</p> <p>Please check the following github issue for potential side effects of deploying these configs.</p>"},{"location":"securing_nginx/#intro","title":"Intro","text":"<p>This section is structured in three main subsections:</p> <ul> <li>Enabling GeoIP in NGINX config with the purpose of filtering (blocking) web requests based on the country\u2019s source IP.</li> <li>Enabling anti \u201cbad\u201d bots/referrers in HTTP requests to the NGINX server.</li> <li>Compiling and enabling ModSec + OWASP CRS in NGINX server.</li> </ul> <p>Each section can be enabled independently.</p>"},{"location":"securing_nginx/#hardening-nginx-settings","title":"Hardening NGINX settings","text":""},{"location":"securing_nginx/#geoip-integration-in-nginx-blocking-requests-by-country-code","title":"GeoIP Integration in NGINX - Blocking Requests by Country Code","text":"<p>Install required packages and NGINX module for GeoIP:</p> <pre><code># apt-get install geoip-database libgeoip1 libnginx-mod-http-geoip\n</code></pre> <p>Verify that the GeoIP database files have been placed in the right location:</p> <pre><code># ls -lrt /usr/share/GeoIP/\ntotal 10004\n-rw-r--r-- 1 root root 8138841 Jan 24  2020 GeoIPv6.dat\n-rw-r--r-- 1 root root 2099217 Jan 24  2020 GeoIP.dat\n</code></pre> <p>Edit NGINX config file (<code>/etc/nginx/nginx.conf</code>) and add the following config under the <code>http {</code> block:</p> <pre><code>http {\n\n    ##\n    # Basic Settings\n    ##\n    # Load GeoIP Database\n    geoip_country /usr/share/GeoIP/GeoIP.dat;\n}\n</code></pre> <p>The next settings will depend on the desired GeoIP blocking strategy. For \u201callow by default, deny by exception\u201d, the config would be:</p> <pre><code>http {\n\n        ##\n        # Basic Settings\n        ##\n        # Load GeoIP Database\n        geoip_country /usr/share/GeoIP/GeoIP.dat;\n        # map the list of denied countries\n        map $geoip_country_code $allowed_country {\n        default yes;\n        # BLOCKED_COUNTRY_1\n        COUNTRY_CODE_1 no;\n        # BLOCKED_COUNTRY_2\n        COUNTRY_CODE_2 no;\n        # BLOCKED_COUNTRY_3\n        COUNTRY_CODE_3 no;\n        }\n}\n</code></pre> <p>(The macro can be modified to achieve the \u201cdeny by default, allow by exception\u201d approach).</p> <p>Finally, the following \u201cif\u201d statement needs to be placed in all the vhosts where the GeoIP blocking should take effect, under the \u201clocation\u201d section:</p> <pre><code>   location / {\n        root /var/www/rmm/dist;\n        try_files $uri $uri/ /index.html;\n        add_header Cache-Control \"no-store, no-cache, must-revalidate\";\n        add_header Pragma \"no-cache\";\n        # block the country\n        if ($allowed_country = no) {\n         return 444;\n        }\n    }\n</code></pre> <p>The HTTP Status = 444 is a good choice for NGINX not \u201cwasting\u201d too many resources in sending back the 4xx code to the client being blocked by GeoIP.</p>"},{"location":"securing_nginx/#blocking-bad-bots-and-bad-referrers","title":"Blocking \u201cbad bots\u201d and \u201cbad referrers\u201d","text":"<p>Nginx Bad Bot and User-Agent Blocker, Spam Referrer Blocker, Anti DDOS, Bad IP Blocker and Wordpress Theme Detector Blocker:</p> <p>Source:</p> <p>https://github.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker</p> <p>Download \u201cinstall-ngxblocker\u201d to your /usr/local/sbin/directory and make the script executable:</p> <pre><code>sudo wget https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/install-ngxblocker -O /usr/local/sbin/install-ngxblocker\nsudo chmod +x /usr/local/sbin/install-ngxblocker\n</code></pre> <p>(OPTIONAL)Now run the \u201dinstall-ngxblocker\u201d script in DRY-MODE which will show you what changes it will make and what files it will download for you. This is only a DRY-RUN so no changes are being made yet.</p> <p>The install-ngxblocker downloads all required files including the setup and update scripts:</p> <pre><code>cd /usr/local/sbin\nsudo ./install-ngxblocker\n</code></pre> <p>This will show you output as follows of the changes that will be made (NOTE: this is only a DRY-RUN no changes have been made)</p> <pre><code>Checking url: https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/include_filelist.txt\n** Dry Run ** | not updating files | run  as 'install-ngxblocker -x' to install files.\nCreating directory: /etc/nginx/bots.d\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/conf.d/globalblacklist.conf            [TO]=&gt;  /etc/nginx/conf.d/globalblacklist.conf\nDownloading [FROM]=&gt;  [REPO]/conf.d/botblocker-nginx-settings.conf  [TO]=&gt;  /etc/nginx/conf.d/botblocker-nginx-settings.conf\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/bots.d/blockbots.conf              [TO]=&gt;  /etc/nginx/bots.d/blockbots.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/ddos.conf                   [TO]=&gt;  /etc/nginx/bots.d/ddos.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/whitelist-ips.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-domains.conf      [TO]=&gt;  /etc/nginx/bots.d/whitelist-domains.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-user-agents.conf  [TO]=&gt;  /etc/nginx/bots.d/blacklist-user-agents.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/blacklist-ips.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/bad-referrer-words.conf     [TO]=&gt;  /etc/nginx/bots.d/bad-referrer-words.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/custom-bad-referrers.conf   [TO]=&gt;  /etc/nginx/bots.d/custom-bad-referrers.conf\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/setup-ngxblocker      [TO]=&gt;  /usr/local/sbin/setup-ngxblocker\nDownloading [FROM]=&gt;  [REPO]/update-ngxblocker     [TO]=&gt;  /usr/local/sbin/update-ngxblocker\n</code></pre> <p>Now run the install script with the -x parameter to download all the necessary files from the repository:</p> <pre><code>cd /usr/local/sbin/\nsudo ./install-ngxblocker -x\n</code></pre> <p>This will give you the following output:</p> <pre><code>Checking url: https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/include_filelist.txt\nCreating directory: /etc/nginx/bots.d\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/conf.d/globalblacklist.conf            [TO]=&gt;  /etc/nginx/conf.d/globalblacklist.conf...OK\nDownloading [FROM]=&gt;  [REPO]/conf.d/botblocker-nginx-settings.conf  [TO]=&gt;  /etc/nginx/conf.d/botblocker-nginx-settings.conf...OK\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/bots.d/blockbots.conf              [TO]=&gt;  /etc/nginx/bots.d/blockbots.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/ddos.conf                   [TO]=&gt;  /etc/nginx/bots.d/ddos.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/whitelist-ips.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-domains.conf      [TO]=&gt;  /etc/nginx/bots.d/whitelist-domains.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-user-agents.conf  [TO]=&gt;  /etc/nginx/bots.d/blacklist-user-agents.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/blacklist-ips.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/bad-referrer-words.conf     [TO]=&gt;  /etc/nginx/bots.d/bad-referrer-words.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/custom-bad-referrers.conf   [TO]=&gt;  /etc/nginx/bots.d/custom-bad-referrers.conf...OK\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/setup-ngxblocker      [TO]=&gt;  /usr/local/sbin/setup-ngxblocker...OK\nDownloading [FROM]=&gt;  [REPO]/update-ngxblocker     [TO]=&gt;  /usr/local/sbin/update-ngxblocker...OK\n</code></pre> <p>All the required files have now been downloaded to the correct folders on Nginx for you direct from the repository.</p> <p>NOTE: The setup and update scripts can be used, however in this guide the config is done manually. For script execution, refer to the Github page linked above.</p> <p>Include any public IP addresses that should be whitelisted from bot and referrer analysis/blocking by editing the file \u201c/etc/nginx/bots.d/whitelist-ips.conf\u201d.</p> <p>Finally, edit every vhost file (\u201c/etc/nginx/sites-enabled/frontend.conf\u201d, \u201c/etc/nginx/sites-enabled/rmm.conf\u201d and \u201c/etc/nginx/sites-enabled/meshcentral.conf\u201d) and place the following include statements under the \u201cserver\u201d block:</p> <pre><code>server {\n    listen 443 ssl;\n    include /etc/nginx/bots.d/ddos.conf;\n    include /etc/nginx/bots.d/blockbots.conf;\n}\n</code></pre>"},{"location":"securing_nginx/#enabling-modsec-in-nginx","title":"Enabling ModSec in NGINX","text":"<p>All steps in this section taken from the NGINX blog post \u201cCompiling and Installing ModSecurity for NGINX Open Source\u201d:</p> <p>https://www.nginx.com/blog/compiling-and-installing-modsecurity-for-open-source-nginx/</p>"},{"location":"securing_nginx/#install-prerequisite-packages","title":"Install Prerequisite Packages","text":"<p>The first step is to install the packages required to complete the remaining steps in this tutorial. Run the following command, which is appropriate for a freshly installed Ubuntu/Debian system. The required packages might be different for RHEL/CentOS/Oracle Linux.</p> <pre><code>apt-get install -y apt-utils autoconf automake build-essential git libcurl4-openssl-dev libgeoip-dev liblmdb-dev libpcre++-dev libtool libxml2-dev libyajl-dev pkgconf wget zlib1g-dev\n</code></pre>"},{"location":"securing_nginx/#download-and-compile-the-modsecurity-30-source-code","title":"Download and Compile the ModSecurity 3.0 Source Code","text":"<p>With the required prerequisite packages installed, the next step is to compile ModSecurity as an NGINX dynamic module. In ModSecurity 3.0\u2019s new modular architecture, libmodsecurity is the core component which includes all rules and functionality. The second main component in the architecture is a connector that links libmodsecurity to the web server it is running with. There are separate connectors for NGINX, Apache HTTP Server, and IIS. We cover the NGINX connector in the next section.</p> <p>To compile libmodsecurity:</p> <p>Clone the GitHub repository:</p> <pre><code>git clone --depth 1 -b v3/master --single-branch https://github.com/SpiderLabs/ModSecurity\n</code></pre> <p>Change to the ModSecurity directory and compile the source code:</p> <pre><code>cd ModSecurity\ngit submodule init\ngit submodule update\n./build.sh\n./configure\nmake\nmake install\ncd ..\n</code></pre> <p>The compilation takes about 15 minutes, depending on the processing power of your system.</p> <p>Note: It\u2019s safe to ignore messages like the following during the build process. Even when they appear, the compilation completes and creates a working object.</p> <pre><code>fatal: No names found, cannot describe anything.\n</code></pre>"},{"location":"securing_nginx/#download-the-nginx-connector-for-modsecurity-and-compile-it-as-a-dynamic-module","title":"Download the NGINX Connector for ModSecurity and Compile It as a Dynamic Module","text":"<p>Compile the ModSecurity connector for NGINX as a dynamic module for NGINX.</p> <p>Clone the GitHub repository:</p> <pre><code>git clone --depth 1 https://github.com/SpiderLabs/ModSecurity-nginx.git\n</code></pre> <p>Determine which version of NGINX is running on the host where the ModSecurity module will be loaded:</p> <pre><code>$ nginx -v\nnginx version: nginx/1.18.0 (Ubuntu)\n</code></pre> <p>Download the source code corresponding to the installed version of NGINX (the complete sources are required even though only the dynamic module is being compiled):</p> <pre><code>wget http://nginx.org/download/nginx-1.18.0.tar.gz\ntar zxvf nginx-1.18.0.tar.gz\n</code></pre> <p>Compile the dynamic module and copy it to the standard directory for modules:</p> <pre><code>cd nginx-1.18.0\n./configure --with-compat --add-dynamic-module=../ModSecurity-nginx\nmake modules\ncp objs/ngx_http_modsecurity_module.so /etc/nginx/modules\ncp objs/ngx_http_modsecurity_module.so /usr/share/nginx/modules/\ncd ..\n</code></pre>"},{"location":"securing_nginx/#load-the-nginx-modsecurity-connector-dynamic-module","title":"Load the NGINX ModSecurity Connector Dynamic Module","text":"<p>Add the following load_module directive to the main (top\u2011level) context in /etc/nginx/nginx.conf. It instructs NGINX to load the ModSecurity dynamic module when it processes the configuration:</p> <pre><code>load_module modules/ngx_http_modsecurity_module.so;\n</code></pre>"},{"location":"securing_nginx/#configure-and-enable-modsecurity","title":"Configure and Enable ModSecurity","text":"<p>The final step is to enable and test ModSecurity.</p> <p>Set up the appropriate ModSecurity configuration file. Here we\u2019re using the recommended ModSecurity configuration provided by TrustWave Spiderlabs, the corporate sponsors of ModSecurity.</p> <pre><code>mkdir /etc/nginx/modsec\nwget -P /etc/nginx/modsec/ https://raw.githubusercontent.com/SpiderLabs/ModSecurity/v3/master/modsecurity.conf-recommended\nmv /etc/nginx/modsec/modsecurity.conf-recommended /etc/nginx/modsec/modsecurity.conf\n</code></pre> <p>To guarantee that ModSecurity can find the unicode.mapping file (distributed in the top\u2011level ModSecurity directory of the GitHub repo), copy it to /etc/nginx/modsec.</p> <pre><code>cp ModSecurity/unicode.mapping /etc/nginx/modsec\n</code></pre> <p>Change the SecRuleEngine directive in the configuration to change from the default \u201cdetection only\u201d mode to actively dropping malicious traffic.</p> <pre><code>#SecRuleEngine DetectionOnly\nSecRuleEngine On\n</code></pre>"},{"location":"securing_nginx/#enabling-owasp-core-rule-set","title":"Enabling OWASP Core Rule Set","text":"<p>Clone OWASP CRS:</p> <pre><code>cd /etc/nginx/modsec\ngit clone https://github.com/coreruleset/coreruleset.git\n</code></pre> <p>Create CRS setup config file:</p> <pre><code>cp /etc/nginx/modsec/coreruleset/crs-setup.conf.example /etc/nginx/modsec/coreruleset/crs-setup.conf\n</code></pre> <p>Edit config file and enable a paranoia level of 2 (comment out section below and modify the paranoia level from 1 - default to 2):</p> <pre><code>SecAction \\\n  \"id:900000,\\\n   phase:1,\\\n   nolog,\\\n   pass,\\\n   t:none,\\\n   setvar:tx.paranoia_level=2\"\n</code></pre> <p>A Paranoia level of 2 is a good combination of security rules to load by the ModSec engine while keeping low the number of false positives.</p> <p>The OWASP CRS team carried out some tests using BURP against ModSec + OWASP CRS:</p> <p></p> <p>Create ModSecurity base config file (\u201c/etc/nginx/modsec/modsec-base-cfg.conf\u201d) and include the following lines (the order is important)<code>:</code></p> <pre><code>Include /etc/nginx/modsec/modsecurity.conf\nInclude /etc/nginx/modsec/coreruleset/crs-setup.conf\nInclude /etc/nginx/modsec/coreruleset/rules/*.conf\n</code></pre> <p>Enable ModSec in all NGINX enabled sites:</p> <p>\u201c/etc/nginx/sites-enabled/frontend.conf\u201d, \u201c/etc/nginx/sites-enabled/rmm.conf\u201d and \u201c/etc/nginx/sites-enabled/meshcentral.conf\u201d:</p> <pre><code>server {\n    modsecurity on;\n    modsecurity_rules_file /etc/nginx/modsec/modsec-base-cfg.conf;\n}\n</code></pre> <p>Tactical RMM custom rules:</p> <ul> <li>Access to the admin UI (front-end): We apply the \u201cdeny by default, allow by exception\u201d principle, whereby only a set of predefined public IPs should be allowed to access the UI</li> <li>API and MeshCentral: RMM agents and RMM UI (as referrer while an admin session is active) make web calls that get blocked by the OWASP CRS, specifically PUT, POST and PATCH methods. These three methods can be \u201cwhitelisted\u201d when the requested URI matches legitimate requests.</li> <li>Connection to MeshCentral during Tactical agent install.</li> </ul> <p>Create a .conf file under \u201c/etc/nginx/modsec/coreruleset/rules\u201d named \u201cRMM-RULES.conf\u201d, for example, with the following content:</p> <pre><code>#ADMIN UI/FRONTEND ACCESS - DENY BY DEFAULT, ALLOW BY EXCEPTION\nSecRule SERVER_NAME \"rmm.EXAMPLE.COM\" \"id:1001,phase:1,nolog,msg:'Remote IP Not allowed',deny,chain\"\n###  ALLOWED PUBLIC IP 1 #########\nSecRule REMOTE_ADDR \"!@eq IP1\" chain\n###  ALLOWED PUBLIC IP 2 #########\nSecRule REMOTE_ADDR \"!@eq IP2\" \"t:none\"\n\n#API AND MESHCENTRAL - WHITELIST PUT, PATCH AND POST METHODS BY REQUESTED URI\nSecRule REQUEST_URI \"@beginsWith /api/v3/checkin\" \"id:1002,phase:1,t:none,nolog,allow,chain\"\nSecRule REQUEST_METHOD \"PUT|PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /api/v3/checkrunner\" \"chain,id:'1003',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /alerts/alerts\" \"chain,id:'1004',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /agents/listagents\" \"chain,id:'1005',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /api/v3/sysinfo\" \"chain,id:'1006',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /api/v3/winupdates\" \"chain,id:'1007',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"POST\"\n\n##REQUIRED FOR MANAGEMENT ACTIONS FROM ADMIN/FRONT-END UI. WHITELIST BY REFERRER's URL\nSecRule REQUEST_HEADERS:REFERRER \"https://rmm.EXAMPLE.COM/\" \"id:1008,phase:1,nolog,ctl:ruleRemoveById=920170,allow\"\n\n#REQUIRED FOR NEW CLIENTS TO CONNECT TO MESH SERVICE WHILE INSTALLING THE AGENT\nSecRule REQUEST_URI \"@beginsWith /api/v3/meshexe\" \"id:1009,phase:1,nolog,ctl:ruleRemoveById=920170,allow\"\n\n###  NOTE ON RULE ID = 920170 (WHITELISTED IN CASES ABOVE FOR TACTICAL RMM) ###\n# Do not accept GET or HEAD requests with bodies\n# HTTP standard allows GET requests to have a body but this\n# feature is not used in real life. Attackers could try to force\n# a request body on an unsuspecting web applications.\n#\n# -=[ Rule Logic ]=-\n# This is a chained rule that first checks the Request Method.  If it is a\n# GET or HEAD method, then it checks for the existence of a Content-Length\n# header.  If the header exists and its payload is either not a 0 digit or not\n# empty, then it will match.\n#\n# -=[ References ]=-\n# http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3\n###\n</code></pre>"},{"location":"security/","title":"Security","text":"<p>If you think that you have found a security vulnerability in Tactical RMM, please disclose it to us via our security e-mail address at security@amidaware.com.</p> <p>Please do not make vulnerabilities public without notifying us and giving us at least 3 days to respond.</p> <p>If you are going to write about Tactical RMM's security, please get in touch, so we can make sure that all claims are correct.</p>"},{"location":"sponsor/","title":"Sponsor Tactical RMM","text":"<p>Tactical RMM is a source available project maintained by AmidaWare Inc. and a community of contributors. We work on behalf of the community to create new features, fix bugs, and maintain Tactical RMM.</p> <p>Tactical RMM is currently the only source available RMM available on the market. Responses from a recent survey have rated Tactical RMM as having the fastest and most reliable remote command and script execution compared to all other commercial RMM's. Sponsorships help keep this project alive and motivate the developers to continue to put in more time and effort into the advancement of Tactical RMM. Thousands of hours have been put in to developing, maintaining, improving, and supporting Tactical RMM. Your sponsorship would be greatly appreciated and is necessary to keep this project going.</p> <p>Funds donated are used to fund the legal business necessary for OV code signing and to support development of new features and long term maintenance of the project.</p> <p>We are always looking for feedback and ways to improve Tactical RMM to better address your needs. Please feel free to open a github issue or drop us a message on Discord with your feedback or requests.</p>"},{"location":"sponsor/#sponsor-with-stripe-or-paypal","title":"Sponsor with Stripe or Paypal","text":"<p>Stripe is our preferred payment processor, please use Stripe instead of Paypal if you can.</p> <p>If you need an invoices, please use Stripe as it will automatically generate invoices for you with each payment.</p> <p>After sponsoring, follow the instructions to get your code signing token.</p> <p>Upon completion of your purchase and receipt of your code signing token, your payment becomes non-refundable as the digital service provided is considered fully delivered and consumed. To request a refund or cancel your sponsorship please open a ticket.</p> Monthly (recurring)Annually (recurring) Package Price Description Support Sign up Tier 1 $55/month - Minimum tier required for:  Code signed Windows agents Linux agents macOS agents Single sign-on- Suggested sponsorship for less than 200 agents Community Support  Paypal  Stripe Tier 2 $80/month - Minimum tier required for Reporting(excluding Founders and Non-Profits)- Suggested sponsorship for less than 400 agents Community Support  Paypal  Stripe Tier 3 $105/month - Suggested sponsorship for less than 600 agents Email Support - 72 hour response *  Paypal   Stripe Tier 4 $155/month - Suggested sponsorship for less than 1,000 agents Email Support - 48 hour response *  Paypal  Stripe Tier 5 $310/month - Suggested sponsorship for less than 3,000 agents Email Support - 36 hour response *  Paypal  Stripe Tier 6 $515/month - Suggested sponsorship for less than 5,000 agents Email Support - 24 hour response *  Paypal  Stripe Tier 7 $850/month - Suggested sponsorship for less than 10,000 agents Email Support - 12 hour response *  Paypal  Stripe Package Price Description Support Sign up Tier 1 $600/year - Minimum tier required for:  Code signed Windows agents Linux agents macOS agents Single sign-on- Suggested sponsorship for less than 200 agents Community Support  Stripe Tier 2 $900/year - Minimum tier required for Reporting(excluding Founders and Non-Profits)- Suggested sponsorship for less than 400 agents Community Support  Stripe Tier 3 $1,200/year - Suggested sponsorship for less than 600 agents Email Support - 72 hour response *  Stripe Tier 4 $1,800/year - Suggested sponsorship for less than 1,000 agents Email Support - 48 hour response *  Stripe Tier 5 $3,600/year - Suggested sponsorship for less than 3,000 agents Email Support - 36 hour response *  Stripe Tier 6 $6,000/year - Suggested sponsorship for less than 5,000 agents Email Support - 24 hour response *  Stripe Tier 7 $9,600/year - Suggested sponsorship for less than 10,000 agents Email Support - 12 hour response *  Stripe"},{"location":"sponsor/#support","title":"Support","text":"<p>Support is available during business hours, Monday through Friday, regardless of location. </p> <p>If any of the above plans don\u2019t fit your needs, contact us to discuss a custom support solution.</p>"},{"location":"sponsor/#discord-sponsors-tag","title":"Discord Sponsors tag","text":"<p>If you're a sponsor and would like a yellow name and access to the #sponsors channel and able to ask questions in #sponsors-reporting_requests please open a ticket with billing email address and Discord username (and multiple staff usernames if desired).</p>"},{"location":"support/","title":"Support","text":""},{"location":"support/#community-support","title":"Community Support","text":"<p>Free Support: Available through Discord and Github tickets.</p> <p>We help people get started with Tactical RMM using supported methods as documented here in the public documentation.</p> <p>We may give pointers, or provide additional troubleshooting steps if we believe your issue may be related to a recent update or bug.</p>"},{"location":"support/#commercial-support","title":"Commercial Support","text":"<p>Paid Support: See pricing table for support plans.</p> <p>Fully managed hosted servers are also available.</p>"},{"location":"support/#public-rsa-keys","title":"Public RSA Keys","text":"<p>Steps to provide the developers SSH access to your server for troubleshooting:</p> <ol> <li> <p>SSH into your server as the linux user you used to install tacticalrmm (<code>tactical</code> if you followed the install guide).</p> </li> <li> <p>Add our public key: <pre><code>mkdir -p ~/.ssh\n</code></pre> <pre><code>echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC63U5WPFWLKzagz4SV3DSJaYMqVd4Zq8DU518qzWzQ0vWOhDb1aN/X7AhQMBrQasV7HM9HN0Q3sRqw8ppdco9OzrhYUVV3HhJ7HHELed6g60B1Q8kaSd3Oa9n1+gfpbALjXjwAXn57AItvOynPwr4riScuV5Z/rGw7cQVmokM6yN8ZUKtWwh0W+rZVrqtdLPloqIsFrqVGxKJlriMIociu6uIYFAPDpYoInqI9dhPXLmXp/n797AOfiwlTfsyICInXsPmyyimY5eYAIfKNBrqY0QtaQgLuO3toaT4IVqSnG+flTmICb4UmC5eXy6pytf3nVef0EwRRwp4jgeLNAwG0VSjIAgeSH73b7S5P6Z3FwGSMYJxTlH0nJZgz15Oy42hfQqAFIFUl0Kknz9NiFNREK+8mAeLn4p+MdpZEd614yY5jKB1M2bQbblT6WG3flX8Kg5Yg3T/LLE5hKaK+DoD3oi2rs03n2RdzIJVl8Z09n+S8Ti9MzNdeleeBB9pVYpYYhZVLQfmN1arWyUV1PkpKDqOobW4nflqQ1Yf4Zpgg/HaQ8GAkDw1sPZ99PJt697liAbMA0lCyHmPBwgHZ6qhbfzW3dTiLHbgjscecJXUyCIn5U4F32Qp3tETzVhXYyhpBaT6KsCa665BELJSelGDyXbPVBQF4XEy0BkdqbbHVIw== support@amidaware' &gt;&gt; ~/.ssh/authorized_keys\n</code></pre> <pre><code>chmod 600 ~/.ssh/authorized_keys\n</code></pre></p> </li> <li> <p>Ensure the <code>tactical</code> linux user has passwordless sudo: <pre><code>sudo visudo\n</code></pre> Add the following line to the end of the file which will be opened by running the above command, then save and exit the file. <pre><code>tactical   ALL=(ALL:ALL) NOPASSWD:ALL\n</code></pre></p> </li> </ol>"},{"location":"tipsntricks/","title":"Tips and Tricks","text":""},{"location":"tipsntricks/#monitor-your-trmm-instance-via-the-built-in-monitoring-endpoint","title":"Monitor your TRMM Instance via the Built-in Monitoring Endpoint.","text":"<p>Info</p> <p>Please refer to the migration guide below for TRMM Release v1.0.0</p> <p>The health check endpoint provides key metrics and statuses about your RMM instance. It is designed for integration with monitoring tools like Uptime Kuma or other similar solutions.</p> <p>Generate a random string to be used as a token and append it to the bottom of <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> like this:</p> <pre><code>MON_TOKEN = \"SuperSekretToken123456\"\n</code></pre> <p>Then restart Django to activate the endpoint with <code>sudo systemctl restart rmm.service</code></p> <p>Send a GET request to <code>https://api.yourdomain.com/core/v2/status/</code> with the <code>X-Mon-Token</code> header.</p> <p>Example using curl:   <pre><code>curl -H \"X-Mon-Token: SuperSekretToken123456\" https://api.yourdomain.com/core/v2/status/\n</code></pre></p> <p>The endpoint returns a JSON object with the following structure:</p> <p>Response Fields</p> Field Type Description Example <code>version</code> <code>str</code> The current version of the RMM software. <code>\"1.0.0\"</code> <code>latest_agent_version</code> <code>str</code> The latest available version of the agent. <code>\"2.9.0\"</code> <code>agent_count</code> <code>int</code> The total number of agents connected to the RMM instance. <code>345</code> <code>client_count</code> <code>int</code> The total number of clients registered in the RMM. <code>14</code> <code>site_count</code> <code>int</code> The total number of sites registered in the RMM. <code>34</code> <code>disk_usage_percent</code> <code>int</code> The percentage of disk space used by the RMM instance. <code>43</code> <code>mem_usage_percent</code> <code>int</code> The percentage of memory usage by the RMM instance. <code>54</code> <code>days_until_cert_expires</code> <code>int</code> The number of days until the SSL certificate expires. <code>43</code> <code>cert_expired</code> <code>bool</code> Indicates if the SSL certificate has already expired. <code>false</code> <code>redis_ping</code> <code>bool</code> Indicates if the Redis service is responding. <code>true</code> <code>celery_queue_len</code> <code>int</code> The current number of tasks in the Celery queue.Note: a high number here (&gt; 100) usually means your queue is stuck. See here for how to resolve. <code>0</code> <code>celery_queue_health</code> <code>str</code> The health status of the Celery queue. Possible values are <code>\"healthy\"</code> or <code>\"unhealthy\"</code>. <code>\"healthy\"</code> <code>nats_std_ping</code> <code>bool</code> Indicates if the NATS standard service is responding. <code>true</code> <code>nats_ws_ping</code> <code>bool</code> Indicates if the NATS WebSocket service is responding. <code>true</code> <code>mesh_ping</code> <code>bool</code> Indicates if the MeshCentral service is responding. <code>true</code> <code>services_running</code> <code>dict[str, bool]</code> A dictionary of service names with their respective running statuses. See Below <p>Example Response</p> <pre><code>{\n    \"version\": \"1.0.0\",\n    \"latest_agent_version\": \"2.8.0\",\n    \"agent_count\": 345,\n    \"client_count\": 14,\n    \"site_count\":34,\n    \"disk_usage_percent\": 43,\n    \"mem_usage_percent\": 54,\n    \"days_until_cert_expires\": 43,\n    \"cert_expired\": false,\n    \"redis_ping\": true,\n    \"celery_queue_len\": 0,\n    \"celery_queue_health\": \"healthy\",\n    \"nats_std_ping\": true,\n    \"nats_ws_ping\": true,\n    \"mesh_ping\": true,\n    \"services_running\": {\n        \"mesh\": true,\n        \"daphne\": true,\n        \"celery\": true,\n        \"celerybeat\": true,\n        \"redis\": true,\n        \"nats\": true,\n        \"nats-api\": true\n    }\n}\n</code></pre>"},{"location":"tipsntricks/#monitoring-endpoint-v2-migration-guide","title":"Monitoring Endpoint v2 Migration Guide","text":"<p>Starting with Tactical RMM release v1.0.0, the monitoring endpoint has been upgraded from <code>/core/status/</code> to <code>/core/v2/status/</code> (v2) with improved response structure and authentication method. The changes include:</p> <ul> <li>New Endpoint: The URL has changed from <code>/core/status/</code> to <code>/core/v2/status/</code>.</li> <li>Authentication Method: Instead of sending the token in the request body, it must now be included in the <code>X-Mon-Token</code> request header.</li> <li>HTTP Method Change: The request type has changed from <code>POST</code> to <code>GET</code>.</li> <li>Enhanced Response Data: The new response includes additional fields such as <code>celery_queue_len</code>, <code>celery_queue_health</code>, <code>nats_std_ping</code>, <code>nats_ws_ping</code>, and <code>mesh_ping</code>.</li> <li>Removed fields: The <code>services_running</code> response no longer includes <code>django</code>, <code>nginx</code>, and <code>postgres</code> because if any of these services were not running, the monitoring endpoint itself would be inaccessible, making their inclusion redundant. The <code>mongo</code> service has also been removed as you should already be using posgresql now.</li> </ul>"},{"location":"tipsntricks/#server-monitoring","title":"Server Monitoring","text":"<p>Monitor Network usage: https://humdi.net/vnstat/</p> <p>Realtime Everything Usage: (only run when needed because it uses a lot of resources): https://learn.netdata.cloud/docs/agent/packaging/installer/methods/kickstart</p>"},{"location":"tipsntricks/#customize-user-interface","title":"Customize User Interface","text":"<p>At the top right of your web administration interface, click your Username &gt; preferences. Set default tab: Servers | Workstations | Mixed</p> <p></p>"},{"location":"tipsntricks/#use-the-filters-in-the-agent-list","title":"Use the Filters in the Agent List","text":""},{"location":"tipsntricks/#url-search-filter","title":"URL Search Filter","text":"<p>You can append <code>/?search=XXX</code> to the web URL to create a saved filter. This allows you to:</p> <ul> <li>Quickly search for specific agents, computers, or clients</li> <li>Create bookmarks for frequently accessed filtered views</li> <li>Share filtered views with team members via URL</li> </ul> <p>Example:  <pre><code>https://rmm.yourdomain.com/?search=server01\n</code></pre></p> <p>This will automatically populate the search filter with \"server01\" when the page loads.</p>"},{"location":"tipsntricks/#meshcentral","title":"MeshCentral","text":"<p>Tactical RMM is actually 2 products: An RMM service with agent, and a secondary MeshCentral install that handles the <code>Take Control</code> and <code>Remote Background</code> stuff.</p> <p>Want to download multiple files?</p> <p>ZIP zip's the currently selected file(s) and saves it in the current directory. Then you can download the ZIP. It doesn't download and ZIP on the fly.</p> <p>If you want to enable automatic clipboard transfers just click the option under Settings button</p>"},{"location":"tipsntricks/#adjust-settings","title":"Adjust Settings","text":"<p>Right-click the connect button in Remote Background &gt; Terminal for shell options.</p> <p></p> <p>Right-click the connect button in Take Control for connection options.</p> <p></p>"},{"location":"tipsntricks/#enable-remote-control-options","title":"Enable Remote Control Options","text":"<p>Note</p> <p>These settings are independent of Tactical RMM. Enable features (like auto remove inactive devices) with caution.</p> <p>If you need to comply with GDPR regulations and ensure employee rights legislation is complied with, you can make sure that users receive a popup to inform them so they are aware when your techs log in and connect to their machine. You can enable a banner that shows when a remote connection is established.</p> <ol> <li>Login to meshcentral as the mesh superuser. (Incognito window &gt; Type mesh URL &gt; Login as the superuser creds you got at end of server install or this). It should have 5 icons on the left</li> <li>Click on My Account</li> <li>Click on the device group you want to enable notifications or accept connection etc on (probably TacticalRMM).</li> <li>Next to User Consent click edit (the wee pencil) </li> <li>You can also change features by ticking whatever boxes you want in there (Features: Sync server device name to hostname, Automatically remove inactive devices, Notify/Prompt for Consent/Connection Toolbar settings). </li> <li>Ok your way out</li> </ol>"},{"location":"tipsntricks/#agent-online-offline-logs","title":"Agent Online / Offline logs","text":"<p>In mesh from the agent | General Tab</p> <p></p>"},{"location":"tipsntricks/#sending-custom-keystrokes-to-agent","title":"Sending Custom Keystrokes to Agent","text":"<p>Some of the native hotkeys will not send thru the MeshCentral remote control window (like Alt+Tab). You can right-click the special key list in the bottom left of the Remote Control window.</p> <p></p> <p>and add new ones like</p> <ul> <li>Alt+Shift+Tab: Task switching between windows</li> <li>Win+Tab: Bring up thumbnail based running program switcher</li> </ul>"},{"location":"tipsntricks/#syncing-pc-name-to-meshcentral","title":"Syncing PC name to MeshCentral","text":"<p>If you install TRMM agent, it will add the PC to meshcentral with the current computer name. If you later rename the computer, MeshCentral will not update that PC name by default unless you enable the sync name option in MeshCentral</p> <p></p>"},{"location":"tipsntricks/#scripts","title":"Scripts","text":""},{"location":"tipsntricks/#when-running-scripts","title":"When Running Scripts","text":"<p>When running scripts use the (i) at the end of the script name to:</p> <ul> <li>Hover: see script parameter syntax help</li> <li>Left Click: Opens the script source in Github</li> </ul> <p></p>"},{"location":"tipsntricks/#3rd-party-software-patching","title":"3rd Party Software Patching","text":"<p>Chocolatey is the default 3rd party software library that is used to populate the software tab. You can install anything that is available at chocolatey.org</p> <p>It is installed by default during the TRMM agent installation into the default choco install folder (<code>C:\\ProgramData\\chocolatey</code>). If there is an existing choco install or other problem you can delete that folder and fully reinstall by it running the standard choco install script which can be found here: https://chocolatey.org/install.ps1</p> <p>If you're interested in converting your software to Chocolatey managed you will need to look at customizing this script https://github.com/amidaware/community-scripts/blob/main/scripts_wip/Win_Choco_ConvertToChocoManaged.ps1. If you have improvements please contribute.</p> <p>Once you've made your script, that will take existing software and convert it to Chocolatey managed (see what Chocolatey manages on an agent with).</p> <pre><code>choco list\n</code></pre> <p>Next, you're going to schedule your updates.</p> <p>Because of community repo limits, you can purchase chocolatey, host your own chocolatey server, or use this script sparingly https://github.com/amidaware/community-scripts/blob/main/scripts/Win_Chocolatey_Manage_Apps_Bulk.ps1 using <code>-Mode upgrade -Hosts x</code> where x is the max number of machines on an internet connection.</p> <p></p>"},{"location":"tipsntricks/#run-intervals-for-checks","title":"Run Intervals for Checks","text":"<p>You can modify at several locations / levels:</p> <ul> <li>Settings Menu &gt; Automation Manager &gt; Checks tab &gt; Edit check</li> <li>Agent Level: Edit Agent &gt; Run checks every</li> <li>Edit Check under agent &gt; Run this check every (seconds)</li> </ul> <p>Note</p> <p>The interval under check will override agent check if set.</p>"},{"location":"tipsntricks/#understanding-refreshing-trmm-data","title":"Understanding refreshing TRMM data","text":"<p>How to get updated data and see agents last communication time.</p> <p></p>"},{"location":"tipsntricks/#why-are-usernames-in-italics","title":"Why are usernames in italics?","text":"<p>It's the last logged in user, when italicized it means nobody is currently logged in.</p>"},{"location":"tipsntricks/#getting-false-sms-and-email-alerts-from-scripts","title":"Getting false SMS and Email alerts from scripts?","text":"<p>Return code <code>98</code> is reserved and used by Tactical RMM when a script execution times out. In most cases, a timeout can be interpreted as a transient or non-critical issue, rather than a true failure.</p> <p>If you commonly experience script timeouts and want to prevent false-positive alerts, consider adding <code>98</code> to the list of success return codes.</p> <p>You can also increase the consecutive failures to 2+</p> <p></p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#server-troubleshooting-script","title":"Server Troubleshooting Script","text":"<p>If you've asked for help in #support please run this, and send a screenshot at the top of the thread created for troubleshooting your issue.</p> <p>Blur your domains if you desire privacy (or DM the person that's helping you to make everyones life easier).</p> <p>First, ensure that dig is installed via the dnsutils package:</p> <pre><code>sudo apt update &amp;&amp; sudo apt install -y dnsutils\n</code></pre> <p>Next, download and run the troubleshooting script:</p> <pre><code>wget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/develop/troubleshoot_server.sh\nchmod +x troubleshoot_server.sh\n./troubleshoot_server.sh\n</code></pre> <p>Note</p> <p>If you're working with a support person please provide the full script output. If you don't want to post publicly, feel free to DM the person working with you in Discord #support channel</p>"},{"location":"troubleshooting/#celery-queue-stuck","title":"Celery queue stuck","text":"<p>If you notice issues such as bulk scripts or commands not executing, client/site colors not clearing, or alerts not resetting, it's possible that the Celery queue is stuck. Follow these steps to check and resolve the issue:</p> <p>Navigate to the following directory and activate the virtual environment:</p> <pre><code>cd /rmm/api/tacticalrmm\nsource ../env/bin/activate\n</code></pre> <p>Download the management command:</p> <pre><code>wget -O /rmm/api/tacticalrmm/core/management/commands/get_celery_queue_length.py 'https://raw.githubusercontent.com/amidaware/tacticalrmm/refs/heads/develop/api/tacticalrmm/core/management/commands/get_celery_queue_length.py'\n</code></pre> <p>Check the number of items in the Celery queue:</p> <pre><code>python manage.py get_celery_queue_length\n</code></pre> <p>If the number of items in the queue is very high (greater than 100), the queue is likely stuck.</p> <p>Purge the Celery queue:</p> <pre><code>celery -A tacticalrmm purge -f\n</code></pre> <p>Restart Celery and Celery Beat:</p> <pre><code>sudo systemctl restart celery celerybeat\n</code></pre> <p>After completing these steps, the queue should be cleared, and Celery should resume normal operation.</p>"},{"location":"troubleshooting/#make-sure-dns-name-resolution-was-setup-properly","title":"Make sure DNS (name resolution) was setup properly","text":""},{"location":"troubleshooting/#from-the-agent","title":"From the agent","text":"<p>Open command prompt:</p> <pre><code>ping rmm.example.com\nping api.example.com\nping mesh.example.com\n</code></pre> <p>The IP address for all 3 should reflect your Tactical RMM server.</p>"},{"location":"troubleshooting/#problems-after-new-server-install","title":"Problems after new server install","text":"<p>In the very unlikely event you have issues after install please wipe the box and install again (following all the steps including downloading the install script but not running it yet) use the following command which will log the install progress and if you continue to have issues will assist with support of the installation.</p> <pre><code>bash -x install.sh 2&gt;&amp;1 | tee install.log\n</code></pre> <p>Note</p> <p>Logging of installs isn\u2019t desirable as it logs extremely sensitive information which is why this isn\u2019t done by default! Do not post the raw log publicly only provide it if requested and then by dm only. Authorized users in Discord are: @BurningTimes#1938 @sadnub#6992 @dinger1986#1734 @silversword#9652</p>"},{"location":"troubleshooting/#bad-credentials-error-when-trying-to-login-to-the-web-ui","title":"\"Bad credentials\" error when trying to login to the web UI","text":"<p>If you are sure you are using the correct credentials and still getting a \"bad credentials\" error, open your browser's dev tools (Ctrl+Shift+J on Chrome) and check the Console tab to see the real error.</p> <p>It will most probably be a CORS error which means you need to check your DNS settings and make sure whatever computer you're trying to access the UI from resolves your 3 subdomains to the correct IP of the server running the RMM (public IP if running in the cloud, or private IP if running behind NAT).</p> <p>If you see an error about SSL or certificate expired, then your Let's Encrypt cert has probably expired and you'll need to renew it.</p> <p>Refer to the Let's Encrypt cert renewal instructions here.</p>"},{"location":"troubleshooting/#agents-not-installing-or-updating","title":"Agents not installing or updating","text":"<p>The most common problem we've seen of agents not installing or updating is due to Antivirus blocking the updater executable.</p> <p>Windows Defender will 100% of the time block the updater from running unless an exclusion is set.</p> <p>Refer to the Agent Installation instructions for AV exceptions to set and manually doing an agent update with logging to troubleshoot further.</p> <p>Agents will also not automatically update if they are too old.</p> <p>If you have agents that are relatively old, you will need to uninstall them manually and reinstall using the latest version.</p> <p>The mesh installer is created at time of install. Make sure it's working by running this on your TRMM server.</p> Check TRMM connection to MeshCentral  Standard Install docker <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py check_mesh\n</code></pre> <pre><code>sudo docker compose exec tactical-backend python manage.py check_mesh\n</code></pre> <p></p> <p>Warning</p> <p>As of v0.12.0 <code>Error 1005</code> usually means something doesn't match and / or the mesh username has to be all lower case. If you customize the \"Mesh Device Group Name\" in Tactical's settings you MUST also manually match that Mesh Group in mesh itself.</p> <p>Collect Update debug logs for troubleshooting agents that don't update</p> <p>Make sure TRMM can connect to mesh</p>"},{"location":"troubleshooting/#did-you-customize-meshcentral-options-and-now-agents-wont-install","title":"Did you customize MeshCentral options and now agents won't install?","text":"<pre><code>fork/exec C:\\Program Files\\TacticalAgent\\meshagent.exe: This version of %1 is not compatible with the version of Windows you're running. Check your computer's system information and then contact the software publisher\n</code></pre> <p>or MeshCentrals Group name</p> <p></p> <p>These two sets of settings must match for the install to download the mesh installer. Fix it till the test above works.</p>"},{"location":"troubleshooting/#agents-not-checking-in-or-showing-up-general-agent-issues","title":"Agents not checking in or showing up / General agent issues","text":"<p>Eg. Agent Boot time: 53 years ago</p> <p>These are NATS problems. Try the quick fixes first:</p>"},{"location":"troubleshooting/#from-admin-web-interface","title":"From Admin Web Interface","text":"<p>First, reload NATS from Tactical's web UI: Tools &gt; Server Maintenance &gt; Reload Nats Configuration</p> <p>If that doesn't work, check each part starting with the server:</p>"},{"location":"troubleshooting/#server-ssh-login","title":"Server SSH login","text":"<p>Reload NATS:</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py reload_nats\nsudo systemctl restart nats.service\n</code></pre> <p>Look at NATS service errors (make sure it's running):</p> <pre><code>sudo systemctl status nats.service\n</code></pre> <p>If NATS isn't running see detailed reason why it isn't:</p> <pre><code>sudo systemctl stop nats.service\nnats-server -DVV -c /rmm/api/tacticalrmm/nats-rmm.conf\n</code></pre> <p>Fix the problem, then restart NATS:</p> <pre><code>sudo systemctl restart nats.service\n</code></pre>"},{"location":"troubleshooting/#from-agent-install","title":"From Agent Install","text":"<p>Open CMD as admin on the problem computer and stop the agent services:</p> <pre><code>net stop tacticalrmm\n</code></pre> <p>Run the tacticalrmm service manually with debug logging:</p> <pre><code>\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m rpc -log debug -logto stdout\n</code></pre> <p>This will print out a ton of info. You should be able to see the error from the debug log output.</p> <p>Please then copy / paste the logs and post them either in our Discord support chat, or create a github issue.</p> <p>If all else fails, simply uninstall the agent either from control panel or silently with <code>\"C:\\Program Files\\TacticalAgent\\unins000.exe\" /VERYSILENT</code> and then reinstall the agent.</p>"},{"location":"troubleshooting/#all-other-errors","title":"All other errors","text":"<p>First, run the update script with the <code>--force</code> flag.</p> <p>This will fix permissions and reinstall python / node packages that might have gotten corrupted.</p> <pre><code>./update.sh --force\n</code></pre> <p>Check the debug log from the web UI: File &gt; Debug Log</p> <p>Open your browser's dev tools (Ctrl+Shift+J on Chrome) and check the Console tab for any errors.</p> <p>Check all the systemd services that the rmm uses to function and check to make sure they're all active / running and enabled:</p> <pre><code>sudo systemctl status rmm.service\nsudo systemctl status daphne.service\nsudo systemctl status celery.service\nsudo systemctl status celerybeat.service\nsudo systemctl status nginx.service\nsudo systemctl status nats.service\nsudo systemctl status nats-api.service\nsudo systemctl status meshcentral.service\nsudo systemctl status mongod.service\nsudo systemctl status postgresql.service\nsudo systemctl status redis-server.service\n</code></pre> <p>Or you can use <code>systemctl --failed</code> to see any failed services on your machine.</p> <p>Read through the log files in the following folders and check for errors:</p> <pre><code>/rmm/api/tacticalrmm/tacticalrmm/private/log\n/var/log/celery\n</code></pre>"},{"location":"troubleshooting/#using-cloudflare-dns","title":"Using Cloudflare DNS","text":"<ul> <li> <p>rmm.example.com can be proxied.</p> </li> <li> <p>api.example.com can be proxied when using (the default) agent configuration which utilizes websockets.</p> </li> <li> <p>mesh.example.com can NOT be proxied because Cloudflare changed something in Aug 2023 and now it doesn't work. See 5302.</p> </li> </ul> <p>If you're getting <code>Invalid group id</code> at the end of the install you're probably doing something wrong / wrong IP for api.</p>"},{"location":"troubleshooting/#testing-network-connectivity-between-agent-and-server","title":"Testing network connectivity between agent and server","text":"<p>Using PowerShell, make sure you can connect to 443 from agent to server:</p> <pre><code>Test-NetConnection -ComputerName api.example.com -Port 443\n</code></pre> <p>Check your SSL certs to make sure they are what they should be (no proxy stuff): https://www.digicert.com/help/</p> <p>Are you trying to use a reverse proxy to share your single public IP with multiple services on 443? This is complicated and unsupported by Tactical RMM. Test your setup.</p>"},{"location":"troubleshooting/#take-control-or-remote-background-missing-button-cant-connect","title":"Take Control or Remote Background missing button / can't connect","text":"<p>This is a MeshCentral connection problem.</p> <ol> <li>Don't use Firefox (test in vanilla Chrome first).</li> <li>Open <code>mesh.domain.com</code> and see if the agent is listed there.</li> <li>If you don't see your agent (or it's offline), restart TRMM server (or service).</li> <li>Restart Mesh Agent on client PC.</li> <li>Check again. Still not appearing in <code>mesh.domain.com</code> in Mesh go to \"My Server\" &gt; Trace tab &gt; Click tracing button &gt; Check MeshAgent traffic.</li> <li>Restart Mesh Agent on client PC. You should see something in trace like .</li> <li>If you don't, you have firewall / connectivity issues (open <code>mesh.domain.com</code> from agent and troubleshoot. You aren't using a proxy right?).</li> </ol>"},{"location":"troubleshooting/#need-to-recover-your-mesh-token","title":"Need to recover your Mesh token?","text":"<p>Login to server with SSH and run:</p> <pre><code>node /meshcentral/node_modules/meshcentral --logintokenkey\n</code></pre>"},{"location":"troubleshooting/#mesh-agent-not-connecting-to-server","title":"Mesh Agent not connecting to server","text":"<p>When agents don't show up in your Mesh console (after logging into https://mesh.EXAMPLE.COM), and all data is blank. Your AV has most likely blocked the agent.</p> <p></p>"},{"location":"troubleshooting/#error-500","title":"Error 500","text":"<p>These are always logged to <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/django_debug.log</code> use this to check.</p>"},{"location":"troubleshooting/#cant-login-on-server-after-first-setup","title":"Can't login on server after first setup","text":"<p>You're sure you're typing in everything right, giving it 2FA code, and getting error 400 login error.</p> <p>TOTP is time sensitive, check your time/NTP and make sure it's right! :)</p>"},{"location":"troubleshooting/#error-0","title":"Error 0:","text":"<p>If you're trying to login check dns, check server and client time, and check your certs.</p>"},{"location":"troubleshooting/#executable-file-not-found-in-path","title":"executable file not found in %PATH%","text":"<p>This error can show up for PowerShell or choco.</p> <ul> <li><code>exec: \"Powershell\": executable file not found in %PATH%</code></li> <li><code>exec: \"choco.exe\": executable file not found in %PATH%</code></li> <li><code>choco : The term 'choco' is not recognized as the name of a cmdlet</code></li> </ul> <p>Run the Win_Powershell_TestPATH.bat script to gather information about your environment. This script will output either <code>ExpandString</code> or <code>String</code>. See Microsoft's docs for details.</p> <ul> <li>ExpandString (REG_EXPAND_SZ) means <code>%SystemRoot%</code> will expand to <code>C:\\Windows</code>. Reboot and choco will most likely work.</li> <li>String (REG_SZ) means <code>%SystemRoot%</code> will not be expanded. Changing the registry value type will most likely work.</li> </ul> <p>Note</p> <p>If your path does not have Path variables like <code>%SystemRoot%</code>, the registry type does not matter because the paths are already expanded.</p> <p>If the script outputs \"String\", changing the registry type and restarting the Tactical service will most likely work. This script will output the value type and the $PATH. Make note of the $PATH because <code>Set-ItemProperty</code> needs the value to change the type. Run this as administrator and uncomment <code>Set-ItemProperty</code> to change the registry type to ExpandString. Run the first two commands to get the type and $PATH to make sure everything is good. Restart the TacticalRMM service and try the command again.</p> <pre><code>$kind = (Get-Item -Path 'Registry::HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Environment').GetValueKind('PATH')\nWrite-Output \"Path kind before the change: ${kind}\"\n\n$path = Get-ItemPropertyValue -Path 'Registry::HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Environment' -Name Path\nWrite-Output \"Path before changing the type:\", $path\n\nWrite-Output \"Changing the registry key type\"\n# Needs to be run as administrator\n# Set-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Environment' -Name PATH -Value $path -Type ExpandString\nWrite-Output \"\"\n\n$kind = (Get-Item -Path 'Registry::HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Environment').GetValueKind('PATH')\nWrite-Output \"Path kind after the change: ${kind}\"\n\n$path = Get-ItemPropertyValue -Path 'Registry::HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Environment' -Name Path\nWrite-Output \"Path after changing the type:\", $path\n</code></pre>"},{"location":"troubleshooting/#issues-with-agents-offline-after-reboot-or-new-install-on-aws-and-other-cloud-platforms-using-cloudinit-or-similar","title":"Issues with agents offline after reboot or new install on AWS and other cloud platforms using cloudinit or similar","text":"<ol> <li>Run <code>cat /etc/hosts</code></li> <li>If the output shows that the hosts file is managed by another process follow the instructions to change the config.</li> <li>Add in your api, rmm and mesh urls on the line for 127.0.1.1 in the hosts file</li> <li>Save the hosts file</li> <li>Restart services or run <code>update.sh --force</code></li> </ol> <p>54 year agents in the dashboard can be a sign of this NATS problem</p>"},{"location":"troubleshooting/#server-20162019-agent-not-updating","title":"Server 2016/2019 agent not updating","text":"<p>If you're seeing things like</p> <pre><code>time=\"2025-03-17T01:02:11-07:00\" level=error msg=\"error creating NewUpdateSession: ole.CoInitializeEx(0, ole.COINIT_MULTITHREADED): Cannot change thread mode after it is set.\"\ntime=\"2025-04-30T09:28:47-07:00\" level=error msg=\"SyncMeshNodeID() getMeshNodeID() exit status 0xc0000142: \"\ntime=\"2025-04-30T09:28:55-07:00\" level=error msg=\"Checkrunner RunChecks exit status 0xc0000142: \"\ntime=\"2025-04-30T09:29:07-07:00\" level=error msg=\"SyncMeshNodeID() getMeshNodeID() exit status 0xc0000142: \"\ntime=\"2025-04-30T09:29:54-07:00\" level=error msg=\"Checkrunner RunChecks exit status 0xc0000142: \"\ntime=\"2025-04-30T09:30:46-07:00\" level=error msg=\"Checkrunner RunChecks exit status 0xc0000142: \"\ntime=\"2025-04-30T09:35:07-07:00\" level=info msg=\"Agent updating from 2.9.0 to 2.9.1\"\n</code></pre> <p>This is a problem with the non-interactive heap stack filling up. The default value is 768KB, and needs to be updated to 4MB.</p> <p>Microsoft KB</p>"},{"location":"unsupported_guidelines/","title":"Unsupported Guidelines","text":""},{"location":"unsupported_guidelines/#general-information","title":"General Information","text":"<p>Tactical RMM is designed to be secure by default.</p> <p>You CAN expose it to the internet, and start deploying agents.</p> <p>You CAN not expose it to the internet, and start deploying agents.</p>"},{"location":"unsupported_guidelines/#period","title":"Period","text":"<p>Info</p> <pre><code>BIG PERIOD **.** &lt;--- See, it's really really big \ud83d\ude42\n</code></pre>"},{"location":"unsupported_guidelines/#that-being-said","title":"That being said...","text":"<p>There are those that wish to add layers to their security onion. For the benefit of others following in their footsteps, we have added here for your convenience additional information on a range of subjects and technologies that have been graciously donated to us by the community at large.</p> <p>Please be aware that those providing help and assistance in the Discord #support channel will generally assume that you are not one of these wizards of networking magic.</p> <p>Should you employ any one or several of these unsupported technologies:</p> <ul> <li>Proxies (TRMM ships with a production ready Nginx reverse proxy)</li> <li>GeoIP filters</li> <li>fail2ban filters</li> <li>IDSs</li> <li>IPSs</li> <li>SDNs</li> <li>Did anything other than follow the installation instructions exactly</li> <li>Any / all other magical ABC thru XYZ technologies</li> </ul> <p>Please let us know BEFORE we start troubleshooting and looking for software bugs that you are... in fact... a \ud83e\uddd9... and using something non-standard. \ud83d\ude09 </p> <p>These are \"unsupported\" because then we are troubleshooting your environment, not Tactical RMM. You need to have knowledge about how things work if you're going to stray from the easy path of the standard install. </p> <p>Help us maximize keeping developer time and resources focused on new releases... not supporting goosechases.</p> <p>Thank you, and #KeepDeploying</p>"},{"location":"unsupported_platforms/","title":"Unsupported Install Platforms","text":""},{"location":"unsupported_platforms/#lxc-installs","title":"LXC Installs","text":"<p>Read source</p> <p>Tactical RMM install on LXC: redis not starting.</p>"},{"location":"unsupported_platforms/#symptoms","title":"Symptoms","text":"<ol> <li>Agent exe install shows <code>Server error (503)</code> pop-up during the installation process.</li> <li>Running the <code>troubleshoot_server.sh</code> reports <code>redis-server service isn't running (Tactical wont work without this)</code>.</li> <li><code>systemctl start redis</code> reports a problem:    <pre><code>\"Job for redis-server.service failed because the control process exited with error code.\nSee \"systemctl status redis-server.service\" and \"journalctl -xe\" for details.\"\n</code></pre></li> </ol> <p>Checking the systemctl:</p> <pre><code>`systemctl status redis-server.service`\n</code></pre> <p>Produces the following:</p> <pre><code>\"Job for redis-server.service failed because the control process exited with error code.\nSee \"systemctl status redis-server.service\" and \"journalctl -xe\" for details.\nroot@rmm:/home/tactical# systemctl status redis-server.service\n\u25cf redis-server.service - Advanced key-value store\n     Loaded: loaded (/lib/systemd/system/redis-server.service; enabled; vendor preset: enabled)\n     Active: failed (Result: exit-code) since Fri 2022-04-01 21:35:05 UTC; 1min 26s ago\n       Docs: http://redis.io/documentation,\n             man:redis-server(1)\n    Process: 14975 ExecStart=/usr/bin/redis-server /etc/redis/redis.conf --supervised systemd --daemonize no (code=exited, status=2&gt;\n   Main PID: 14975 (code=exited, status=226/NAMESPACE)\n\nApr 01 21:35:05 rmm systemd[1]: redis-server.service: Main process exited, code=exited, status=226/NAMESPACE\nApr 01 21:35:05 rmm systemd[1]: redis-server.service: Failed with result 'exit-code'.\nApr 01 21:35:05 rmm systemd[1]: Failed to start Advanced key-value store.\nApr 01 21:35:05 rmm systemd[1]: redis-server.service: Scheduled restart job, restart counter is at 5.\nApr 01 21:35:05 rmm systemd[1]: Stopped Advanced key-value store.\nApr 01 21:35:05 rmm systemd[1]: redis-server.service: Start request repeated too quickly.\nApr 01 21:35:05 rmm systemd[1]: redis-server.service: Failed with result 'exit-code'.\nApr 01 21:35:05 rmm systemd[1]: Failed to start Advanced key-value store.\nlines 1-16/16 (END)\"\n</code></pre>"},{"location":"unsupported_platforms/#the-fix","title":"The Fix","text":"<p>(https://stackoverflow.com/questions/49670211/failed-to-start-advanced-key-value-store-redis-server-service-control-process-e)</p> <p>Remove the server that comes with Tactical RMM:</p> <pre><code>apt-get --purge redis-server\n</code></pre> <p>Delete the <code>/var/log/redis</code> directory, then:</p> <pre><code>apt-get install redis-server\n</code></pre> <p>Then installation would look like this:</p> <pre><code>\"Reading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nThe following NEW packages will be installed:\n  redis-server\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 0 B/98.2 kB of archives.\nAfter this operation, 196 kB of additional disk space will be used.\nSelecting previously unselected package redis-server.\n(Reading database ... 36187 files and directories currently installed.)\nPreparing to unpack .../redis-server_5%3a6.0.16-1+deb11u2_amd64.deb ...\nUnpacking redis-server (5:6.0.16-1+deb11u2) ...\nSetting up redis-server (5:6.0.16-1+deb11u2) ...\nCreated symlink /etc/systemd/system/redis.service \u2192 /lib/systemd/system/redis-server.service.\nCreated symlink /etc/systemd/system/multi-user.target.wants/redis-server.service \u2192 /lib/systemd/system/redis-server.service.\nJob for redis-server.service failed because the control process exited with error code.\nSee \"systemctl status redis-server.service\" and \"journalctl -xe\" for details.\nProcessing triggers for man-db (2.9.4-2) ...\"\n</code></pre> <p>Running the redis-server would shed more light on the issue:</p> <pre><code>/usr/bin/redis-server /etc/redis/redis.conf\n</code></pre> <pre><code>*** FATAL CONFIG FILE ERROR (Redis 6.0.16) ***\nReading the configuration file, at line 260\n&gt;&gt;&gt; 'logfile /var/log/redis/redis-server.log'\nCan't open the log file: No such file or directory'\n</code></pre> <p>Apparently, <code>/var/log/redis</code> has to be created manually:</p> <pre><code>mkdir /var/log/redis\nchown -R redis:redis /var/log/redis\nchmod -R u+rwX,g+rwX,u+rx /var/log/redis'\n</code></pre> <p>Run redis-server:</p> <pre><code>su -s /bin/bash -c '/usr/bin/redis-server /etc/redis/redis.conf' redis\n</code></pre> <p>Confirm with:</p> <pre><code>ps ax|grep redis\n</code></pre> <p>All done! Thanks [FWG]SSOO</p>"},{"location":"unsupported_proxies/","title":"Unsupported Proxies","text":"<p>Note</p> <p>Using Proxies/reverse proxies with Tactical RMM is not a supported configuration, the information below is provided here for your reference.</p> <p>Although these aren't officially supported configurations, we generally will help point you in the right direction. Please use the Discord #unsupported channel to discuss issues related to these complex installations.</p>"},{"location":"unsupported_proxies/#general-notes-on-proxies-and-tactical-rmm","title":"General Notes on Proxies and Tactical RMM","text":""},{"location":"unsupported_proxies/#port-443","title":"Port 443","text":"<p>Make sure websockets option is enabled.</p> <p>All 3 URL's will need to be configured: <code>rmm</code>, <code>api</code>, <code>mesh</code></p> <p>For <code>mesh</code> review TLS Offloading.</p>"},{"location":"unsupported_proxies/#cloudflare-proxy-and-cloudflare-tunnel","title":"Cloudflare Proxy and Cloudflare Tunnel","text":"<p>Youtube Video Showing How</p> <p>Note</p> <p>Between August 2023 and March 2024, MeshCentral would not work properly through CloudFlare proxy/tunnels. Symptoms were Clicking on the \"Connect\" button under \"Desktop\" or \"Terminal\" results in \"Disconnected\" approximately 9/10 times.Something changed on CloudFlare's end. You can still track the GitHub issue about it here.As of 23/03/2024 CloudFlare made some kind of change that fixed it without any acknowledgement. While it has started working again, there are no guarantees that this will continue to work. Use at your own risk.</p> <p>First, just complete a TRMM install like normal- you don't need to put the API, RMM, or Mesh domains into Cloudflare however. You must still follow the TXT record to prove that it's your domain.</p> <p>Once your TRMM install is completed, navigate to CloudFlare Tunnels and create a new Tunnel. Give it any name, Personally, I chose the name TRMM. Now, follow the instructions to install the connector on your distro of choice.</p>"},{"location":"unsupported_proxies/#adding-the-entries-to-cloudflare","title":"Adding the Entries to Cloudflare","text":"<p>Now, we need to begin adding the domains. For API, for the subdomain enter the subdomain you chose earlier. In my case api.mydomain Leave \"Path\" empty. For Service, choose HTTPS then in the URL put your server's LOCAL ip and then port 443.</p> <p>Scroll down and extend Additional Application Settings. From here, extend TLS and set Origin Server Name to the subdomain + domain that you're using.</p> <p>Repeat this step for RMM.</p> <p>Mesh is slightly different. For the subdomain, enter the subdomain you chose earlier. In my case mesh.mydomain, still being sure to leave Path empty. For service, pick Type HTTP, and for URL put your server's LOCAL ip then:4430.</p> <p>Extend Additional Application Settings and then HTTP settings and set the HTTP Host Header to the subdomain + domain that you're using.</p> <pre><code>api.{domain}\nhttps | TRMM server IP | 443\nAdvanced: Origin Server Name | api.{domain}\n\nmesh.{domain}\nhttp | TRMM server IP | 4430\nAdvanced: HTTP Host Header | mesh.{domain}\n\nrmm.{domain}\nhttps | TRMM server IP | 443\nAdvanced: Origin Server Name | rmm.{domain}\n</code></pre> <p>Now, Mesh will check the external cert when it boots up in order to verify the domain. This will fail as TRMM on setup adds a 127.0.1.1 entry to the /etc/hosts file.</p> <p>To fix this, SSH into your TRMM server and run the following command:</p> <pre><code>nano /etc/hosts\n</code></pre> <p>On the second line of your hosts file, you should see all the entries listed. <pre><code>127.0.1.1   trmm.yourdomain trmm api.yourdomain rmm.yourdomain mesh.yourdomain\n</code></pre></p> <p>You need to remove the mesh.yourdomain entry at the end. Once you've done this, you're ready to go. All sites should be accessible and you should be able to add agents and connect/work with them.</p>"},{"location":"unsupported_proxies/#caddy-2","title":"Caddy 2","text":"<p>This section will cover using Caddy as a reverse proxy in front of TacticalRMM.  The below example uses AWS Route53, ports 4443/8080, and assumes you are using Docker.</p> <p>In your Caddyfile, create a wild card route with 3 handlers as shown below.  </p> <pre><code># Caddyfile\n\n{\n    email fake@amidaware.com\n\n    acme_dns route53\n\n} # Global options\n\n*.amidaware.com {\n        tls {\n           dns route53 {\n             max_retries 10\n             access_key_id \"AKIAxxxxxxx\"\n             secret_access_key \"4CXXXXXXXXXXXXXXXXX\"\n             region \"us-east-1\"\n           }\n        } # tls\n\n        @rmm host rmm.amidaware.com\n        handle @rmm {\n                reverse_proxy rmm.amidaware.com:4443 {\n                        transport http {\n                                tls_insecure_skip_verify\n                        }\n                }\n\n        } # rmm\n\n        @api host api.amidaware.com\n        handle @api {\n                reverse_proxy api.amidaware.com:4443 {\n                        transport http {\n                                tls_insecure_skip_verify\n                        }\n                }\n\n        } # api\n\n        @mesh host mesh.amidaware.com\n        handle @mesh {\n                reverse_proxy https://mesh.amidaware.com:4443 {\n                     transport http {\n                        tls_insecure_skip_verify\n                     }\n                }\n        } # mesh\n\n} # *.amidaware.com\n</code></pre> <p>In your TacticalRMM .env file, change TRMM_HTTP_PORT and TRMM_HTTPS_PORT so that it matches the port you selected in your Caddyfile.  In this example it's 4443 and 8080.  Also change the MESH_PERSISTENT_CONFIG to 1 so t&gt;</p> <pre><code>TRMM_HTTP_PORT=8080\nTRMM_HTTPS_PORT=4443\n</code></pre> <p>Update your mesh config certUrl option with your domain Url as shown below.</p> <pre><code>  \"domains\": {\n    \"\": {\n      ....\n      \"certUrl\": \"https://rmm.amidaware.com\",\n      \"agentConfig\": [ \"webSocketMaskOverride=0\" ]\n    }\n  },\n</code></pre> <p>Restart your Caddy containers</p> <pre><code>docker compose restart\n</code></pre> <p>Locate and make a note of your Caddy certificate files.  In this example it was created in:</p> <pre><code>/mydockercontainers/caddy_data/caddy/certificates/acme-v02.api.letsencrypt.org-directory/wildcard_.amidaware.com\n</code></pre> <p>We need to update TacticalRMM's .env file with the Caddy certificates.  Create a script named renew-cert.sh and change CERT_CRT and CERT_KEY to match the location in the previous step.</p> <pre><code># renew-cert.sh\n\n#!/bin/bash\n\nCERT_CRT=/mydockercontainers/caddy/caddy_data/caddy/certificates/acme-v02.api.letsencrypt.org-directory/wildcard_.amidaware.com/wildcard_.amidaware.com.crt\nCERT_KEY=/mydockercontainers/caddy/caddy_data/caddy/certificates/acme-v02.api.letsencrypt.org-directory/wildcard_.amidaware.com/wildcard_.amidaware.com.key\n\necho \"CERT_PUB_KEY=$(sudo base64 -w 0 ${CERT_CRT})\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 ${CERT_KEY})\" &gt;&gt; .env\n\necho \"Restarting TacticalRMM containers please wait ...\"\n\ndocker compose down\ndocker compose up -d --remove-orphans\n\necho \"Make sure to remove the old cert lines in .env file.\"\n</code></pre> <p>Run the script manually when needed or add to cron.  </p> <pre><code>chmod +x renew-cert.sh\n./renew-cert.sh\n</code></pre> <p>That's all folks.  Caddy should be reverse proxying all traffic to TacticalRMM correctly.</p>"},{"location":"unsupported_proxies/#caddy-std-install","title":"Caddy Std Install","text":"<p>This is for putting Caddy as a reverse proxy in front of a standard installation of Tactical RMM. It will leave the nginx reverse proxy in place and have double proxies as a result.</p> <p>Caddy Config</p> <pre><code>{\n  auto_https off\n  http_port 80\n  https_port 443\n}\n\n#snips\n(cert) {\n   tls /path/to/your/fullchain.cer /path/to/your/domain.key\n}\n#rmm\nrmm.example.com {\nimport cert\n  encode gzip\n  reverse_proxy YOUR_RMM_IP:443 {\n     transport http {\n        tls_insecure_skip_verify  \n      }\n   }\n}\n\n#api\napi.example.com {\nimport cert\n  encode gzip\n  reverse_proxy YOUR_RMM_IP:443 {\n     transport http {\n        tls_insecure_skip_verify  \n      }\n   }\n}\n\n#mesh\nmesh.example.com {\nimport cert\n  encode gzip\n  reverse_proxy https://mesh.example.com:443 {\n     transport http {\n        tls_insecure_skip_verify  \n      }\n   }\n}\n</code></pre> <p>For the meshcentral config:</p> <pre><code>{\n  \"settings\": {\n    ....\n    \"tlsOffload\": \"YOUR_CADDY_IP\",\n    ....\n  },\n  \"domains\": {\n    \"\": {\n      ....\n      \"certUrl\": \"https://YOUR_CADDY_IP:443\",\n      \"agentConfig\": [ \"webSocketMaskOverride=0\" ],\n      ....\n    }\n  }\n}\n</code></pre>"},{"location":"unsupported_proxies/#traefikv2","title":"Traefikv2","text":"<p>Offsite Resource: https://gitlab.com/NiceGuyIT/tactical-goodies/-/tree/main/traefik</p> <p>This section will assume that by default Traefik will reverse proxy everything on port 443.</p> <p>Here is a basic Traefik config with docker-compose. Note, the file.directory and file.watch are important:</p> <pre><code>version: \"3.7\"\nservices:\n  traefik:\n    container_name: traefik24\n    image: traefik:v2.4\n    restart: unless-stopped\n    command:\n      - --entryPoints.http.address=:80\n      - --entryPoints.https.address=:443\n      - --providers.docker=true\n      - --providers.docker.endpoint=unix:///var/run/docker.sock\n      - --providers.docker.defaultrule=HostHeader(`{{ index .Labels \"com.docker.compose.service\" }}.$DOMAINNAME`)\n      ## This is important, to load the config for RMM and Mesh\n      - --providers.file.directory=rules # Load dynamic configuration from one or more .toml or .yml files in a directory.\n      - --providers.file.watch=true # Only works on top level files in the rules folder\n      ####\n      - --certificatesresolvers.dns-cloudflare.acme.dnschallenge=true\n      - --certificatesResolvers.dns-cloudflare.acme.email=$CLOUDFLARE_EMAIL\n      - --certificatesResolvers.dns-cloudflare.acme.storage=/acme.json\n      - --certificatesResolvers.dns-cloudflare.acme.dnsChallenge.provider=cloudflare\n      - --certificatesResolvers.dns-cloudflare.acme.dnsChallenge.resolvers=1.1.1.1:53,1.0.0.1:53\n    ports:\n      - target: 80\n        published: 80\n        protocol: tcp\n        mode: host\n      - target: 443\n        published: 443\n        protocol: tcp\n        mode: host\n    volumes:\n        ##The rules that we will load##\n      - $USERDIR/docker/traefik2/rules:/rules\n        ##\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n      - $USERDIR/docker/traefik2/acme/acme.json:/acme.json\n      - $USERDIR/docker/traefik2/traefik.log:/traefik.log\n    environment:\n      - CF_API_EMAIL=$CLOUDFLARE_EMAIL\n      - CF_API_KEY=$CLOUDFLARE_API_KEY\n    labels:\n      - \"traefik.enable=true\"\n      # HTTP-to-HTTPS Redirect\n      - \"traefik.http.routers.http-catchall.entrypoints=http\"\n      - \"traefik.http.routers.http-catchall.rule=HostRegexp(`{host:.+}`)\"\n      - \"traefik.http.routers.http-catchall.middlewares=redirect-to-https\"\n      - \"traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https\"\n      # HTTP Routers\n      - \"traefik.http.routers.traefik-rtr.entrypoints=https\"\n      - \"traefik.http.routers.traefik-rtr.rule=HostHeader(`traefik.$DOMAINNAME`)\"\n      - \"traefik.http.routers.traefik-rtr.tls=true\"\n      - \"traefik.http.routers.traefik-rtr.tls.domains[0].main=$DOMAINNAME\"\n      - \"traefik.http.routers.traefik-rtr.tls.domains[0].sans=*.$DOMAINNAME\"\n</code></pre> <p>Before proceeding, we need to change the port 443 to 4443 and 80 to 8080 because the port 443 and 80 are already used by Traefik.</p> <p>Here is a snippet of the only thing you should modify into docker-compose file of the installation:</p> <pre><code>  # container for tactical reverse proxy\n  tactical-nginx:\n    container_name: trmm-nginx\n    image: ${IMAGE_REPO}tactical-nginx:${VERSION}\n    restart: always\n    environment:\n      APP_HOST: ${APP_HOST}\n      API_HOST: ${API_HOST}\n      MESH_HOST: ${MESH_HOST}\n      CERT_PUB_KEY: ${CERT_PUB_KEY}\n      CERT_PRIV_KEY: ${CERT_PRIV_KEY}\n    networks:\n      proxy:\n        ipv4_address: 172.20.0.20\n    ports:\n      - \"8080:8080\" ## port 8080 instead of 80\n      - \"4443:4443\" ## port 4443 instead of 443\n</code></pre> <p>Once saved, make sure you run the docker-compose or installation script at least once, so all the directory structures are created. Once you have your certificate (acme.json) generated by traefikv2 we will be able to extract it for rmm.</p> <p>Copy the acme.json create by traefik into the root of your rmm directory (In my case it's $USERDIR/docker/rmm) which you should have already defined. After that we can run this docker to extract the certificates for us:</p> <pre><code>version: \"3.7\"\nservices:\n##Copy the acme.json of Traefik2 at volumes: (userdir/docker/rmm in this case)\n  traefik-certs-dumper:\n    image: ldez/traefik-certs-dumper:v2.7.4\n    entrypoint: sh -c '\n      apk add jq\n      ; while ! [ -e /data/acme.json ]\n      || ! [ `jq \".[] | .Certificates | length\" /data/acme.json` != 0 ]; do\n      sleep 1\n      ; done\n      &amp;&amp; traefik-certs-dumper file --version v2 --watch\n      --source /data/acme.json --dest data/certs'\n    volumes:\n      - $USERDIR/docker/rmm:/data\n</code></pre> <p>Once completed, you should have 1 new folder in your rmm directory $USERDIR/docker/rmm/certs in this example. As the installation instruction, we will pass those to the .env:</p> <pre><code>echo \"CERT_PUB_KEY=$(sudo base64 -w 0 $USERDIR/docker/rmm/certs/certs/**yourdomain.com.crt**)\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 $USERDIR/docker/rmm/certs/private/**yourdomain.com.key**)\" &gt;&gt; .env\n</code></pre> <p>Next we can create 3 rules to tell Traefik to correctly route the https and agent. For that we will create 2 rules into Traefik directory as per it's configuration. folder/traefik/rules</p> <p>create:</p> <pre><code>nano app-mesh.toml\n</code></pre> <p>and inside it we add:</p> <pre><code>[http.routers]\n  [http.routers.mesh-rtr]\n      entryPoints = [\"https\"]\n      rule = \"Host(`mesh.**yourdomain.com**`)\"\n      service = \"mesh-svc\"\n##middleware with 2FA\n[http.services]\n  [http.services.mesh-svc]\n    [http.services.mesh-svc.loadBalancer]\n      passHostHeader = true\n      [[http.services.mesh-svc.loadBalancer.servers]]\n        url = \"https://**xxx.xxx.xxx.xxx**:4443\" # or whatever your external host's IP is\n</code></pre> <p>create:</p> <p><pre><code>nano app-meshagent.toml\n</code></pre> and inside it we add:</p> <pre><code>[http.routers]\n  [http.routers.mesh-rtr1]\n      entryPoints = [\"https\"]\n      rule = \"\"\"Host(`mesh.**yourdomain.com**`) &amp;&amp;\n        PathPrefix( `/agent.ashx`, `/meshrelay.ashx`, ) &amp;&amp;\n        Headers(`X-Forwarded-Proto`, `wss`) \"\"\"\n    ##Don't add middle where, the agent wont work.\n[http.services]\n  [http.services.mesh-svc1]\n    [http.services.mesh-svc.loadBalancer]\n      passHostHeader = true\n      [[http.services.mesh-svc1.loadBalancer.servers]]\n        url = \"https://**xxx.xxx.xxx.xxx**:4443\" # or whatever your external host's IP is\n</code></pre> <p>create:</p> <pre><code>nano app-rmm.toml\n</code></pre> <p>and inside it we add:</p> <pre><code>[http.routers]\n  [http.routers.rmm-rtr]\n      entryPoints = [\"https\"]\n      rule = \"Host(`rmm.**yourdomain.com**`)\"\n      service = \"rmm-svc\"\n\n      ##middleware with 2FA\n\n[http.services]\n  [http.services.rmm-svc]\n    [http.services.rmm-svc.loadBalancer]\n      passHostHeader = true\n      [[http.services.rmm-svc.loadBalancer.servers]]\n        url = \"https://xxx.xxx.xxx.xxx:4443\" # or whatever your external host's IP:port is\n</code></pre> <p>That's it, you can now restart Tactical. rmm and mesh.yourdomain.com should work, same for the agent. Please note that if you have a middleware with 2FA you can still use it with the inside mesh.toml, but do not add it with the agent.</p>"},{"location":"unsupported_proxies/#haproxy","title":"HAProxy","text":"<p>Check / change the MeshCentral config.json, some of the values may be set already. CertUrl must be changed to point to the HAProxy server if not using the same certs for both HAProxy and TRMM.</p>"},{"location":"unsupported_proxies/#meshcentral-adjustment","title":"MeshCentral Adjustment","text":"<p>Credit to @bradhawkins</p> <p>Edit MeshCentral config:</p> <pre><code>nano /meshcentral/meshcentral-data/config.json\n</code></pre> <p>Insert this (modify <code>HAProxyIP</code> to your network):</p> <pre><code>{\n  \"settings\": {\n    \"Port\": 4443,\n    \"AliasPort\": 443,\n    \"RedirPort\": 8080,\n    \"TlsOffload\": \"127.0.0.1\",\n  },\n  \"domains\": {\n    \"\": {\n      \"CertUrl\": \"https://HAProxyIP:443/\",\n    }\n  }\n}\n</code></pre> <p>Restart MeshCentral:</p> <pre><code>systemctl meshcentral restart\n</code></pre>"},{"location":"unsupported_proxies/#nginx-adjustments","title":"NGINX ADJUSTMENTS","text":"<p>You will need to edit the nginx.conf file in the http section on the trmm server to recognize the X-Forwarded-For Header that will be sent from haproxy.</p> <p>Edit file /etc/nginx/nginx.conf Add the lines from 'real_ip' module inside http tag:</p> <pre><code>set_real_ip_from    192.168.0.200; #IP Address of your haproxy server\nreal_ip_header      X-Forwarded-For;\n</code></pre> <p>Restart nginx:</p> <pre><code>systemctl restart nginx.service\n</code></pre>"},{"location":"unsupported_proxies/#haproxy-config","title":"HAProxy Config","text":"<p>The order of use_backend is important, and <code>Tactical-Mesh-WebSocket_ipvANY</code> must be before <code>Tactical-Mesh_ipvANY</code>. This assumes a standard VM install or Docker instance, unaltered. If you've altered exposed ports on your VM or Docker instance, those will need to be adjusted in the configuration. The values of <code>timeout connect</code>, <code>timeout server</code>, and <code>timeout tunnel</code> have been configured to maintain a stable agent connection, however you may need to adjust these values to suit your environment:</p> <pre><code>frontend http-to-https-shared\n      bind                  0.0.0.0:80\n      mode                  http\n      log                     global\n    option                socket-stats\n      option                  http-server-close\n    option                dontlognull\n    option            forwardfor\n    acl https ssl_fc\n    http-request set-header         X-Forwarded-Proto http if !https\n    http-request set-header         X-Forwarded-Proto https if https\n    http-request add-header         X-Real-IP %[src]\n      timeout client        30000\n    acl                   rmm       var(txn.txnhost) -m str -i rmm.example.com\n      acl                     api       var(txn.txnhost) -m str -i api.example.com\n      acl                     mesh    var(txn.txnhost) -m str -i mesh.example.com\n    http-request set-var(txn.txnhost) hdr(host)\n    http-request redirect scheme https  if  rmm\n      http-request redirect scheme https  if  api\n      http-request redirect scheme https  if  mesh\n\n\nfrontend https-shared\n      bind                  0.0.0.0:443   ssl crt-list /var/etc/haproxy/HTTPS.crt_list  #ADJUST THIS TO YOUR OWN SSL CERTIFICATES\n      mode                  http\n      log                     global\n      option                  socket-stats\n      option                  dontlognull\n      option                  http-server-close\n      option                  forwardfor\n      acl https ssl_fc\n      http-request set-header       X-Forwarded-Proto http if !https\n      http-request set-header       X-Forwarded-Proto https if https\n      timeout client        30000\n      acl               aclcrt_https_shared     var(txn.txnhost) -m reg -i ^([^\\.]*)\\.example\\.com(:([0-9]){1,5})?$\n    acl                   rmm       var(txn.txnhost) -m str -i rmm.example.com\n      acl                     nats-websocket      var(txn.txnpath) -m sub -i /natsws\n      acl                     api       var(txn.txnhost) -m str -i api.example.com\n      acl                     is_websocket    hdr(Upgrade) -i WebSocket\n      acl                     mesh    var(txn.txnhost) -m str -i mesh.example.com\n      acl                     api-ws      var(txn.txnhost) -m sub -i api.example.com\n    http-request set-var(txn.txnhost) hdr(host)\n    http-request set-var(txn.txnpath) path\n    use_backend rmm.example.com_ipvANY  if  rmm\n    use_backend rmm.example.com-websocket_ipvANY  if  nats-websocket api-ws\n    use_backend rmm.example.com_ipvANY  if  api\n    use_backend mesh.example.com-websocket_ipvANY  if  is_websocket mesh\n    use_backend mesh.example.com_ipvANY  if  mesh\n\n\nbackend rmm.example.com_ipvANY\n      mode                  http\n      log                     global\n      timeout connect       30000\n      timeout server        30000\n      retries                 3\n      http-request add-header X-Forwarded-Host %[req.hdr(Host)]\n      http-request add-header X-Forwarded-Proto https\n      server                  rmm x.x.x.x:443 ssl  verify none\n\nbackend rmm.example.com-websocket_ipvANY\n      mode                  http\n      log                     global\n      timeout connect       30000\n      timeout server        30000\n      retries                 3\n      timeout tunnel    3600000\n      http-request add-header X-Forwarded-Host %[req.hdr(Host)]\n      http-request add-header X-Forwarded-Proto https\n      server                  rmm-websocket x.x.x.x:443 ssl  verify none\n\nbackend mesh.example.com-websocket_ipvANY\n      mode                  http\n      log                     global\n      timeout connect       3000\n      timeout server        3000\n      retries                 3\n      timeout tunnel    3600000\n      http-request add-header X-Forwarded-Host %[req.hdr(Host)]\n      http-request add-header X-Forwarded-Proto https\n      server                  mesh-websocket x.x.x.x:443 ssl  verify none\n\nbackend mesh.example.com_ipvANY\n      mode                  http\n      log                     global\n      timeout connect       15000\n      timeout server        15000\n      retries                 3\n      timeout tunnel    15000\n      http-request add-header X-Forwarded-Host %[req.hdr(Host)]\n      http-request add-header X-Forwarded-Proto https\n      server                  mesh x.x.x.x:443 ssl  verify none\n</code></pre>"},{"location":"unsupported_proxies/#haproxy-how-to-for-pfsense","title":"HAProxy How-to for pfSense","text":"<p>https://github.com/ninjamonkey198206/T-RMM-PFSense-HAProxy-config</p>"},{"location":"unsupported_proxies/#haproxy-how-to-for-baremetal","title":"HAProxy How-to for Baremetal","text":"<p>https://github.com/ninjamonkey198206/T-RMM-Baremetal-HAProxy</p>"},{"location":"unsupported_proxies/#haproxy-in-tcp-mode-pfsense","title":"HAProxy in TCP Mode, pfSense","text":"<p>In this scenario, you install TRMM as per documentation. Meaning your certificates are generated and managed on your TRMM server, just use the <code>install.sh</code> and follow docs and on-screen instructions.</p> <p>HAProxy here will just pass the traffic to the NGINX on TRMM server. No certificate management. Only use this method if you have more than 1 server that need to use port 443 on the same public IP.</p>"},{"location":"unsupported_proxies/#assumptions","title":"Assumptions","text":"<p>These are some assumptions made to make this guide, short, easy to follow and to the point. Of course you can adapt it to your environment and/or current configuration.</p> <ul> <li>You have a pfSense firewall.</li> <li>You have HAProxy installed.</li> <li>You don't have any <code>http</code> frontends on your HAProxy.</li> <li>You have firewall rule to allow traffic from your WAN to HAProxy 443 port.</li> <li>You have set Max Connections on Settings to a value MORE than the agents you plan to connect.</li> <li>Your subdomains are: <code>api</code>, <code>mesh</code>, <code>rmm</code></li> <li>You can resolve <code>(rmm|api|mesh).example.com</code> to your local TRMM server when in your local network.</li> <li>You can resolve <code>(rmm|api|mesh).example.com</code> to your public IP when you are outside of your local network.</li> </ul>"},{"location":"unsupported_proxies/#global-settings","title":"Global Settings","text":"<p>Config file format, for reference:</p> <pre><code>global\n  maxconn     50000\n  stats socket /tmp/haproxy.socket level admin  expose-fd listeners\n  gid     80\n  nbproc      1\n  nbthread      1\n  hard-stop-after   15m\n  chroot        /tmp/haproxy_chroot\n  daemon\n  tune.ssl.default-dh-param 2048\n  server-state-file /tmp/haproxy_server_state\n</code></pre>"},{"location":"unsupported_proxies/#values-you-will-have-to-replace-with-your-own","title":"Values you will have to replace with your own","text":"<ul> <li>10.10.10.100 - Change with your TRMM local IP.</li> <li>example.com - Change with your domain.</li> </ul>"},{"location":"unsupported_proxies/#backend","title":"Backend","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Backend</code></p> <ul> <li>Click \u2935\ufe0fAdd</li> </ul>"},{"location":"unsupported_proxies/#backend-server-pool","title":"Backend server pool","text":"<ul> <li>Name: <code>trmm-backend</code></li> <li>On Server list, Click \u2935\ufe0f</li> <li>Name: <code>trmm-server</code></li> <li>Forwardto: <code>Address+Port</code></li> <li>Address: <code>10.10.10.100</code> (Reminder: change this)</li> <li>Port: <code>443</code></li> <li>Max conn: <code>10000</code> (Or <code>0</code> for unlimited)</li> </ul>"},{"location":"unsupported_proxies/#timeout-retry-settings","title":"Timeout / retry settings","text":"<ul> <li>Connection timeout: <code>300000</code> (Note: it has more 0s than the default)</li> <li>Server timeout: <code>300000</code> (Note: it has more 0s than the default)</li> <li>Retries: <code>3</code></li> </ul>"},{"location":"unsupported_proxies/#health-checking","title":"Health checking","text":"<ul> <li>Health check method: <code>SSL</code></li> </ul> <p>Keep this to <code>none</code> while installing or updating certificates. There might be problems if it's set to <code>SSL</code> or <code>basic</code> while doing so.</p> <p></p>"},{"location":"unsupported_proxies/#advanced-settings","title":"Advanced settings","text":"<p>Please read the warning there, and the note at the bottom. This optional and it's use is to show the real public IP of the agent.</p> <ul> <li>Check `Use Client-IP to connect to backend servers.</li> </ul> <p>Some remote agents would not let me do RDP without this option. Play with it and see what works for you.</p> <p></p> <p>It works well for me, there are cases that it might not work on all environments.</p>"},{"location":"unsupported_proxies/#for-those-who-like-the-config-files","title":"For those who like the config files","text":"<pre><code>backend trmm-backend_ipv4\n  mode    tcp\n  log     global\n  timeout connect   300000\n  timeout server    300000\n  retries     3\n  source ipv4@ usesrc clientip\n  option      ssl-hello-chk\n  server      trmm-server 10.10.10.100:443 check inter 1000  maxconn 10000\n</code></pre>"},{"location":"unsupported_proxies/#frontend","title":"Frontend","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Frontend</code></p> <ul> <li>Click \u2935\ufe0fAdd</li> </ul>"},{"location":"unsupported_proxies/#edit-haproxy-frontend","title":"Edit HAProxy Frontend","text":"<ul> <li>Name: <code>FrontendTCP</code></li> <li>Status: <code>Active</code></li> <li>On External address, click \u2935\ufe0f</li> <li>Listen address: <code>WAN address (IPv4)</code></li> <li>Port: <code>443</code></li> <li>Max connections: <code>10000</code> (Or <code>0</code> or unlimited`)</li> <li>Type: <code>ssl/https (TCP mode)</code></li> </ul>"},{"location":"unsupported_proxies/#default-backend-access-control-lists-and-actions","title":"Default backend, access control lists and actions","text":"<ul> <li>On Access Control lists, Click \u2935\ufe0f</li> <li>Name: <code>tactical</code></li> <li>Expression <code>Server Name Indication TLS extension regex:</code></li> <li>value: <code>(rmm|api|mesh)\\.example\\.com</code></li> <li>On Actions, Click \u2935\ufe0f</li> <li>Action: <code>Use Backend</code></li> <li>Condition acl names: <code>tactical</code></li> <li>backend: <code>trmm-backend</code></li> </ul>"},{"location":"unsupported_proxies/#advanced-settings_1","title":"Advanced settings","text":"<ul> <li>Client timeout: <code>300000</code> (Note: it has more 0s than the default)</li> <li>Use \"httpclose\" option: <code>http-server-close</code></li> </ul> <p>Click \ud83d\udcbeSave Click \u2714\ufe0fApply Changes</p>"},{"location":"unsupported_proxies/#for-those-who-like-the-config-files_1","title":"For those who like the config files","text":"<pre><code>frontend Frontend-SNI\n  bind      YOURWANIP:443 name YOURWANIP:443\n  mode      tcp\n  log     global\n  maxconn     10000\n  timeout client    300000\n  tcp-request inspect-delay 5s\n  acl     tactical  req.ssl_sni -m reg -i (rmm|mesh|api)\\.yourdomain\\.com\n  tcp-request content accept if { req.ssl_hello_type 1 }\n  use_backend tactical_ipv4  if  trmm-backend\n</code></pre>"},{"location":"unsupported_proxies/#haproxy-in-tcp-mode-opnsense","title":"HAProxy in TCP Mode, OPNsense","text":"<p>In this scenario, you install TRMM as per documentation. Meaning your certificates are generated and managed on your TRMM server, just use the <code>install.sh</code> and follow docs and on-screen instructions.</p> <p>HAProxy here will just pass the traffic to the NGINX on TRMM server. No certificate management. Only use this method if you have more than 1 server that need to use port 443 on the same public IP.</p>"},{"location":"unsupported_proxies/#assumptions_1","title":"Assumptions","text":"<p>These are some assumptions made to make this guide, short, easy to follow and to the point. Of course you can adapt it to your environment and/or current configuration.</p> <ul> <li>You have a OPNsense firewall.</li> <li>You have HAProxy installed.</li> <li>You don't have any <code>http</code> frontends on your HAProxy.</li> <li>You have port forward to forward traffic from your WAN 443 port to OPNsense 443 port.</li> <li>You have firewall rule to allow traffic from your WAN to HAProxy 443 port.</li> <li>Your subdomains are: <code>api</code>, <code>mesh</code>, <code>rmm</code></li> <li>You can resolve <code>(rmm|api|mesh).example.com</code> to your local TRMM server when in your local network.</li> <li>You can resolve <code>(rmm|api|mesh).example.com</code> to your public IP when you are outside of your local network.</li> </ul> <p>If you notice agents are continue to timeout after 60second (default ping time of MeshAgent). Check <code>Settings</code> &gt; <code>HAProxy</code> &gt; <code>Config Export</code>. Some backend or frontend still has a lower than <code>60s</code> timeout. Increase it for example to <code>120s</code>.</p>"},{"location":"unsupported_proxies/#settings","title":"Settings","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Settings</code></p>"},{"location":"unsupported_proxies/#service","title":"Service","text":"<ul> <li>Click \ud83d\udd3d next to <code>Settings</code> tab.</li> <li>Click <code>Service</code></li> <li>Check <code>Enable HAProxy</code></li> </ul> <ul> <li>Click <code>Apply</code></li> <li>Check that HAProxy started (You should see a green \u25b6\ufe0f on the top right corner)</li> </ul>"},{"location":"unsupported_proxies/#global-parameters","title":"Global Parameters","text":"<ul> <li>Click \ud83d\udd3d next to <code>Settings</code> tab.</li> <li>Click <code>Global Parameters</code></li> <li>Maximum connections: Set this to a number of at least 3 times your agents.</li> </ul> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#default-parameters","title":"Default Parameters","text":"<ul> <li>Click \ud83d\udd3d next to <code>Settings</code> tab.</li> <li>Click <code>Default Parameters</code></li> <li>Maximum connections (Public Services): Set this to a number of at least 3 times your agents.</li> <li>Maximum connections (Servers): Set this to a number of at least 3 times your agents.</li> <li>Client Timeout: <code>120s</code></li> <li>Connection Timeout: <code>120s</code></li> <li>Retries: <code>3</code></li> </ul> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#real-servers","title":"Real Servers","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Settings</code></p> <ul> <li>Click \ud83d\udd3d next to <code>Real Servers</code> tab.</li> <li>Click <code>Real Servers</code></li> <li>Click \u2795</li> <li>Name: <code>Tactical</code></li> <li>Type: <code>static</code></li> <li>FQDN or IP: (Your Tactical RMM VM IP or FQDN)</li> <li>Port: <code>443</code></li> <li>Mode: <code>active</code></li> <li>SSL: <code>Unchecked</code></li> <li>SSL SNI: (Empty)</li> <li>Verify SSL Certificate: <code>Unchecked</code></li> <li>Click <code>Save</code></li> </ul> <p></p> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#virtual-services-backend-pools","title":"Virtual Services - Backend Pools","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Settings</code></p> <ul> <li>Click \ud83d\udd3d next to <code>Virtual Services</code> tab.</li> <li>Click <code>Backend Pools</code></li> <li>Click \u2795</li> <li>Name: <code>Tactical</code></li> <li>Description: <code>Tactical Server Pool</code></li> <li>Mode: <code>TCP (Layer 4)</code></li> <li>Health Checking: <code>Unchecked</code></li> <li>Retries: <code>3</code></li> <li>Click <code>Save</code></li> </ul> <p></p> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#rules-checks","title":"Rules &amp; Checks","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Settings</code></p>"},{"location":"unsupported_proxies/#conditions","title":"Conditions","text":"<ul> <li>Click \ud83d\udd3d next to <code>Rules &amp; Checks</code> tab.</li> <li>Click <code>Conditions</code></li> <li>Click \u2795</li> <li>Name: <code>Contains SSL Hello Message</code></li> <li>Condition type: <code>Custom condition (option pass-through)</code></li> <li>Option pass-through: <code>req.ssl_hello_type 1</code></li> <li>Click <code>Save</code></li> </ul> <ul> <li>Click \u2795</li> <li>Name: <code>SNI Tactical</code></li> <li>Description: <code>SNI Match tactical subdomains</code></li> <li>Condition Type: <code>SNI TLS extension regex (TCP Request content inspection)</code></li> <li>SNI Regex: <code>(api|tactical|mesh)\\.yourdomain\\.com</code></li> <li>Click <code>Save</code></li> </ul> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#rules","title":"Rules","text":"<ul> <li>Click \ud83d\udd3d next to <code>Rules &amp; Checks</code> tab.</li> <li>Click <code>Rules</code></li> <li>Click \u2795</li> <li>Name: <code>Accept Content if Contains SSL Hello</code></li> <li>Select conditions: <code>Contains SSL Hello Message</code></li> <li>Execute function: <code>tcp-request content accept</code></li> <li>Click <code>Save</code></li> </ul> <ul> <li>Click \u2795</li> <li>Name: <code>TCP Inspect Delay</code></li> <li>Select conditions: <code>Nothing Selected</code></li> <li>Execute function: <code>tcp-request inspect-delay</code></li> <li>TCP inspection delay: <code>5s</code></li> <li>Click <code>Save</code></li> </ul> <ul> <li>Click \u2795</li> <li>Name: <code>Tactical RMM</code></li> <li>Select conditions: <code>SNI Tactical</code></li> <li>Execute function: <code>Use specified Backend Pool</code></li> <li>Use specified Backend Pool: <code>Tactical</code></li> <li>Click <code>Save</code></li> </ul> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#virtual-services-public-services","title":"Virtual Services - Public Services","text":"<p>Navigate to <code>Services</code> -&gt; <code>HAProxy</code> -&gt; <code>Settings</code></p> <ul> <li>Click \ud83d\udd3d next to <code>Virtual Services</code> tab.</li> <li>Click <code>Public Services</code></li> <li>Click \u2795</li> <li>Name: <code>Frontend</code></li> <li>Listen Addresses: <code>127.0.0.1:443</code> (Remember, you have to have port forward + allow rule)</li> <li>Type: <code>SSL / HTTPS (TCP Mode)</code></li> <li>Default Backend Pool: <code>none</code></li> <li>SSL Offloading: <code>Unchecked</code></li> <li>Maximum Connections: (Set this to a number of at least 3 times your agents.)</li> <li>Select Rules:</li> <li><code>Accept Content if Contains SSL Hello</code></li> <li><code>TCP Inspect Delay</code></li> <li><code>Tactical RMM</code></li> <li>Click <code>Save</code></li> </ul> <p>Note: Order on Rules matter!</p> <p></p> <ul> <li>Click <code>Apply</code></li> </ul>"},{"location":"unsupported_proxies/#apache-proxy","title":"Apache Proxy","text":"<p>HowTo - Proxy on Apache</p>"},{"location":"unsupported_proxies/#trmm-server","title":"TRMM SERVER","text":"<p>Edit file /etc/nginx/sites-enabled/rmm.conf Add the lines from 'real_ip' module inside server tag:</p> <pre><code>set_real_ip_from    192.168.0.200; #IP Address of your apache proxy\nreal_ip_header      X-Forwarded-For;\n</code></pre> <p>Restart nginx:</p> <pre><code>systemctl restart nginx.service\n</code></pre>"},{"location":"unsupported_proxies/#apache","title":"APACHE","text":"<p>Enable ssl proxy and rewriteEngine. Set proxy to preserve host. Set upgrade rule to websocket. Set proxypass rules redirecting to rmm location.</p> <p>Apache ssl config example:</p> <pre><code>&lt;VirtualHost *:443&gt;\n\n    ServerName rmm.blablabla.com.br:443\n    ServerAlias mesh.blablabla.com.br:443 api.blablabla.com.br:443\n    SSLEngine on\n\n    SSLCertificateFile \"C:/Apache24/conf/ssl-rmm.blablabla.com.br/_.blablabla.com.br-chain.pem\"\n    SSLCertificateKeyFile \"C:/Apache24/conf/ssl-rmm.blablabla.com.br/_.blablabla.com.br-key.pem\"\n\n    SSLProxyEngine on\n\n    RewriteEngine On\n    ProxyPreserveHost On\n\n    # When Upgrade:websocket header is present, redirect to ws\n    # Using NC flag (case-insensitive) as some browsers will pass Websocket\n    RewriteCond %{HTTP:Upgrade} =websocket [NC]\n    RewriteRule ^/(.*)    wss://192.168.0.212/$1 [P,L]\n\n    ProxyPass \"/\"  \"https://192.168.0..212/\" retry=3\n    ProxyPassReverse \"/\"  \"https://192.168.0.212/\" retry=3\n\n    BrowserMatch \"MSIE [2-5]\" \\\n            nokeepalive ssl-unclean-shutdown \\\n            downgrade-1.0 force-response-1.0\n\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"unsupported_proxies/#nginx-proxy-manager-double-proxy-method","title":"Nginx Proxy Manager (double proxy method)","text":"<p>First, get your TRMM server installed with a standard config and working.</p> <p>Then in NPM, declare the hosts with the parameters:</p> <pre><code>api.{domain}\nhttps | TRMM server DNS name | 443\nON: Cache Assets | Block Common Exploits | Websockets Support\n\nmesh.{domain}\nhttps | TRMM server DNS name | 443\nON: Block Common Exploits | Websockets Support\nAdvanced:\nproxy_set_header Host $host;\nproxy_set_header CF-Connecting-IP $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Host $host:$server_port;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $scheme;\n\nrmm.{domain}\nhttps | TRMM server DNS name | 443\nON: Cache Assets | Block Common Exploits | Websockets Support\n</code></pre> <p></p> <p>Last thing you have to do, is setup the same certs on NPM and TRMM.</p> <p>TRMM cert location: <code>/etc/letsencrypt/live/{yourdomain}/</code></p> <p>NPM cert location: SSL Certificates tab</p> <p>Either: Setup SSL certs on NPM (optionally using Cloudflare API). Download and copy certs to TRMM. Then run <code>./update.sh --force</code></p> <p>OR: Run standard TRMM cert renew process using certbot. Then copy the files and upload: Certificate Key (<code>privkey.pem</code>), Certificate (<code>cert.pem</code>), and Intermediate Certificate (<code>chain.pem</code>)</p>"},{"location":"unsupported_proxies/#nginx-proxy-manager-alt-method","title":"Nginx Proxy Manager Alt Method","text":"<p>Note</p> <p>Tested and working on the following: \u2705 TRMM hosted on Ubuntu 22.04 via Proxmox VM \u2705 Nginx Proxy Manager hosted on Debian 11 via Proxmox CT W/ Docker</p> <p>We'll use \"YOURDOMAIN\" in place of your actual domain name</p>"},{"location":"unsupported_proxies/#step-1-install-and-test-trmm-with-no-proxy","title":"Step 1 - Install and test TRMM with no proxy","text":"<p>First and foremost, you need to disable Nginx Proxy Manager. To do this, on your routers firewall settings, forward ports 443 and 80 to the local ip that will be running your TRMM instance. This is only temporary as we want to make sure we can get TRMM installed and running with a STANDARD install FIRST. You will also need to make sure the following subdomains are pointing to your external IP:</p> <p>api.YOURDOMAIN.com</p> <p>rmm.YOURDOMAIN.com</p> <p>mesh.YOURDOMAIN.com</p> <p>Use <code>curl icanhazip.com</code> to pull your external IP if you don't know it.</p> <p>Once you have ports 443 and 80 forwarded correctly, go ahead and run a STANDARD install of TRMM on a FRESH machine. You can find the Install Documentation here.</p>"},{"location":"unsupported_proxies/#step-2-nginx-proxy-manager-proxy-host-configuration","title":"Step 2 - Nginx Proxy Manager Proxy Host Configuration","text":"<p>Assuming you installed TRMM properly and all of its features are working correctly, we will now get into setting up Nginx Proxy Manager to work with TRMM. Go ahead and forward ports 443 and 80 back to your Nginx Proxy Manager instance.</p> <p>Below you will find the 3 different Proxy Hosts you need to create on Nginx Proxy Manager.</p>"},{"location":"unsupported_proxies/#api-domain","title":"\"API\" Domain","text":"<p>Details Tab:</p> <p>Domain Name: --&gt; api.YOURDOMAIN.com</p> <p>Scheme: --&gt; https</p> <p>Forward Hostname / IP: --&gt; The Local IP of your TRMM instance. ie: 192.168.1.155</p> <p>Forward Port: --&gt; 443</p> <p>Enabled Options:</p> <pre><code>Cache Assets;\nBlock Common Exploits;\nWebsockets Support\n</code></pre> <p>Access List: --&gt; Publicly Accessible</p>"},{"location":"unsupported_proxies/#mesh-domain","title":"\"MESH\" Domain","text":"<p>Details Tab:</p> <p>Domain Name: --&gt; mesh.YOURDOMAIN.com</p> <p>Scheme: --&gt; http</p> <p>Forward Hostname / IP: --&gt; The Local IP of your TRMM instance. ie: 192.168.1.155</p> <p>Forward Port: --&gt; 4430</p> <p>Enabled Options:</p> <pre><code>Block Common Exploits;\nWebsockets Support\n</code></pre> <p>Access List: --&gt; Publicly Accessible</p> <p>Advanced Tab:</p> <p>Custom Nginx Configuration</p> <pre><code>proxy_set_header Host $host;\nproxy_set_header CF-Connecting-IP $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Host $host:$server_port;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $scheme;\n</code></pre>"},{"location":"unsupported_proxies/#rmm-domain","title":"\"RMM\" Domain","text":"<p>Details Tab:</p> <p>Domain Name: --&gt; rmm.YOURDOMAIN.com</p> <p>Scheme: --&gt; https</p> <p>Forward Hostname / IP: --&gt; The Local IP of your TRMM instance. ie: 192.168.1.155</p> <p>Forward Port: --&gt; 443</p> <p>Enabled Options:</p> <pre><code>Cache Assets;\nBlock Common Exploits;\nWebsockets Support\n</code></pre> <p>Access List: --&gt; Publicly Accessible</p>"},{"location":"unsupported_proxies/#npm-ssl-configuration","title":"NPM SSL Configuration","text":"<p>In order for TRMM to work properly with NPM, you'll need to create a wildcard or multi-domain SSL Certificate.</p> <p>To do this, on the Nginx Proxy Manager Dashboard, click the SSL Certificates tab.</p> <p></p> <p>Now in the top right, click \"Add SSL Certificate\". Select \"Let's Encrypt\".</p> <p></p> <p>Add each of the domains listed above to the \"Domain Names\" field. Make sure you add them 1 at a time and click the dropdown of the domain to add it. Once you've added all 3 domains, enable the \"I agree\" tick and click save.</p> <p>You should now see something like this in your list of SSL Certs:</p> <p></p> <p>Go ahead and download this certificate by clicking the 3 dots to the right of the cert entry and click \"Download\".</p>"},{"location":"unsupported_proxies/#meshcentral-configuration","title":"MeshCentral Configuration","text":"<p>Now you should have Nginx Proxy Manager completely setup. Lets move on to the MeshCentral Configuration.</p> <p>First, cd to <code>/meshcentral/meshcentral-data</code></p> <p>Now edit the file named <code>config.json</code>.</p> <p>Make sure your config file looks like the one shown below.</p> <pre><code>{\n  \"settings\": {\n    \"cert\": \"mesh.YOURDOMAIN.com\",\n    ....\n    \"tlsOffload\": \"Nginx Proxy Manager Local IP\",\n    \"trustedProxy\": \"Nginx Proxy Manager Local IP\",\n    ....\n  },\n  \"domains\": {\n    \"\": {\n      ....\n      \"certUrl\": \"https://mesh.YOURDOMAIN.com:443/\",\n      ....\n    }\n  }\n}\n</code></pre> <p>If you want to enable logging in case anything goes wrong during this process, follow the instructions here.</p> <p>As of now, everything should be working. If you have any issues, feel free to join the discord.</p> <p>Keep in mind, this is considered an UNSUPPORTED installation. Developers are not obligated to fix any issues you may encounter. Good luck.</p>"},{"location":"unsupported_proxies/#synology-nas-reverse-proxy-portal","title":"Synology NAS Reverse Proxy Portal","text":"<p>Follow HAProxy</p> <p>And set the \"CertUrl\" to point to the IP address of my NAS that was running the reserve proxy and had the certificates installed.</p> <p>In Synology NAS reverse proxy portal and added websockets to the rmm domains, especially the mesh domain under custom headers, by just clicking the create button and choosing WebSocket:</p> <p></p> <p></p>"},{"location":"unsupported_scripts/","title":"Unsupported Reference Scripts","text":"<p>Note</p> <p>These are not supported scripts/configurations by Tactical RMM, but it's provided here for your reference.</p> <p>Although these aren't officially supported configurations, we generally will help point you in the right direction. Please use the Discord #unsupported channel to discuss issues related to these complex installations.</p>"},{"location":"unsupported_scripts/#fail2ban","title":"Fail2ban","text":"<p>Install fail2ban</p> <p><pre><code>sudo apt install -y fail2ban python3-systemd\n</code></pre> There is a known issue on Debian 12 where fail2ban doesnt start, if its not running (check with <code>systemctl status fail2ban</code>) if its not please check <code>/etc/fail2ban/jail.local</code> exists, if it doesn't, do the following:</p> <p><pre><code>echo -e \"[sshd]\\nbackend=systemd\\nenabled=true\" | sudo tee /etc/fail2ban/jail.local\n</code></pre> Set Tactical fail2ban filter conf file</p> <pre><code>tacticalfail2banfilter=\"$(cat &lt;&lt; EOF\n[Definition]\nfailregex = ^&lt;HOST&gt;.*400.17.*$\nignoreregex = ^&lt;HOST&gt;.*200.\\d+.*$\nEOF\n)\"\nsudo echo \"${tacticalfail2banfilter}\" &gt; /etc/fail2ban/filter.d/tacticalrmm.conf\n</code></pre> <p>Set Tactical fail2ban jail conf file</p> <p><pre><code>tacticalfail2banjail=\"$(cat &lt;&lt; EOF\n[tacticalrmm]\nenabled = true\nport = 80,443\nfilter = tacticalrmm\naction = iptables-allports[name=tactical]\nlogpath = /rmm/api/tacticalrmm/tacticalrmm/private/log/access.log\nmaxretry = 3\nbantime = 14400\nfindtime = 14400\nEOF\n)\"\nsudo echo \"${tacticalfail2banjail}\" &gt; /etc/fail2ban/jail.d/tacticalrmm.local\n</code></pre> Restart fail2ban</p> <pre><code>sudo systemctl restart fail2ban.service\n</code></pre>"},{"location":"unsupported_scripts/#using-your-own-certs-with-docker","title":"Using your own certs with Docker","text":"<p>If you are providing your own publicly signed certificates, ensure you download the full chain (combined CA/Root + Intermediary) certificate in pem format. If certificates are not provided, a self-signed certificate will be generated and most agent functions won't work.</p>"},{"location":"unsupported_scripts/#restricting-access-to-rmmexamplecom","title":"Restricting Access to rmm.EXAMPLE.COM","text":"<p>Limit access to Tactical RMM's administration panel in Nginx to specific locations:</p>"},{"location":"unsupported_scripts/#using-dns","title":"Using DNS","text":"<p>Create a file allowed-domain.list which contains the DNS names you want to grant access to your rmm:</p> <p>Edit <code>/etc/nginx/allowed-domain.list</code> and add:</p> <pre><code>nom1.dyndns.tv\nnom2.dyndns.tv\n</code></pre> <p>Create a bash script domain-resolver.sh which does the DNS lookups for you:</p> <p>Edit <code>/etc/nginx/domain-resolver.sh</code></p> <pre><code>#!/usr/bin/env bash\nfilename=\"$1\"\nwhile read -r line\ndo\n    ddns_record=\"$line\"\n    if [[ !  -z  $ddns_record ]]; then\n        resolved_ip=$( getent ahosts $line | awk '{ print $1 ; exit }' )\n        if [[ !  -z  $resolved_ip ]]; then\n            echo \"allow $resolved_ip;# from $ddns_record\"\n        fi\n    fi\ndone &lt; \"$filename\"\n</code></pre> <p>Give the right permission to this script <code>chmod +x /etc/nginx/domain-resolver.sh</code></p> <p>Add a cron job which produces a valid Nginx configuration and restarts Nginx:</p> <p><code>/etc/cron.hourly/domain-resolver</code></p> <pre><code>#!/usr/bin/env bash\n/etc/nginx/domain-resolver.sh /etc/nginx/allowed-domain.list &gt; /etc/nginx//allowed-ips-from-domains.conf\nservice nginx reload &gt; /dev/null 2&gt;&amp;1\n</code></pre> <p>This can be a hourly, daily, or monthly job or you can have it run at a specific time. </p> <p>Give the right permission to this script <code>chmod +x /etc/cron.hourly/domain-resolver</code></p> <p>When run it will give something like this:</p> <p>Edit <code>/etc/nginx//allowed-ips-from-domains.conf</code></p> <pre><code>allow xxx.xxx.xxx.xxx;# from maison.nom1.dyndns.tv\nallow xxx.xxx.xxx.xxx;# from maison.nom2.dyndns.tv\n</code></pre> <p>Update your Nginx's configuration to take this output into account:</p> <p>Edit <code>/etc/nginx/sites-enabled/frontend.conf</code></p> <pre><code>server {\n    ....\n    include /etc/nginx/allowed-ips-from-domains.conf;\n    deny all;\n    listen 443 ssl;\n    ....\n}\n</code></pre>"},{"location":"unsupported_scripts/#using-a-fixed-ip","title":"Using a fixed IP","text":"<p>Create a file containg the fixed IP address (where xxx.xxx.xxx.xxx must be replaced by your real IP address):</p> <p>Edit <code>/etc/nginx/allowed-ips.conf</code></p> <pre><code># Private IP address\nallow 192.168.0.0/16;\nallow 172.16.0.0/12;\nallow 10.0.0.0/8;\n# Public fixed IP address\nallow xxx.xxx.xxx.xxx\n</code></pre> <p>Update your Nginx configuration to take this output into account.</p> <p>Edit <code>/etc/nginx/sites-enabled/frontend.conf</code></p> <pre><code>server {\n    ....\n    include /etc/nginx/allowed-ips.conf;\n    deny all;\n    ....\n}\n</code></pre>"},{"location":"unsupported_scripts/#automating-ssl-with-cloudflare","title":"Automating SSL with Cloudflare","text":"<p>Use Cloudflare API with certbot</p> <p>https://www.bjornjohansen.com/wildcard-certificate-letsencrypt-cloudflare</p> <p>You need to restart mesh and nginx for changes to take effect</p>"},{"location":"unsupported_synology_docker_install/","title":"Installing on Synology NAS using docker install","text":""},{"location":"unsupported_synology_docker_install/#docker-setup","title":"Docker Setup","text":"<p>Docker installs are currently unsupported, as is trying to help someone get it working on their own Synology NAS... But here's how you do it!</p> <ul> <li>Follow the standard docker install documentation.</li> <li>Once the <code>docker-compose</code> file is downloaded, edit it and modify the ports used by the Nginx server to custom ports (<code>13180</code> and <code>13443</code> in the example below):</li> </ul> <p></p>"},{"location":"unsupported_synology_docker_install/#setup-the-reverse-proxy","title":"Setup the reverse proxy","text":"<p>Go to Login Portal &gt; Advanced &gt; Reverse Proxy in the Control Panel.</p> <p>Create 2 entries for each tactical DNS entries, one for the HTTP port &amp; one for the HTTPS:</p> <p></p> <p>For the entries related to Mesh, add some custom headers and adjust the proxy timeout connection:</p> <p></p> <p></p>"},{"location":"unsupported_synology_docker_install/#bonus-ssl-certificate","title":"Bonus: SSL Certificate","text":"<p>In regards to the certificate, I followed this tutorial (in french but still clear after translation) to automatically update it and manually updating it on the NAS and in TRMM:</p> <pre><code>docker exec Acme sh -c \"acme.sh --issue --keylength 4096 -d '*.EXAMPLE.COM' --dns dns_provider\"\nsed -i '/CERT_PUB_KEY/d' /path/to/tactical/.env\nsed -i '/CERT_PRIV_KEY/d' /path/to/tactical/.env\necho \"CERT_PUB_KEY=$(sudo base64 -w 0 /volume1/docker/acme/\\*.EXAMPLE.COM/fullchain.cer)\" &gt;&gt; /path/to/tactical/.env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 /volume1/docker/acme/\\*.EXAMPLE.COM/*.whitesnew.com.key)\" &gt;&gt; /path/to/tactical/.env\ndocker exec Acme sh -c \"acme.sh --deploy -d '*.EXAMPLE.COM' --deploy-hook synology_provider\"\ndocker-compose -f /path/to/tactical/docker-compose.yml restart\n</code></pre>"},{"location":"update_agents/","title":"Updating Agents","text":"<p>Warning</p> <p>The agent's version is directly tied to the RMM's version. For example, as of May 2023 RMM version 0.15.9 is compatible with agent version 2.4.6 and lower. You should never attempt to manually update an agent to a newer version without first making sure your RMM is on the latest version.</p>"},{"location":"update_agents/#updating-from-the-web-ui","title":"Updating from the Web UI","text":"<p>Agents will automatically self-update themselves if you have auto self-update enabled in Settings &gt; Global Settings.</p> <p></p> <p>There is a background job that runs every hour, at 35 minutes past the hour and sends any online agents an update command if it detects they are on an older version.</p> <p>You can also trigger this background job to run on demand by clicking Agents &gt; Update Agents in the web UI:</p> <p></p> <p>You can individually choose which agents to update, or simply Select All.</p> <p>The RMM will automatically skip any agents that don't need updating.</p> <p>You can trigger this manual agent update anytime you want. It is safe to spam, and won't run if an agent update task is already running.</p> <p>It will also make sure agents update to the correct version, in case they are an older version that cannot be directly upgraded to the latest version.</p> <p>For example, agents older than version 1.3.0 must first be updated to 1.3.0 before they can go any further.</p>"},{"location":"update_agents/#manually-updating-from-the-command-line-on-the-agent","title":"Manually updating from the command line on the agent","text":"<p>You should never need to do this but might be needed to troubleshoot agents that are not updating automatically.</p> <p>Download the <code>tacticalagent-vX.X.X.exe</code> installer from the link generated by the Manual install method and place it somewhere on the filesystem.</p> <p>Open CMD as admin and call the exe like so:</p> <pre><code>tacticalagent-vX.X.X.exe /VERYSILENT /LOG=agentupdate.txt\n</code></pre> <p>This command will return immediately since it spawns a background process to run the update. The agent will take around 30 seconds to fully update.</p> <p>You can check the <code>agentupdate.txt</code> log file that is created for troubleshooting.</p>"},{"location":"update_docker/","title":"Updating the RMM (Docker)","text":""},{"location":"update_docker/#updating-to-the-latest-rmm-version","title":"Updating to the latest RMM version","text":"<p>Question</p> <p>You have a backup, right? RIGHT?!</p> <p>Tactical RMM updates the docker images on every release and should be available within a few minutes.</p> <p>SSH into your server as a user that is in the docker group and run the below commands:</p> <pre><code>cd [dir/with/compose/file]\nmv docker-compose.yml docker-compose.yml.old\nwget https://raw.githubusercontent.com/amidaware/tacticalrmm/master/docker/docker-compose.yml\ndocker compose pull\ndocker compose down\ndocker compose up -d --remove-orphans\n</code></pre> <p>If your user isn't in the docker group you can add yourself to the group with:</p> <p><pre><code>sudo usermod -aG docker [user]\n</code></pre> Keep in mind that you will most likely need to log out and then back in</p>"},{"location":"update_docker/#keeping-your-lets-encrypt-certificate-up-to-date","title":"Keeping your Let's Encrypt certificate up to date","text":"<p>To renew your Let's Encrypt wildcard cert, run the following command, replacing <code>example.com</code> with your domain and <code>admin@example.com</code> with your email:</p> <pre><code>sudo certbot certonly --manual -d *.example.com --agree-tos --no-bootstrap --manual-public-ip-logging-ok --preferred-challenges dns -m admin@example.com --no-eff-email\n</code></pre> <p>Verify the domain with the TXT record. Once issued, run the below commands to base64 encode the certificates and add them to the .env file.</p> <pre><code>echo \"CERT_PUB_KEY=$(sudo base64 -w 0 /etc/letsencrypt/live/${rootdomain}/fullchain.pem)\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 /etc/letsencrypt/live/${rootdomain}/privkey.pem)\" &gt;&gt; .env\n</code></pre> <p>Warning</p> <p>You must remove the old and any duplicate entries for CERT_PUB_KEY and CERT_PRIV_KEY in the .env file.</p> <p>Now run <code>docker compose up -d restart</code> and the new certificate will be in effect.</p> <p>Bonus: Upgrade postgres13 to 14</p>"},{"location":"update_server/","title":"Updating the RMM","text":""},{"location":"update_server/#keeping-your-linux-server-up-to-date","title":"Keeping your Linux server up to date","text":"<p>You should periodically run <code>sudo apt update</code> and <code>sudo apt -y upgrade</code> to keep your server up to date.</p> <p>Other than this, you should avoid making any changes to your server and let the <code>update.sh</code> script handle everything else for you.</p> <p>Danger</p> <p>Do NOT attempt in-place OS upgrades, such as trying to in-place upgrade from Debian 11 to 12. You will break your server!</p> <p>Instead, you must backup and restore to the new OS. </p> <p>Backup/restore functionality supports transition not only between different operating systems but also between architectures! For instance, you can back up an Ubuntu 20.04 system on an x86 architecture and restore it to an Oracle Cloud Free Tier ARM architecture running Debian 12.</p>"},{"location":"update_server/#updating-to-the-latest-rmm-version","title":"Updating to the latest RMM version","text":"<p>Danger</p> <p>Do not attempt to manually edit the update script or any configuration files unless specifically told to by one of the developers.</p> <p>Since this software is completely self hosted and we have no access to your server, we have to assume you have not made any config changes to any of the files or services on your server, and the update script will assume this.</p> <p>You should also never attempt to automate running the update script via cron.</p> <p>The update script will update itself if needed to the latest version when you run it, and then prompt you to run it again.</p> <p>Sometimes, manual intervention will be required during an update in the form of yes/no prompts, so attempting to automate this will ignore these prompts and cause your installation to break.</p> <p>SSH into your server as the user you created during install (eg <code>tactical</code>).</p> <p>Danger</p> <p>Never run any update scripts or commands as the <code>root</code> user.</p> <p>This will mess up permissions and break your installation.</p> <p>Question</p> <p>You have a backup, right?</p> <p>You've reviewed all release notes between your current version and the latest version, right?</p> <p>Download the update script and run it:</p> <pre><code>wget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/master/update.sh\nchmod +x update.sh\n./update.sh\n</code></pre> <p>If you are already on the latest version, the update script will notify you of this and return immediately.</p> <p>You can pass the optional <code>--force</code> flag to the update script to forcefully run through an update, which will bypass the check for latest version.</p> <pre><code>wget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/master/update.sh\nchmod +x update.sh\n./update.sh --force\n</code></pre> <p>This is useful for a botched update that might have not completed fully.</p> <p>The update script will also fix any permissions that might have gotten messed up during a botched update, or if you accidentally ran the update script as the <code>root</code> user.</p> <p>Warning</p> <p>Do not attempt to manually update MeshCentral to a newer version.</p> <p>You should let the <code>update.sh</code> script handle this for you.</p> <p>The developers will test MeshCentral and make sure integration does not break before bumping the mesh version.</p>"},{"location":"update_server/#keeping-your-ssl-certificates-up-to-date","title":"Keeping your SSL certificates up to date","text":"Let's Encrypt CertsBYO (Bring Your Own) Wildcard Certs <p>Info</p> <p>Currently, the update script does not automatically renew your Let's Encrypt wildcard certificate, which expires every 3 months, since this is non-trivial to automate using the DNS TXT record method.</p> <p>Update SSL: To renew and update your Let's Encrypt wildcard SSL certificate, run the following command, replacing <code>example.com</code> with your domain and <code>admin@example.com</code> with your email:</p> <pre><code>sudo certbot certonly --manual -d *.example.com --agree-tos --no-bootstrap --preferred-challenges dns -m admin@example.com --no-eff-email\n</code></pre> <p>Same instructions as during install for verifying the TXT record has propagated before hitting Enter.</p> <p><p>You're not done yet, keep reading!</p></p> <p>After renewing the certificate, it still needs to be applied to Tactical RMM. Now run the <code>update.sh</code> script, passing it the <code>--force</code> flag:</p> <pre><code>./update.sh --force\n</code></pre> <ol> <li> <p>Replace the certificate and private key at the paths chosen during installation.</p> </li> <li> <p>Ensure they are readable by the Tactical Linux user.</p> </li> <li> <p>Restart the necessary services to apply the changes:</p> </li> </ol> <pre><code>sudo systemctl restart nginx meshcentral rmm daphne\n</code></pre>"},{"location":"update_server/#video-walkthru","title":"Video Walkthru","text":""},{"location":"update_server/#update-faq","title":"Update FAQ","text":"<p>Based on years of feedback, if your server was working, you updated...and now it's not working you probably did one of these things:</p> <ol> <li>Not running certbot with the correct linux username (the one you installed TRMM with)</li> <li>Didn't put the <code>*.</code> in front of your domain name in the certbot command (or other certbot command typo).</li> <li>You didn't <code>do-release-upgrade</code> did you?</li> <li>Running an #unsupported proxy and assumed your reverse proxy was the only cert you needed to update?</li> </ol>"},{"location":"ee/reporting/reporting_overview/","title":"Reporting Overview","text":"<p>Released in TRMM v0.17.0 (Nov 1, 2023)</p> <p>The reporting addon allows you to access your Tactical RMM data and represent in the format of your choice. This could be a PDF file, a simple csv, or a complex interactive web dashboard.</p> <p>It is best to get started with using the shared templates and go from there (you can import these directly from the TRMM web UI with 1 click.) The pages below will help you get familiar with the terminology and the syntax. </p> <p>Check back here frequently in the coming days/weeks/months as we will be constantly updating and improving the Reporting docs and adding video tutorials.</p> <p>FAQ</p> <p>The Basics</p> <p>Base Templates</p> <p>Variables</p> <p>Data Queries</p> <p>Report Assets</p> <p>Tips and Tricks</p>"},{"location":"ee/reporting/functions/examples/","title":"Example Reports","text":""},{"location":"ee/reporting/functions/examples/#agent-uptime","title":"Agent Uptime","text":"<ol> <li>Import the <code>Agent Uptime_By Client (html)</code> report from the Shared Templates Report library</li> <li>Check at least one overdue item in agent settings</li> <li>Run report and enjoy!</li> </ol>"},{"location":"ee/reporting/functions/examples/#windows-11-upgrade-compatible-list","title":"Windows 11 Upgrade Compatible list","text":"<p>To get a Windows 10 upgrade to Windows 11 compatibility list you'll want to:</p> <ol> <li>Create an agent custom field</li> <li>Create an automation policy that applies to all your workstations </li> <li>Import one of the <code>Windows 11 Compatible</code> Reports </li> <li>Enjoy!</li> </ol> <p></p> <p></p>"},{"location":"ee/reporting/functions/examples/#antivirus-report","title":"Antivirus Report","text":"<p>To get a report of the active Antivirus on an agent you'll want to:</p> <ol> <li>Create an agent custom field</li> <li>Clone <code>Antivirus - Verify Status</code> Community script and add the <code>-customField</code> Script arg</li> <li>Create an automation policy that applies to all your workstations </li> <li>Import one of the <code>Antivirus</code> Reports </li> <li>Enjoy!</li> </ol> <p></p> <p></p>"},{"location":"ee/reporting/functions/examples/#noc-dashboard","title":"NOC Dashboard","text":"<p>Got a TV? Load it up for the team!</p> <p>Want quick searchable agent status with more data? Load it locally!</p> <p>The <code>Restrict Summary</code> button is for only showing agents that are offline and have an overdue alert set (eg critical machines). If it's on a hands off device make sure you set the refresh every so it's reloading data regularly.</p>"},{"location":"ee/reporting/functions/examples/#software-inventory","title":"Software Inventory","text":"<p><code>Software Inventory_By Software Name</code></p> <p>Search for software, sort by different columns</p> <p></p> <p><code>Software Report - Advanced DataTables</code></p> <p></p>"},{"location":"ee/reporting/functions/faq/","title":"Reporting FAQ","text":""},{"location":"ee/reporting/functions/faq/#pricing","title":"Pricing","text":"<p>Existing sponsors as of Oct 31, 2023: As a thank you for all your support and patience, you will get our Founders Edition perpetual reporting license which will be included in your existing sponsorship. To enable reporting, simply update your instance as you normally do and reporting will automatically be enabled.</p> <p>For all others, Reporting will be included for all Tier 2 and higher packages. Exceptions will be made for Non-Profits who will only require Tier 1.</p>"},{"location":"ee/reporting/functions/faq/#how-do-i-enable-reporting-as-a-new-sponsor","title":"How do I enable reporting as a new sponsor?","text":"<ol> <li> <p>Make sure your server has an appropriate code signing token saved ( Settings &gt; Code Signing).</p> </li> <li> <p>Run the update script with the <code>--force</code> flag (see instructions below for standard vs docker installs):</p> </li> <li> <p>Hard reload the web page. Make sure you use your browser's reload button to hard reload the page.</p> </li> </ol>  Standard install Docker install <pre><code>cd ~\nwget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/master/update.sh\nchmod +x update.sh\n./update.sh --force\n</code></pre> <pre><code>docker compose down\ndocker compose up -d\n</code></pre> <p>If there's a problem, open a ticket.</p>"},{"location":"ee/reporting/functions/faq/#how-do-i-add-chartsgraphs-to-my-report-templates","title":"How do I add charts/graphs to my report templates?","text":"<p>A bug was discovered with the chart/graph implementation right before release and it had to be pulled. It wil be released in a future update.</p>"},{"location":"ee/reporting/functions/reporting_assets/","title":"Assets","text":"<p>The Reports Manager gives the ability to upload and store static assets for use in any report. These can be used in html or PDF reports. </p> <p>In Report Templates, report assets are referenced by their unique ID so they can be renamed and moved without messing up the links.</p>"},{"location":"ee/reporting/functions/reporting_assets/#managing-assets","title":"Managing Assets","text":"<p>Open Reports Manager and click on the Report Assets button at the top. This will take you  to the root of the reporting assets directory. You can drill into folders by double-clicking and there is a right-click menu to perform other operations.</p>"},{"location":"ee/reporting/functions/reporting_assets/#adding-folders","title":"Adding folders","text":"<p>Navigate to the directory you want to create the folder. Use the Add Folder button at the top and give the folder a name. The folder will show up in the list.</p>"},{"location":"ee/reporting/functions/reporting_assets/#uploading-assets","title":"Uploading assets","text":"<p>Navigate to the directory you want to upload the file(s). Click on the Upload button at the top and a  dialog will open. You can specify multiple assets and click Upload. If there is a name conflict, a set of random characters will be appended.</p>"},{"location":"ee/reporting/functions/reporting_assets/#downloading-assets","title":"Downloading assets","text":"<p>Use the right-click menu item to download report assets. If you download a folder it will zip it prior to download. Downloading a file will download the file without zipping.</p>"},{"location":"ee/reporting/functions/reporting_assets/#deleting-assets","title":"Deleting assets.","text":"<p>There are two ways to delete assets. You can use the right-click menu to select a folder or asset to  delete. This will remove the folder and anything under it.</p> <p>There is also a bulk delete option by selecting multiple items. Select all of the items you want to delete and click the Bulk Actions button. Select Delete and confirm.</p>"},{"location":"ee/reporting/functions/reporting_assets/#renaming-assets","title":"Renaming assets","text":"<p>Use the right-click menu to rename folders or files. If there is a name conflict, a set of random characters will be appended.</p>"},{"location":"ee/reporting/functions/reporting_assets/#using-assets-in-report-templates","title":"Using assets in report templates","text":"<p>In the Report Template editor, click on the Image button on the toolbar. Select the Report Assets radio button and browse to the asset you want to add. Select it and press insert. This will add a link  with a url that looks something like <code>asset://{uuid}</code>. The reporting engine will resolve this url to the asset and generate an appropriate url based on if the report output format is HTML or PDF.</p>"},{"location":"ee/reporting/functions/reporting_basetemplates/","title":"Base Templates","text":"<p>Base Templates are used to apply the same formatting to multiple templates. The base template will declare one or more \"blocks\" that are then filled in by the child template. Base templates use the Jinja syntax for inheriting and extending. You can see the reference  Here.</p> <p>Note</p> <p>Even though the examples for base templates are in html, you can use any format you want.</p>"},{"location":"ee/reporting/functions/reporting_basetemplates/#adding-base-templates","title":"Adding base templates","text":"<p>To add a base template you can browse to Reports Manager &gt; Base Templates &gt; Add. From there  you can create your base template in the editor and click save.</p>"},{"location":"ee/reporting/functions/reporting_basetemplates/#using-a-base-template-in-your-report-template","title":"Using a base template in your report template","text":"<p>To use the base template, we will need to open up the Report Template editor  (Reports Manager &gt; double-click on the template), then select the base template from the  dropdown.</p> <p>Note</p> <p>This will automatically add the {% extends ... %} tag at the beginning of the report template on the backend. If you are looking through the Jinja base template documentation, you can omit that line.</p>"},{"location":"ee/reporting/functions/reporting_basetemplates/#using-blocks","title":"Using blocks","text":"<p>See below for a basic base template that specifies one block.</p> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;style&gt;\n            {{css}}\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        {% block content%}{% endblock %}\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>In the template that is inheriting the base template above, you can fill in these blocks like so:</p> <pre><code>{% block content%}\nThis will show up between the &lt;body&gt; tags in the base template/\n{% endblock %}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_basetemplates/#multiple-blocks","title":"Multiple blocks","text":"<p>We can also fill in multiple blocks if they are specified in the base template. Any blocks that aren't used will just be blank.</p> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;style&gt;\n            {{css}}\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"header\"&gt;\n        {% block header %}{% endblock %}\n        &lt;/div&gt;\n\n        &lt;div id=\"content\"&gt;\n        {% block content %}{% endblock %}\n        &lt;/div&gt;\n\n        &lt;div id=\"footer\"&gt;\n        {% block footer %}{% endblock %}\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>In the template, we just need to use the same blocks and it will fill in the data.</p> <pre><code>{% block header %}\nThis is the header\n{% endblock %}\n\n{% block content %}\nThis is the content\n{% endblock %}\n\n{% block footer %}\nThis is the footeer\n{% endblock %}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_basetemplates/#variable-analysis","title":"Variable analysis","text":"<p>In the Report Template editor, you can quickly see what blocks the base template has available.  You can click on the &gt; button in the top-left of the editor (Under the report name field) and  at the top it will give a warning if it doesn't see the blocks listed. You can also click on the blocks to copy them to the clipboard to be pasted into the template.</p>"},{"location":"ee/reporting/functions/reporting_basics/","title":"The Basics","text":"<p>This template will show case the basics of reporting and also give some examples on how to use them. The toolbar along the top  has various formating options for text and some useful functions for building dynamic reports. Reports are built using the Jinja templating engine. A reference guide and be found Here. </p>"},{"location":"ee/reporting/functions/reporting_basics/#reporting-formats","title":"Reporting formats","text":"<p>You can write report templates using Markdown, HTML, or Plain Text. HTML and Markdown reports will look the  same regardless of choice. Templates cannot be converted between formats, but it would be easy enough to do the conversion manually between markdown and HTML</p>"},{"location":"ee/reporting/functions/reporting_basics/#markdown-templates","title":"Markdown templates","text":"<p>Do note that HTML is valid in markdown and should be used when the Markdown syntax doesn't do exactly what you need. An example would be for using the <code>&lt;table&gt;</code> tag.</p> <p>Also note that the markdown is rendered to HTML anyway.</p> <p>See this reference for Markdown syntax</p>"},{"location":"ee/reporting/functions/reporting_basics/#plain-text-templates","title":"Plain text templates","text":"<p>Plain Text templates are a great choice if you just want to generate some text without all of the formatting. This is very useful if you want a CSV export of some data.</p>"},{"location":"ee/reporting/functions/reporting_basics/#the-toolbar","title":"The toolbar","text":"<p>The toolbar along the top of the editor provides some shortcuts for commonly used functions. Most of the  buttons are used for text formatting, but there are some shortcuts for adding/editing data queries, base templates, and inserting charts and tables. Hovering over the button will display its function.</p>"},{"location":"ee/reporting/functions/reporting_basics/#variables","title":"Variables","text":"<p>You can add in variables in the right editor pane. The variables pane can be toggled on/off using the vars button on the toolbar. The variables are adding in yaml format and can be referenced using <code>{{variable_name}}</code> in the template. The value of the variable will be substituted when the template is rendered. If the value of the variables is nested within an object, you can use dot notation to render the value like <code>{{ object.variable_name }}</code>. If there is a space in the name you can use <code>{{ object[\"variable name\"] }}</code>.</p> <p></p>"},{"location":"ee/reporting/functions/reporting_basics/#variable-analysis","title":"Variable analysis","text":"<p>With data sources and other dynamic sources, it can be difficult to view what the data looks like to use in report templates. With variable analysis, the query is ran and  the available properties are returned. Click on the &gt; arrow on the top left of the  editor window (under the toolbar) to see the available properties from the variables section. You can then click on them to copy and you can paste them into the template.</p> <p>For array values, you can click the For loop button and paste in a Jinja for loop to easily loop over the properties.</p>"},{"location":"ee/reporting/functions/reporting_basics/#data-queries","title":"Data queries","text":"<p>Data queries are a way to save commonly used queries and use them in templates. Data queries are added under the data_sources key in the variables section. If the key  doesn't exist, it will be created</p>"},{"location":"ee/reporting/functions/reporting_basics/#adding-data-queries","title":"Adding data queries","text":"<p>Using the Add Data Query button on the toolbar, it will open the data query editor. This editor will let you know the valid syntax of the query and supports auto-complete. If you are stumped and need to know all of the values that are supported you can press Ctrl+Space and a dropdown will show. Once you add the query, it will be auto-inserted into the template.</p> <p>You can also add a data query from the Report Manager and open the Data Queries button along the top. This is the save function as using the toolbar, but it will save the query to allow it to be used in templates.</p>"},{"location":"ee/reporting/functions/reporting_basics/#inserting-saved-data-queries","title":"Inserting saved data queries","text":"<p>You can insert a saved data query using the Insert Data Query button on the toolbar. You just have to select the data query from the drop down and it will insert it into the template.</p>"},{"location":"ee/reporting/functions/reporting_basics/#editing-data-queries","title":"Editing data queries","text":"<p>You can edit data queries in the template by clicking the Edit Data Query button on the toolbar. This will list the currently added data_sources into a dropdown and allow you to edit them in the  auto complete editor. Clicking save will replace the data query in the variables with the updated  one.</p>"},{"location":"ee/reporting/functions/reporting_basics/#report-output-format","title":"Report output format","text":"<p>Reports can be output in either HTML, PDF, or in Plain Text format.</p>"},{"location":"ee/reporting/functions/reporting_basics/#html-and-markdown-template-types","title":"HTML and Markdown Template types","text":"<p>HTML and Markdown template types and be output in PDF or HTML formats. These template types don't  support plain text output.</p>"},{"location":"ee/reporting/functions/reporting_basics/#plain-text","title":"Plain Text","text":"<p>Plain text template types can be output in PDF or text. This template type doesn't support html output. Putting markdown or anything else in a plain text template will just output the same markdown. It isn't processed through the markdown library.</p>"},{"location":"ee/reporting/functions/reporting_basics/#css","title":"CSS","text":"<p>CSS can be embedded in the report template using the CSS tab on the top right on the report template editor. The CSS class can be referenced in the report template for styling. </p> <p>If you are using markdown, you can add ids and classes to html elements by using <code>{#id_name}</code> and <code>{.class_name}</code> beside the template.</p> <p>This will render an h1 html tag with an id of 'id-name' <code>{#id-name}</code></p> <p>This will render an h1 html tag with a class of 'class-name' <code>{.class-name}</code></p>"},{"location":"ee/reporting/functions/reporting_basics/#report-assets","title":"Report assets","text":"<p>Assets can be served from your Tactical RMM instance. They will need to be uploaded to the Asset Manager first. This can be accessed from the Reporting Manager windows by clicking on the Report Assets.</p> <p>Once uploaded, click on the Image button on the toolbar and select the Report Asset radio button. From there you can click on an asset and go to Insert.</p>"},{"location":"ee/reporting/functions/reporting_basics/#base-templates","title":"Base templates","text":"<p>Base Templates allow you to use the same report structure throughout multiple reports. The base template should be a full html document enclosed in an html tag. To specify content that should be overridden in the child template, you can use Jinja blocks in  the base template. See this  example in the Jinja documentation.</p> <p>You can add a base template from the report template editor by clicking the base button on the toolbar.</p> <p>When you select a base template (using the dropdown) in a report template, the extends block will automatically be inserted. You can click on the variable analysis button (top-left arrow) to see which blocks in the base template need to be overridden yet. Clicking on the block in variable analysis will copy the text to the clipboard and will need to be copied into the template.</p>"},{"location":"ee/reporting/functions/reporting_basics/#template-dependencies","title":"Template dependencies","text":"<p>Sometimes you need to provide data during a reports runtime. This could be a specific client, a date range, etc. This is achievable by setting a template dependency using the Template Dependencies dropdown on the report editor. Then default values are Client, Site, and Agent. You can type additional values that are required for the report.</p> <p>In your variables and report template, you can use these dependencies by enclosing the same of the dependency like so: <code>{{agent.hostname}}</code> or <code>{{client.name}}</code>. For custom dependencies you can just type in <code>{{ dependency_name }}</code>. These are case sensitive.</p>"},{"location":"ee/reporting/functions/reporting_basics/#report-preview","title":"Report preview","text":"<p>You can easily see what a report is going to look like by pressing the Preview button  on the top right of the editor window. You can choose between an HTML or PDF output  using the radio buttons.</p> <p>If you have report dependencies, a dialog box will show asking you to fill in the values that should be used to generate the report.</p>"},{"location":"ee/reporting/functions/reporting_basics/#debug","title":"Debug","text":"<p>if you need additional info showing the values of the variables and the rendered HTML, you can check the debug button. This will show at the bottom of the preview window.</p>"},{"location":"ee/reporting/functions/reporting_basics/#running-a-report","title":"Running a report","text":"<p>Running a report can be done from the Reporting Manager by right-clicking on the  report template and either running as an HTML or PDF report. The report will open up in a separate window. If there are report dependencies, a dialog will prompt to  populate the values. </p> <p>You can save the URL or bookmark it to easily generate the same report without having to populate the dependencies.</p> <p>If you have a Client, Site, or Agent dependency specified in the report, you can also right-click on the respective entity in Tactical RMM and go to Integrations &gt; Run Report. You can then specify a report output type and the entity that you right-clicked on will automatically populate as a dependency.</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/","title":"Data Queries","text":""},{"location":"ee/reporting/functions/reporting_dataqueries/#introduction","title":"Introduction","text":"<p>Data queries allow you to pull information from the Tactical RMM database to use in your  Templates. Data queries are defined in the variables editor under the data_sources object. There is a predefined format that the data query must follow and it is defined using a JSON  or yaml syntax.</p> <p>At it's simplest form, a data query just specifies a model. Doing this will pull all of the  records and columns available from the table.</p> <p>This is an example of a data query that pulls all columns and rows from the sites table.</p> <pre><code>data_sources:\n    sites:\n        model: site\n</code></pre> <p>Once this is specified in the variables, you can use this data in the template like this: <code>{{data_sources.sites}}</code>. This will just dump the data into the template, but it isn't very  useful. We can actually loop over this data query to format it using a Jinja for loop.</p> <pre><code>{% for item in data_sources.sites %}\n{{item.name}}\n{% endfor %}\n</code></pre> <p>This will print out the name of every site on a new line.</p> <p>We can have multiple data_sources specified also like so.</p> <pre><code>data_sources:\n    sites:\n        model: site\n    clients:\n        model: client\n</code></pre> <p>The same rules apply for the second query. You can reference it in your templates using <code>{{data_sources.clients}}</code>. </p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#template-dependencies","title":"Template Dependencies","text":"<p>Template dependencies allow you to pass information to a report at runtime. This could be a client, site, or agent. These are covered in detail in the documentation, but just know that you can use template dependencies in your data queries by using the <code>{{ }}</code> in place of the  data you want to replace. See the example below for a client dependency:</p> <pre><code>data_sources:\n    sites:\n        model: site\n        filter:\n            client_id: '{{ client.id }}'\n</code></pre> <p>Note</p> <p>Note that quotes are required around <code>{{}}</code> tags in the variables section</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#data-query-editor","title":"Data Query Editor","text":"<p>There is a data query editor that supports auto-complete so that you can more easily determine which columns and relations are available. It is recommended to always use this editor to avoid typos and errors when generating reports. You can open the query  editor by going to Reports Manager &gt; Data Queries &gt; New or in the template editor by  clicking Add Data Query or Edit Data Query toolbar button in the template.</p> <p>Do note that the Query Editor uses JSON syntax to provide the auto-complete functionality. You can either start typing to trigger the auto-complete list, or press the Ctrl+Alt key.</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#syntax","title":"Syntax","text":"<p>Below are the allowed properties in a data query. You can combine these properties together is the same data query unless specifically noted.</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#model-string","title":"model - string","text":"<p>The only required field for a data query is the model. This tells the system which database  table to pull the data from. The available models are:</p> <p>Visualized version</p> <ul> <li>agent</li> <li>agentcustomfield</li> <li>agenthistory</li> <li>note</li> <li>alert</li> <li>auditlog</li> <li>automatedtask</li> <li>check</li> <li>checkhistory</li> <li>checkresult</li> <li>chocosoftware</li> <li>client</li> <li>clientcustomfield</li> <li>debuglog</li> <li>globalkvstore</li> <li>pendingaction</li> <li>policy</li> <li>site</li> <li>taskresult</li> <li>winupdate</li> <li>winupdatepolicy</li> </ul>"},{"location":"ee/reporting/functions/reporting_dataqueries/#only-array-of-strings","title":"only - array of strings","text":"<p>Only is useful for only pulling certain columns. This is recommended if you are pulling data from the agents table since services and wmi_detail columns are very large and can take a long time to run.</p> <p>A few examples of using only.</p> <pre><code>data_sources:\n    sites:\n        model: site\n        only:\n          - name\n          - failing_checks\n    clients:\n        model: client\n        only:\n          - name\n          - failing_checks\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#defer","title":"defer","text":"<p>To not load some fields by default to limit data from being pulled, unless it is needed later for some reason.</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#custom_fields-array-of-strings","title":"custom_fields - array of strings","text":"<p>This is only applicable to the client, site, and agent model. You can  pass an array of strings with names of custom fields and it will inject them into the data. </p> <p>Lets say we have these custom fields configured:</p> <p>Client - custom_field - Custom Field 2</p> <p>Site - another Custom Field - no_spaces</p> <p>Agent - agent_custom_field</p> <p>We can pull this data in a data query like this:</p> <pre><code>data_sources:\n    clients:\n        model: client\n        only:\n          - name\n          - failing_checks\n        custom_fields:\n          - custom_field\n          - Custom Field 2\n    sites:\n        model: site\n        only:\n          - name\n          - failing_checks\n        custom_fields:\n          - another Custom Field\n          - no_spaces\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n        custom_fields:\n          - agent_custom_field\n</code></pre> <p>The custom field names are case sensitive and the custom field must be configured in the system or no custom data will be pulled. A custom_fields object is added to the data and is accessible in the template.</p> <p>You can access the custom field data for the clients data query like this:</p> <pre><code>{% for item in data_source.clients %}\n{{ item.custom_fields.custom_field }}\n{{ item.custom_fields[\"Custom Field 2\"] }}\n{% endfor %}\n</code></pre> <p>Note that you can't use dot notation for a property if it has spaces. See the above  example for the Custom Field 2 property</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#properties-array-of-strings","title":"properties - array of strings","text":"<p>This will allow injecting model @property fields into the data. The current supported fields are:</p> <p>Agent</p> <ul> <li>client</li> <li>timezone</li> <li>is_posix</li> <li>arch</li> <li>status</li> <li>checks</li> <li>pending_actions_count</li> <li>cpu_model</li> <li>graphics</li> <li>local_ips</li> <li>make_model</li> <li>physical_disks</li> <li>serial_number</li> </ul> <p>AgentCustomField</p> <ul> <li>value</li> </ul> <p>Alert</p> <ul> <li>assigned_agent</li> <li>site</li> <li>client</li> <li>get_result</li> </ul> <p>Policy</p> <ul> <li>is_default_server_policy</li> <li>is_default_workstation_policy</li> </ul> <p>Automated Task</p> <ul> <li>schedule</li> </ul> <p>Check</p> <ul> <li>readable_desc</li> </ul> <p>CheckResult</p> <ul> <li>history_info</li> </ul> <p>Client</p> <ul> <li>live_agent_count</li> </ul> <p>Site</p> <ul> <li>live_agent_count</li> </ul> <p>Client Custom Field</p> <ul> <li>value</li> </ul> <p>Site Custom Field</p> <ul> <li>value</li> </ul> <p>We can pull this data in a data query like this:</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n        properties:\n          - status\n          - is_posix\n          - make_model\n          - cpu_model\n    checks:\n      model: check\n      properties:\n        - readable_desc\n</code></pre> <p>You can access the property data directly on the agent in the template like this:</p> <pre><code>{% for item in data_source.agents %}\n{{ item.status }}\n{{ item.make_model }}\n{% endfor %}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#filter-object","title":"filter - object","text":"<p>Using the filter property, you can filter the amount of rows that are returned. This is useful if you only want a agents for a particular client or site, or you only want agents tht are pending a reboot.</p> <p>See below for an example:</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        filter:\n            needs_reboot: True\n</code></pre> <p>This data query will only return agents that need a reboot. We can also add a second filter like so.</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        filter:\n            needs_reboot: True\n            plat: \"windows\"\n</code></pre> <p>The above is just doing an equals comparison to make sure the rows match. You can also use other operations like greater than, contains, etc. </p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        filter:\n            operating_system__contains: \"22H2\"\n</code></pre> <p>To use the contains filter, we need to append two underscores (_) and type in the field lookup.  This just uses the django built in field lookups.A full list can be found  Here</p>"},{"location":"ee/reporting/functions/reporting_dataqueries/#exclude-object","title":"exclude - object","text":"<p>We can use this to exclude rows from our data. The same rules apply for filter apply here. (See above)</p> <p>Example</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        exclude:\n            plat: \"linux\"\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#limit-number","title":"limit - number","text":"<p>This will limit the number of returned rows in the data.</p> <p>Example</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        limit: 400\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#get-boolean","title":"get - boolean","text":"<p>Instead of returning a list, the data query will attempt to return a single object. This is  best used with a filter that guarantees a single row returned, i.e: filtering by id. This will error out if the query returns more than one object.</p> <p>Example</p> <pre><code>data_sources:\n    agent:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        filter: \n          agent_id: hjk1hj23hj23hkj2hjh3j2h3\n        get: true\n</code></pre> <p>In the template, you can use the properties directly instead of looping</p> <pre><code>{{data_sources.agent.hostname}}\n{{data_sources.agent.operating_system}}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#first-boolean","title":"first - boolean","text":"<p>This will return the first row in a table. This is guaranteed to always return one result. You can apply other properties (like filter or exclude) also to limit the data.</p> <p>Example </p> <pre><code>data_sources:\n    agent:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        first: true\n</code></pre> <p>In the template, you can use the properties directly instead of looping</p> <pre><code>{{data_sources.agent.hostname}}\n{{data_sources.agent.operating_system}}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#count-boolean","title":"count - boolean","text":"<p>This allows you to return the number of rows found. Can be used with filter or exclude.</p> <p>Example </p> <pre><code>data_sources:\n    agent:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        count: true\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#order_by-string","title":"order_by - string","text":"<p>This allows you to sort/reorder the returned data based on a specific column. Putting a '-' before the column puts it in descending order and the default is ascending order</p> <p>Ascending Example </p> <pre><code>data_sources:\n    agent:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        order_by: hostname\n</code></pre> <p>Descending Example</p> <pre><code>data_sources:\n    agent:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n        order_by: -hostname\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#csv-boolean-object","title":"csv - boolean | object","text":"<p>This is a shorthand to return a string formatted as a csv. </p> <p>Example</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n          - site__name\n          - site__client__name\n        filter:\n            site__client__name: \"Client Name\"\n        csv: true\n</code></pre> <p>This will add a site__name and site__client__name column on the returned data. We use a double underscore every time we want to go to another table. The site column exists directly on the agents table. So in order to get the name (which resides on the sites table) we need to use the double underscore. Same thing with the client name. We need to go through the sites table in order to get the client name so we use another double underscore. </p> <p>Usage in template</p> <p>{{data_sources.agents}}</p> <p>Output will look something like:</p> <pre><code>hostname,operating_system, plat,needs_reboot,site__name,site__client__name\ndata,data,data,data,data,data\n</code></pre> <p>You can also rename the columns by passing a mapping into csv like so:</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n          - site__name\n          - site__client__name\n        filter:\n            site__client__name: \"Client Name\"\n        csv: \n            hostname: Hostname\n            operating_system: Operating System\n            plat: Platform\n            needs_reboot: Needs Reboot\n            site__name: Site Name\n            site__client__name: Client Name\n</code></pre> <p>Which would return something like</p> <pre><code>Hostname,Operating System,Platform,Needs Reboot,Site Name,Client Name\ndata,data,data,data,data,data\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#json-boolean","title":"json - boolean","text":"<p>This will return a json string representation of the object. This is useful if you are passing the data source to be processed by javascript.</p> <p>Example</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n          - site__name\n          - site__client__name\n        filter:\n            site__client__name: \"Client Name\"\n        json: true\n</code></pre> <p>Usage in template</p> <p><code>{{data_sources.agents}}</code></p> <p>Output will look something like:</p> <pre><code>hostname,operating_system, plat,needs_reboot,site__name,site__client__name\ndata,data,data,data,data,data\n</code></pre>"},{"location":"ee/reporting/functions/reporting_dataqueries/#relations","title":"Relations","text":"<p>You can include columns from a related model by using the double underscore syntax. You may have a data query using the agents table, but want to include the Site name and the Client name. See the example below:</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n          - site__name\n          - site__client__name\n</code></pre> <p>This will add a site__name and site__client__name column on the returned data. We use a double underscore every time we want to go to another table. The site column exists directly on the agents table. So in order to get the name (which resides on the sites table) we need to use the double underscore. Same thing with the client name. We need to go through the sites table in order to get the client name so we use another double underscore. </p> <p>All available combinations are listed in the query editor</p> <p>To display these columns in the template you can do this:</p> <p>This will return a json string representation of the object. This is useful if you are passing the  data source to be processed by javascript or you just want to create your own custom api endpoint.</p> <pre><code>{% for item in data_source.agents %}\n{{ item.site__name }}\n{{ item.site__client__name }}\n{% endfor %}\n</code></pre> <p>We can also filter based on relations. See below:</p> <pre><code>data_sources:\n    agents:\n        model: agent\n        only:\n          - hostname\n          - operating_system\n          - plat\n          - needs_reboot\n          - site__name\n          - site__client__name\n        filter:\n            site__client__name: \"Client Name\"\n</code></pre>"},{"location":"ee/reporting/functions/reporting_variables/","title":"Variables","text":"<p>Variables provide a way to enrich your report with data. Variables are entered using  YAML syntax and can be edited directly in the template by using the variables editor on the right. Everything with YAML is case-sensitive, so make sure to check for typos!</p> <p>YAML syntax and features reference can be found Here</p>"},{"location":"ee/reporting/functions/reporting_variables/#some-sample-variables-and-how-to-use-them-in-the-template","title":"Some sample variables and how to use them in the template","text":"<p>Variables</p> <pre><code>title: Title Name\nlistOfData: [12, 13, 14]\nan_object:\n    key: value\n    key2: value2\n    key with a space: value3\nan_array_of_objects:\n    - key: value\n      key2: value2\n      the space: value3\n    - key: value\n      key2: value2\n      the space: value3\n</code></pre> <p>Markdown Template <pre><code># {{title}}\n\n## A list of numbers\n{% for item in listOfData %}\n* {{item}}\n{% endfor %}\n\n## List the object keys\n* {{an_object.key}}\n* {{an_object.key2}}\n* {{an_object[\"key with a space\"]}}\n\n## List of objects\n{% for item in an_array_of_objects %}\n* {{item.key}}\n* {{item.key2}}\n* {{item[\"the space\"]}}\n{% endfor %}\n</code></pre></p> <p>Rendered Output</p> <pre><code># Title Name\n\n## List of numbers\n* 12\n* 13\n* 14\n\n# List the object keys\n* value\n* value2\n* value3\n\n## List of objects\n* value\n* value2\n* value3\n* value\n* value2\n* value3\n</code></pre>"},{"location":"ee/reporting/functions/reporting_variables/#dependencies","title":"Dependencies","text":"<p>Dependencies offer a way to provide information to the templating engine at the reports runtime. The three built in dependencies are client, site, and agent. The  dependencies dropdown also allows for custom values to be entered. When you run the  report, a dialog box will show that requires you to provide the values for the dependencies. If you ran the report from a right-click context menu item for client, site, or agent, the  dependency will auto-populate in the report.</p> <p>Dependencies are actually merged into the variables behind the scenes, so any properties on the dependency are available to the template to use.</p>"},{"location":"ee/reporting/functions/reporting_variables/#built-in-dependencies","title":"Built-in dependencies","text":"<p>You can access the built-in dependencies directly in the template using {{client.name}}, {{agent.hostname}}, etc.</p>"},{"location":"ee/reporting/functions/reporting_variables/#custom-dependencies","title":"Custom dependencies","text":"<p>You can type in custom dependencies in the dropdown to prompt for other information at report runtime. Custom dependencies only support string values at this time and are  referenced in the template using {{ custom_dependency_name }}.</p>"},{"location":"ee/reporting/functions/reporting_variables/#using-template-dependencies-in-variables","title":"Using Template Dependencies in variables","text":"<p>Note:  You can use dependencies in data queries to filter data. See Data Queries</p> <p>You can also use dependencies in the variables section. The syntax is still the same  as using them in the template, but you need to make sure that the {{}} is surrounded  with quotes. </p> <p>Example with client and a custom_dep dependency</p> <pre><code>title: '{{client.name}} Summary'\ndependency: '{{custom_dep}} some value'\n</code></pre>"},{"location":"ee/reporting/functions/reporting_variables/#variable-analysis","title":"Variable Analysis","text":"<p>If you want to see what your data will look like and how to use it in your template, you can  click on the &gt; icon on the top-left of the editor windows. (Under the Template Name field). This will run the report template variables server-side and send the results back. This is really useful for data queries and other dynamic information that isn't immediately apparent.</p> <p>You can also click on the property to copy the template tag to the clipboard. There is also a button for arrays to generate a for loop. You can clip in the loop button and it will put the text in the clipboard to be pasted into the template.</p> <p>If you are using dependencies, you will need to click on the Preview tab and fill in the  dependencies before the variables analysis will run.</p>"},{"location":"ee/reporting/functions/reporting_variables/#python-modules-available-in-template","title":"Python modules available in template","text":""},{"location":"ee/reporting/functions/reporting_variables/#datetime","title":"datetime","text":"<p>See https://docs.python.org/3/library/datetime.html for all properties and functions.</p> <p>Formatted dates use <code>strftime</code> </p> <pre><code>{{ datetime.datetime.fromtimestamp(item.boot_time, ZoneInfo('America/New_York')).strftime('%Y-%m-%d %H:%M:%S') }}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_variables/#datetimedatetime","title":"datetime.datetime","text":"<p>Example usage in template</p> <p><code>{{ datetime.datetime.now() }}</code></p>"},{"location":"ee/reporting/functions/reporting_variables/#datetimedate","title":"datetime.date","text":"<p>Example usage in template</p> <p><code>{{ datetime.date.today() }}</code></p>"},{"location":"ee/reporting/functions/reporting_variables/#datetimetimedelta","title":"datetime.timedelta","text":"<p>Example usage in template</p> <p><code>{{ datetime.datetime.now() - datetime.timedelta(days=30) }}</code></p>"},{"location":"ee/reporting/functions/reporting_variables/#re","title":"re","text":"<p>See https://docs.python.org/3/library/re.html for all properties and functions</p> <p>Example usage in template</p> <pre><code>{% set matches = re.search('this', 'inthisstring') %}\n{{matches}}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_variables/#zoneinfo","title":"ZoneInfo","text":"<p>See https://docs.python.org/3/library/zoneinfo.html for all properties and functions</p> <p>Example usage in template</p> <pre><code>{% for item in data_sources.agentsList %}\n    {% set pst_zone = ZoneInfo('America/Los_Angeles') %}\n    {% set last_seen_pst = item.last_seen.astimezone(pst_zone) %}\n    Last seen in PST: {{ last_seen_pst.strftime('%Y-%m-%d %H:%M:%S %Z') }}\n{% endfor %}\n</code></pre>"},{"location":"ee/reporting/functions/reporting_variables/#custom-jinja-filters","title":"Custom jinja filters","text":"<p>In addition to the builtin jinja filters, TRMM also ships with custom jijna filters. We can write custom filters based on your requests so please ask one of the developers in Discord or in this github issue if you would like a custom filter written to make parsing data in templates easier for you.</p> <p>The list of custom jijna filters are listed here and here are video examples of how to use them:</p> <p>as_tz:</p> <p>local_ips:</p>"},{"location":"ee/reporting/functions/reporting_variables/#custom-processors","title":"Custom processors","text":"<p>Custom processors are provided to the yaml parser and allow shortcuts or provide functionality that isn't possible using the template and variables alone.</p>"},{"location":"ee/reporting/functions/reporting_variables/#now","title":"!now","text":"<p>Provides a timestamp at the report runtime.</p> <p>Example</p> <pre><code>report_run_timestamp: !now\n</code></pre> <p>You can also get a timestamp in the future or the past by passing a parameter. The supported time intervals are:</p> <ul> <li>weeks</li> <li>days</li> <li>hours</li> <li>minutes</li> <li>seconds</li> <li>microseconds</li> </ul> <p>If you want a timestamp in the future 5 days you would do:</p> <pre><code>five_days_from_now: !now days=5\n</code></pre> <p>If you want a timestamp 4 hours in the past you would do:</p> <pre><code>four_hours_ago: !now hours=-4\n</code></pre> <p>You can also specify a value from a dependency.</p> <p>Note: The !now must be outside of the quotes.</p> <pre><code>last_seen_time: !now 'hours=-{{last_seen}}'\n</code></pre> <p>If we ran the report and put in 5 it would output <pre><code>last_seen_time: !!now 'hours=-5'\n</code></pre></p>"},{"location":"ee/reporting/functions/tipsntricks/","title":"Tips n' Tricks","text":""},{"location":"ee/reporting/functions/tipsntricks/#formatting-matters","title":"Formatting matters","text":"<p>Make sure your tabs are at the right level.</p> <p></p>"},{"location":"ee/reporting/functions/tipsntricks/#quickly-generate-reports-from-clientsite-tree","title":"Quickly generate reports from client/site tree","text":"<p>Right click on a client or site to quickly run/download a report.</p> <p></p>"},{"location":"ee/reporting/functions/tipsntricks/#change-pdf-orientation-to-landscape","title":"Change PDF Orientation to Landscape","text":""},{"location":"ee/reporting/functions/tipsntricks/#making-api-calls-from-within-a-report-template","title":"Making API Calls from Within a Report Template","text":"<p>If you plan to make API calls (e.g., using axios or fetch) from within a report template, you need to configure additional settings to ensure proper functionality:</p> <p>Append the following code to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code>:</p> <pre><code>from corsheaders.defaults import default_headers\n\nCORS_ALLOW_HEADERS = (\n  *default_headers,\n  \"x-api-key\",\n)\n</code></pre> <p>Then restart the rmm service:</p> <pre><code>sudo systemctl restart rmm\n</code></pre>"},{"location":"ee/sso/sso/","title":"SSO - Single Sign-on","text":"<p>Version added: v0.20.0</p>"},{"location":"ee/sso/sso/#intro","title":"Intro","text":"<p>Tactical RMM's Single Sign-On (SSO) feature supports all OIDC-compatible authentication providers out of the box, allowing flexible integration with providers like Google, Microsoft, or any other that supports the OpenID Connect (OIDC) standard. </p> <p>This approach enables you to configure any compatible provider by simply entering its URL, giving you the freedom to choose the identity provider that best suits your needs without specific provider dependencies.</p>"},{"location":"ee/sso/sso/#video-walkthru","title":"Video Walkthru","text":""},{"location":"ee/sso/sso/#license","title":"License","text":"<p>The SSO feature is released under the Tactical RMM Enterprise License and requires a Tier 1 or higher sponsorship.</p>"},{"location":"ee/sso/sso/#enable-sso","title":"Enable SSO","text":"<p>SSO can be enabled via Global Settings &gt; SSO. There is also an option to block regular user logins, allowing only SSO sign-ons (with the exception of local superusers).</p> <p></p>"},{"location":"ee/sso/sso/#add-oidc-provider","title":"Add OIDC Provider","text":"<p>Provider Name: A unique identifier for the SSO provider. Name this whatever you want, but avoid spaces and special characters, as this will be part of the callback URL. This name will appear on the Tactical RMM Login page.</p> <p>Issuer URL: The OpenID Connect Issuer URL provided by the SSO provider. This is typically the base URL where the provider hosts their OIDC configuration.</p> <p>Issuer URL examples</p> <p>GitLab: <code>https://gitlab.com</code></p> <p>Apple: <code>https://appleid.apple.com</code></p> <p>Twitch: <code>https://id.twitch.tv/oauth2</code></p> <p>Facebook: <code>https://www.facebook.com</code></p> <p>Mattermost: https://developers.mattermost.com/integrate/admin-guide/admin-oauth2/#oauth-endpoints</p> <p>Client ID: A unique identifier provided by your OIDC provider that represents your application, allowing the provider to recognize it during the authentication process.</p> <p>Secret: A secure key provided by your OIDC provider, used in combination with the Client ID to authenticate your application and ensure secure communication between your app and the provider.</p> <p>Default User Role: The Tactical RMM Role that should be assigned to the SSO user on first sign in.</p> <p></p>"},{"location":"ee/sso/sso/#examples","title":"Examples","text":""},{"location":"ee/sso/sso/#google-workspace","title":"Google Workspace","text":"<p>Info</p> <p>Using Google as an OAuth provider is only supported if you are using Google Workspace.</p> <p>1. Create a Project</p> <ol> <li> <p>Open the google cloud console</p> </li> <li> <p>Create a project or use an existing one</p> </li> <li> <p>Go to the Auth Overview page and click on the 'Getting Started' button to setup the project. Select Internal for the user type.</p> </li> </ol> <p>2. Setup Branding</p> <ol> <li> <p>Setup Branding (OAuth consent screen)</p> <ul> <li>Make sure that \"Authorized domains\" includes the root domain of your instance.</li> </ul> <p></p> </li> </ol> <p>3. Create a Client</p> <ol> <li> <p>Create a client</p> <ul> <li>Application type: Web application</li> <li>Name: Tactical RMM</li> <li>Do not add javascript or redirect urls yet, we'll come back to this.</li> </ul> </li> <li> <p>Click Create.</p> </li> <li> <p>Click on the newly created client to open it and then copy the Client ID and Secret.</p> <p></p> </li> </ol> <p>4. Add Provider in TRMM</p> <p>Provider Name: <code>Google</code></p> <p>Issuer URL: <code>https://accounts.google.com</code></p> <p>Client ID and Secret: what you just copied.</p> <p>Default User Role: choose a role.</p> <p>Click Submit</p> <p>5. Add Callback URLs</p> <ol> <li> <p>Right click on the provider in TRMM and copy both the Callback URL as well as the Allowed Javascript Origin</p> <p></p> </li> <li> <p>Go back to the Client screen in the Google console and paste in the 2 copied urls. Note: Callback URL = Authorized redirect URI</p> <p></p> </li> </ol>"},{"location":"ee/sso/sso/#microsoft-entra-id-azure","title":"Microsoft Entra ID / Azure","text":"<p>1. Register an application</p> <ol> <li> <p>Go to https://entra.microsoft.com (Previously Azure Active Directory), in the left sidebar select Applications &gt; App registrations</p> </li> <li> <p>Click \"+ New registration\"</p> <ul> <li>Name: <code>TacticalRMM</code></li> <li>Choose \"Accounts in this organizational directory only\"</li> </ul> </li> <li> <p>Click Register</p> <p></p> <p></p> </li> </ol> <p>2. Tenant ID</p> <ol> <li> <p>Copy the \"Directory (tenant) ID\" and save it somewhere.</p> <p></p> </li> </ol> <p>3. API Permissions</p> <ol> <li> <p>Select \"API permissions\" from the left sidebar, click \"Add a permission\" &gt; \"Microsoft Graph\" &gt; \"Delegated permissions\" and select \"email\", \"offline_access\" and \"profile\"</p> <p></p> <p></p> </li> </ol> <p>4. Certificates and secrets</p> <ol> <li> <p>Select \"Certificates and secrets\" in the left sidebar, Select \"+ New client secret\", name it something like \"tacticalrmm\", choose and expiration date and make a note of the resulting secret value.</p> <p></p> <p></p> </li> </ol> <p>5. Add Provider in TRMM</p> <ol> <li> <p>Provider Name: <code>Microsoft</code></p> </li> <li> <p>Issuer URL: https://login.microsoftonline.com/replace with tenant ID/v2.0</p> <ul> <li>Replace the tenant ID with the ID from step 2 above.</li> <li>For example: <code>https://login.microsoftonline.com/cefd9a11-7c82-4795-81cd-06a91053e814/v2.0</code></li> </ul> </li> <li> <p>Client ID: copy this from the Overview tab in the Entra portal:</p> <p></p> </li> <li> <p>Secret: paste in the secret you copied from Step 4.</p> </li> <li> <p>Default User Role: choose a role.</p> </li> <li> <p>Click Submit</p> <p></p> </li> </ol> <p>6. Add Redirect URI</p> <ol> <li> <p>Copy the Callback URL from the TRMM Providers List</p> <p></p> </li> <li> <p>In the Entra portal, go to the Authentication tab in the left sidebar, click \"+ Add a platform\", choose \"Web\" and enter the Calllback URL you just copied.</p> <p></p> </li> <li> <p>Note: When logging in for the first time, you MUST check \"Consent on behalf of your organization\".</p> <p></p> </li> </ol>"},{"location":"ee/sso/sso/#authentik","title":"Authentik","text":"<p>Assumes you've already installed Authentik.</p> <p>Can use DNS name (recommended) or IP for Authentik server.</p> <p>In TRMM </p> <ul> <li>Click <code>Add OIDC Provider</code> button</li> <li>Give Provider Name: <code>Authentik</code></li> </ul> <p>In Authentik</p> <ul> <li>Create Provider &gt; OAuth2/OpenID Provider</li> <li>Name: <code>TacticalRMM</code></li> <li>Authentication Flow: <code>default-authentication-flow (Welcome to authentik!)</code></li> <li>Authorization flow: <code>default-provider-authorization-explicit-consent (Authorize Application)</code></li> <li>Client Type: Confidential</li> <li>Client ID: Copy from Authentik and paste into TRMM Client ID</li> <li>Client Secret: Copy from Authentik and paste into TRMM Secret</li> <li>Redirect URIs/Origins (Regex): Adjust this to your TRMM servers API URL and paste <code>https://&lt;TRMM API URL ie api.example.com&gt;/accounts/oidc/Authentik/login/callback/</code> (also found in the right-click menu of the TRMMs SSO Provider)</li> <li>Signing Key: <code>authentik Self-signed Certificate</code></li> </ul> <p></p> <p>Create Authentik Application</p> <ul> <li>Name: <code>TacticalRMM</code></li> <li>Slug: <code>tacticalrmm</code></li> <li>Provider: Choose <code>TacticalRMM</code> and Create</li> </ul> <p></p> <p>In TRMM</p> <ul> <li>Issuer URL: <code>https://&lt;your authentik IP or domain&gt;/application/o/tacticalrmm/.well-known/openid-configuration</code></li> <li>Select your desired Default User Role from TRMM Permissions</li> <li>Submit and test!</li> </ul> <p></p>"},{"location":"ee/sso/sso/#keycloak","title":"Keycloak","text":"<p>In TRMM</p> <ul> <li>Click <code>Add OIDC Provider</code> button</li> <li>Give Provider Name: <code>KeyCloak</code></li> </ul> <p>In KeyCloak</p> <ul> <li>Click Clients. Create client</li> <li>Client type: <code>OpenID Connect</code></li> <li>Client ID: <code>tacticalrmm</code>. Also paste into TRMM \"Client ID\" field</li> <li>Name: <code>TacticalRMM</code></li> <li>Hit Next</li> <li>Enable <code>Client Authentication</code></li> <li></li> <li>Hit Next</li> <li>Root URL: <code>https://&lt;TRMM rmm url ie rmm.tacticalrmm.app&gt;</code></li> <li>Enter Valid Redirect URL: <code>https://&lt;TRMM API URL ie api.example.com&gt;/accounts/oidc/KeyCloak/login/callback/</code></li> <li>Web Origins: <code>https://&lt;TRMM rmm url ie rmm.tacticalrmm.app&gt;</code></li> <li>Hit Save</li> <li>Go to Credentials tab and copy Client Secret.</li> </ul> <p>In TRMM</p> <ul> <li>Paste into TRMMs Secret field</li> <li>Issuer URL: <code>https://&lt;KeyCloak server dns/ip&gt;:8443/realms/master/.well-known/openid-configuration</code></li> <li>Set Default User Role and Submit</li> </ul> <p>In KeyCloak</p> <ul> <li>Create Role</li> </ul> <p>Users</p> <ol> <li>Create new user or use existing</li> <li>Go to Users and assign Role via Role Mapping</li> </ol> <p>Tactical RMM</p> <ol> <li>Add SSO Provider</li> <li>Name: <code>KeyCloak</code></li> <li>Client ID from step 1 in Create Client</li> <li>Secret from Step 8</li> <li>Assign default roles</li> <li>Save</li> </ol> <p></p>"},{"location":"ee/sso/sso/#authelia","title":"Authelia","text":"<p>Generate Client secret with https://www.authelia.com/integration/openid-connect/frequently-asked-questions/#client-secret</p> <p>Add config to bottom of Authelia Config (presumably all setup already)</p> <pre><code>identity_providers:\n  oidc:\n    ## The other portions of the mandatory OpenID Connect 1.0 configuration go here.\n    ## See: https://www.authelia.com/c/oidc\n    clients:\n    - client_id: 'tacticalrmm'\n        client_name: 'TacticalRMM'\n        client_secret: '$pbkdf2-sha512$310000$RJhFsh2Vz.18TX81znDaeA$wDEv6CQSE8zK8ApzfQyzd69fUjuIwSEduircgT/cQnlOm4qrgfxq9JMzmtGQrGV2ZgI812tomyqnFBGQrLXyWQ'\n        public: false\n        authorization_policy: 'two_factor'\n        require_pkce: true\n        pkce_challenge_method: 'S256'\n        redirect_uris:\n        - 'https://api.tacticalrmm.app/accounts/oidc/Authelia/login/callback/'\n        scopes:\n        - 'openid'\n        - 'profile'\n        - 'groups'\n        - 'email'\n        userinfo_signed_response_alg: 'none'\n        token_endpoint_auth_method: 'client_secret_basic'\n        pre_configured_consent_duration: '1 year'\n</code></pre>"},{"location":"ee/sso/sso/#warnings","title":"Warnings","text":"<p>Names AND vaLUES in TRMM and your SSO application are interdependant, must match and are cAse sEnsitive. Following these instructions and copying/pasting names exactly will result in successful connections.</p> <p></p> <p></p>"},{"location":"ee/sso/sso/#security","title":"Security","text":"<p>When using SSO, the security of your application depends on the configuration of your chosen authentication provider. While local TRMM accounts enforce mandatory 2FA for enhanced security, SSO providers may not require 2FA by default. To maintain strong security, ensure that your SSO provider is configured with 2FA or equivalent measures to protect user accounts.</p> <p>For those who have no interest in using this feature and want it completely disabled, SSO can be disabled at the filesystem level, which will override the setting in Global Settings in the web interface.</p> Disable SSO at the filesystem level  Standard install Docker install <p>Append the following variable to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> <pre><code>TRMM_DISABLE_SSO = True\n</code></pre></p> <p>Restart the following services: <code>sudo systemctl restart rmm daphne</code></p> <p>Add <code>TRMM_DISABLE_SSO=True</code> to your <code>.env</code> file and run <code>docker compose down &amp;&amp; docker compose up -d</code></p>"},{"location":"ee/sso/sso/#how-do-i-activate-sso-as-a-new-sponsor","title":"How do I activate SSO as a new sponsor?","text":"<p>Ignore the following if you're an existing sponsor upgrading from a version below 0.20.0, as SSO will automatically be activated for you during the upgrade process.</p> <ol> <li> <p>Make sure your server has an appropriate code signing token saved ( Settings &gt; Code Signing).</p> </li> <li> <p>Run the update script with the <code>--force</code> flag (see instructions below for standard vs docker installs):</p> </li> <li> <p>Hard reload the web page. Make sure you use your browser's reload button to hard reload the page.</p> </li> </ol>  Standard install Docker install <pre><code>cd ~\nwget -N https://raw.githubusercontent.com/amidaware/tacticalrmm/master/update.sh\nchmod +x update.sh\n./update.sh --force\n</code></pre> <pre><code>docker compose down\ndocker compose up -d\n</code></pre> <p>For any issues with activating SSO, open a ticket.</p>"},{"location":"ee/sso/sso/#troubleshooting","title":"Troubleshooting","text":"<p>Note</p> <p>SSO errors are typically logged on your provider's side. Check your authentication provider's error logs for more detailed messages.</p>"},{"location":"ee/sso/sso/#there-was-an-error-logging-into-your-provider","title":"There was an error logging into your provider","text":"<p>If you encounter the following error message: \"There was an error logging into your provider.\" this typically indicates one of the following issues:</p> <ol> <li> <p>Email Address Conflict</p> <p>This error often occurs if there is an existing TRMM local account with the same email address as the SSO account you are trying to log in with. To resolve this:</p> <ul> <li> <p>Option 1: Edit the TRMM local user and update its email address to a different value, such as <code>user@fakedomain.com</code>.  </p> <p>Note: The email address field for local users is not currently used for any functionality, so it can be set to any value.</p> </li> <li> <p>Option 2: Delete the conflicting TRMM local user.</p> </li> </ul> </li> <li> <p>Microsoft Entra Configuration Issue</p> <p>If you are using Microsoft Entra, this error may occur if you did not select the \"Consent on behalf of your organization\" option when first signing in. Ensure this option is checked during the initial login process.</p> <p></p> </li> </ol>"},{"location":"functions/alerting/","title":"Alerting Overview","text":"<p>Alerting and notifications can be managed centrally using Alert Templates. All an alert template does is configure the Email, Text, and Dashboard alert check boxes on Agents, Checks, and Automated Tasks.</p> <p>Using Alert Templates also enables additional features like:</p> <ul> <li>Periodic notifications if an alert is left unresolved.</li> <li>Being able to notify on certain alert severities.</li> <li>Sending notifications when an alert is resolved.</li> <li>Executing scripts when an alert is triggered or resolved.</li> </ul> <p>Setting up Email Alert Examples</p>"},{"location":"functions/alerting/#supported-notifications","title":"Supported Notifications","text":"<ul> <li>Email Alerts - Sends email to configured set of email addresses.</li> <li>SMS Alerts - Sends text messages to configured set of numbers.</li> <li>Dashboard Alerts - A notification popup will show up and be visible in the dashboard.</li> <li>Webhooks - Send an API request.</li> </ul>"},{"location":"functions/alerting/#alert-severities","title":"Alert Severities","text":"<p>Info</p> <p>Agent overdue alerts are always of severity: <code>Error</code></p> <p>Alert severities are configured directly on the Check or Automated Task. When the Check or Automated Task fails, it will create an alert of the specified severity. The severity types are:</p> <ul> <li>Informational</li> <li>Warning</li> <li>Error</li> </ul>"},{"location":"functions/alerting/#creating-alert-templates","title":"Creating Alert Templates","text":"<p>To create an alert template, go to Settings &gt; Alerts Manager, then click New.</p> <p>The available options are:</p>"},{"location":"functions/alerting/#general-settings","title":"General Settings","text":"<ul> <li>Name - The name that is used to identify the Alert Template in the dashboard.</li> <li>Email Recipients - Sets the list of email recipients. If this isn't set the email recipients in global settings will be used.</li> <li>From Email - Sets the From email address of the notification. If this isn't set the From address from global settings is used.</li> <li>SMS Recipients - Sets the list of text recipients. If this isn't set the sms list from global settings is used.</li> </ul>"},{"location":"functions/alerting/#alert-action-settings","title":"Alert Action Settings","text":"<p>For optionally triggering an additional task (Send a Web Hook, Run Script on Agent, Run script on TRMM Server) when desired (can be left blank for no action).</p>"},{"location":"functions/alerting/#alert-failure-settings-alert-resolved-settings","title":"Alert Failure Settings / Alert Resolved Settings","text":""},{"location":"functions/alerting/#send-a-web-hook","title":"Send a Web Hook","text":"<p>You can create your own webhooks to be sent out on alert failure/resolved events, like a script check or task failing or an agent going overdue.</p> <p>You have access to any of the variables as well as custom fields / global keystore inside the json payload of the webhook as well as in the URL patter.</p> <ol> <li> <p>Create your Web Hooks</p> </li> <li> <p>Choose the Web Hook you wish to be ran as the alert failure and/or resolved action.</p> </li> </ol>"},{"location":"functions/alerting/#run-script-on-agent","title":"Run script on Agent","text":"<ul> <li>Script - Runs the selected script once. It attempts to run it on the agent in question, but if not online TRMM selects a random agent to run on.</li> <li>Script arguments - Optionally pass in arguments to the script.</li> <li>Script environment vars - Optionally pass in env vars to the script.</li> <li>Action Timeout - Sets the timeout for the script.</li> </ul>"},{"location":"functions/alerting/#run-script-on-server","title":"Run script on Server","text":"<p>Warning</p> <p>This is a dangerous feature and you must ensure permissions are appropriate for your environment.</p> <p>This runs the script on your TRMM server. To ensure proper execution, you must specify the interpreter for your script using a shebang line at the top of each script. Also make sure that the specified interpreter is installed on your TRMM server.</p> <p>Just like with webhooks, you also have access to the same variables as well as custom fields / global keystore in the script's arguments or environment variables.</p>  Python (included with TRMM) Python (system python) Bash Powershell (7 PWSH) node (included with TRMM) deno (must be installed) <p>Shell type: <code>Shell</code></p> <pre><code>#!/rmm/api/env/bin/python\n\nimport sys\n\nprint(sys.version)\n</code></pre> <p>Shell type: <code>Shell</code></p> <pre><code>#!/usr/bin/python3\nimport sys\n\nprint(sys.version)\n</code></pre> <p>Shell type: <code>Shell</code></p> <pre><code>#!/usr/bin/env bash\n\necho \"hello world\"\n</code></pre> <p>To install: https://learn.microsoft.com/en-us/powershell/scripting/install/install-debian</p> <p>Shell type: <code>Powershell</code></p> <pre><code>#!/usr/bin/pwsh\n\nWrite-Output \"Hello World\"\n</code></pre> <p>Shell type: <code>Shell</code></p> <pre><code>#!/usr/bin/node\n\nconsole.log(\"Hello World\")\n</code></pre> <p>Shell type: <code>Deno</code></p> <pre><code>#!/usr/bin/env -S /usr/local/bin/deno run --allow-allow\n\nasync function gatherSystemInfo() {\nconst os = Deno.build.os;\nconst arch = Deno.build.arch;\nconst memory = Deno.systemMemoryInfo();\n\n\nconst info = `\nOS: ${os}\nArchitecture: ${arch}\nTotal Memory: ${(await memory).total / 1024 / 1024} MB\nFree Memory: ${(await memory).free / 1024 / 1024} MB\n`;\n\nconsole.log(info);\n}\n\ngatherSystemInfo().catch(console.error);\n</code></pre> <ul> <li>Script - Runs the selected script once on the TRMM server.</li> <li>Script arguments - Optionally pass in arguments to the script.</li> <li>Script environment vars - Optionally pass in env vars to the script.</li> <li>Action Timeout - Sets the timeout for the script.</li> </ul>"},{"location":"functions/alerting/#run-actions-only-on","title":"Run actions only on","text":"<p>Turn the switch on if you want the above Alert Failure/Alert Resolved script to run on:</p> <ul> <li>Agents - If Enabled, will run script failure / resolved actions on agent overdue alerts, else no alert actions will be triggered for agent overdue alerts.</li> <li>Checks - If Enabled, will run script failure / resolved actions on check alerts, else no alert actions will be triggered check alerts.</li> <li>Tasks - If Enabled, will run script failure / resolved actions on automated task alerts, else no alert actions will be triggered automated task alerts.</li> </ul>"},{"location":"functions/alerting/#agent-overdue-setting","title":"Agent Overdue Setting","text":"<ul> <li>Email - When Enabled, will send an email notification and override the Email Alert checkbox on the Agent / Check / Task. When Not Configured, the Email Alert checkbox on the Agent / Check / Task will take effect. If Disabled, no email notifications will be sent and will override any Email alert checkbox on the Agent / Check / Task.</li> <li>Text - When Enabled, will send a text notification and override the SMS Alert checkbox on the Agent / Check / Task. When Not Configured, the SMS Alert checkbox on the Agent / Check / Task will take effect. If Disabled, no SMS notifications will be sent and will override any SMS Alert checkbox on the Agent / Check / Task.</li> <li>Dashboard - When Enabled, will send a dashboard notification and override the Dashboard Alert checkbox on the Agent / Check / Task. When Not Configured, the Dashboard Alert checkbox on the Agent / Check / Task will take effect. If Disabled, no SMS notifications will be sent and will override any Dashboard Alert checkbox on the Agent / Check / Task.</li> <li>Alert again if not resolved after (days) - This sends another notification if the alert isn't resolved after the set amount of days. Set to 0 to disable this.</li> <li> <p>Alert on severity - Only applicable to Check and Task alert notifications. This will only send alerts when they are of the configured severity.</p> <p>Info</p> <p>Alert on Severity needs to be configured for check and task notifications to be sent!</p> </li> </ul>"},{"location":"functions/alerting/#check-settings-automated-task-settings","title":"Check Settings / Automated Task Settings","text":"<ul> <li>Email - If enabled, sends an email notification when an alert is resolved.</li> <li>Text - If enabled, sends a text messaged when an alert is resolved.</li> </ul>"},{"location":"functions/alerting/#applying-alert-templates","title":"Applying Alert Templates","text":"<p>Alert templates can be configured:</p> <ul> <li>Globally at the Server Level</li> <li>By Automation Policy</li> <li>Manually at the Client Level</li> <li> <p>Manually at the Site Level</p> </li> <li> <p>To apply Globally, navigate to Settings &gt; Global Settings. Set the Alert Template dropdown and save.</p> </li> <li>You can configure an alert template on an automation policy by navigating to Settings &gt; Automation Manager, and clicking the Assign Alert Template click on the policy, or right-clicking the policy and selecting Assign Alert Template.</li> <li>To configure on a Client or Site right-click on one in the Client / Site tree view and select Assign Alert Template.</li> </ul>"},{"location":"functions/alerting/#alert-template-exclusions","title":"Alert Template Exclusions","text":"<p>You can exclude Clients, Sites, and Agents from Alert Templates. To do this you can:</p> <ul> <li>Right-click on the Alert Template in Alerts Manager and select Exclusions.</li> <li>Select the Alert Exclusions link in the Alert Template row.</li> </ul> <p>You can also Exclude Desktops from the alert template. This is useful if you only care about servers.</p>"},{"location":"functions/alerting/#alert-template-inheritance","title":"Alert Template Inheritance","text":"<p>Alerts are applied in the following order. The agent picks the closest matching alert template.</p> <ol> <li>Policy w/ Alert Template applied to Site</li> <li>Site</li> <li>Policy w/ Alert Template applied to Client</li> <li>Client</li> <li>Default Alert Template</li> </ol>"},{"location":"functions/alerting/#setting-up-alert-severities-with-scripts","title":"Setting up Alert Severities with scripts","text":"<p>If scripting for alert severities please see below, </p> <ol> <li> <p>Create a script with exit codes. The exit codes can be anything other than 0 (which is reserved for passing). Below we are using 2 as a Warning and 5 as Informational, any other code will be assumed to be an Error)</p> <pre><code>If (!(test-path c:\\ProgramData\\TacticalRMM\\temp)) {\n    New-Item -ItemType Directory -Force -Path \"C:\\ProgramData\\TacticalRMM\\temp\"\n    $exitcode = 2\n    $host.SetShouldExit($exitcode)\n    exit\n}\nElse {\n    Write-Output \"found folder\"\n    $exitcode = 5\n    $host.SetShouldExit($exitcode)\n    exit\n}\n</code></pre> </li> <li> <p>Setup a script check and fill in the corresponding Warning and Informational codes (don't forget to hit enter). </p> </li> <li>Save script check and you should now have the different Severities.</li> </ol>"},{"location":"functions/api/","title":"API Access","text":""},{"location":"functions/api/#api-access","title":"API Access","text":"<p>Tactical RMM uses a Django Rest Framework backend which is designed to be consumed by a VueJS frontend.</p> <p>Therefore, anything you can do via the web interface, you can do via the API.</p> <p>However this makes it difficult to document the API as it has only been designed to be consumed by our vue frontend.</p> <p>The easiest way to see what endpoint/payload you need to send is to open your browser's developer tools &gt; Network tab. Then, perform the action you wish to do via the api in Tactical's web interface and watch the network tab to see the endpoint and the payload that is generated, and use that as an example of how to structure your api request.</p> <p>Please note that using an API key will bypass 2FA authentication.</p> <p>When creating the key you'll need to choose a user, which will reflect what permissions the key has based on the user's role.</p> <p>Navigate to Settings &gt; Global Settings &gt; API Keys to generate a key.</p> <p>Warning</p> <p>Pay attention to your trailing <code>/</code> they matter.</p> <p>Headers:</p> <pre><code>{\n    \"Content-Type\": \"application/json\",\n    \"X-API-KEY\": \"J57BXCFDA2WBCXH0XTELBR5KAI69CNCZ\"\n}\n</code></pre> <p>Example curl request:</p> <pre><code>curl https://api.example.com/clients/ -H \"X-API-KEY: Y57BXCFAA9WBCXH0XTEL6R5KAK69CNCZ\"\n</code></pre>"},{"location":"functions/api/#enable-swagger","title":"Enable Swagger","text":"<p>This will let you add a browser interface to see how you can use the API better.</p> <p>Open <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> and add</p> <pre><code>SWAGGER_ENABLED = True\n</code></pre> <p>Restart Django: <code>sudo systemctl restart rmm.service</code></p> <p>Then visit <code>https://api.example.com/api/schema/swagger-ui/</code> to see it in action.</p>"},{"location":"functions/api/#beta-api","title":"Beta API","text":"<p>Version added: Tactical RMM v0.16.5</p> <p>A beta API is now available at <code>/beta/v1</code> which supports filtering and pagination.</p> <p>To activate it, first enable swagger (see above) and then add the following line to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code>: <pre><code>BETA_API_ENABLED = True\n</code></pre></p> <p>Then restart Django with: <code>sudo systemctl restart rmm.service</code> and check Swagger for usage.</p>"},{"location":"functions/api/#querying-the-api","title":"Querying the API","text":"<p>Here are some examples:</p> Example Code  Python PowerShell 1 PowerShell 2 <p>Requests Windows Update check to run against agent ID</p> <pre><code>import requests\n\nAPI = \"http://api.example.com\"\nHEADERS = {\n    \"Content-Type\": \"application/json\",\n    \"X-API-KEY\": \"DKNRPTHSAPCKT8A36MCAMNZREWWWFPWI\",\n}\n\n\ndef trigger_update_scan():\n    agents = requests.get(f\"{API}/agents/?detail=false\", headers=HEADERS)\n    for agent in agents.json():\n        r = requests.post(f\"{API}/winupdate/{agent['agent_id']}/scan/\", headers=HEADERS)\n        print(r.json())\n\n\nif __name__ == \"__main__\":\n    trigger_update_scan()\n</code></pre> <pre><code># Example - Get all agents using API\n\n$headers = @{\n    'X-API-KEY' = 'ABC1234567890987654321'\n}\n\n$url = \"https://api.yourdomain.com/agents/\"\n\n$agentsResult = Invoke-RestMethod -Method 'Get' -Uri $url -Headers $headers -ContentType \"application/json\"\n\nforeach ($agent in $agentsResult) {\n    Write-Host $agent\n\n    #Write-Host $agent.hostname\n}\n</code></pre> <pre><code># Example - Send PowerShell command to agent.  Make sure to pass {{agent.agent_id}} as a parameter\n\nparam(\n    $AgentId\n)\n\n$headers = @{\n    'X-API-KEY' = 'ABC1234567890987654321'\n}\n\n$url = \"https://api.yourdomain.com/agents/$AgentId/cmd/\"\n\n$body = @{\n    \"shell\"   = \"powershell\"\n    \"cmd\"     = \"dir c:\\\\users\"\n    \"timeout\" = 30\n}\n\n$commandResult = Invoke-RestMethod -Method 'Post' -Uri $url -Body ($body|ConvertTo-Json) -Headers $headers -ContentType \"application/json\"\n\nWrite-Host $commandResult\n</code></pre>"},{"location":"functions/api/#running-a-script-on-an-agent-using-the-api","title":"Running a Script on an Agent Using the API","text":"<p>First get the script ID from the Script library by hovering your mouse over it in the script list and looking at the tooltip.</p> <p></p> <p><code>POST</code> to the endpoint <code>/agents/&lt;agentid&gt;/runscript/</code> this:</p> <pre><code>{\n    \"output\": \"forget\",\n    \"emails\": [],\n    \"emailMode\": \"default\",\n    \"custom_field\": null,\n    \"save_all_output\": false,\n    \"script\": 89, // primary key of script in postgres\n    \"args\": [\n        \"arg1\",\n        \"arg2\"\n    ],\n    \"env_vars\": [],\n    \"run_as_user\": false,\n    \"timeout\": 90 // seconds\n}\n</code></pre> Example: Run a script on an agent  PowerShell <pre><code>$apiUrl = 'https://api.example.com/agents/CHANGEME/runscript/'\n\n$jsonPayload = @{\n    output = \"wait\"\n    emails = @()\n    emailMode = \"default\"\n    custom_field = $null\n    save_all_output = $false\n    script = 89\n    args = @()\n    env_vars = @()\n    run_as_user = $false\n    timeout = 90\n} | ConvertTo-Json\n\n\n$headers = @{\n    'Content-Type' = 'application/json'\n    'X-API-KEY' = 'changeme'\n}\n\n$response = Invoke-RestMethod -Uri $apiUrl -Method Post -Body $jsonPayload -Headers $headers\n$response\n</code></pre>"},{"location":"functions/api/#api-via-cli","title":"API via CLI","text":"<p>https://gitlab.com/NiceGuyIT/trmm-cli</p>"},{"location":"functions/api/#api-examples","title":"API Examples","text":""},{"location":"functions/api/#listing-all-software-on-all-agents","title":"Listing all software on all agents:","text":"<pre><code>import requests\n\nAPI = \"https://api.example.com\"\nHEADERS = {\n    \"Content-Type\": \"application/json\",\n    \"X-API-KEY\": \"9SI43IFUMPEVRWOZR4NC8PGP4ZLA9PYX\",\n}\n\ndef get_software():\n    agents = requests.get(f\"{API}/agents/?detail=false\", headers=HEADERS)  # get a list of all agents\n    for agent in agents.json():  # loop thru all agents and print list of installed software\n        r = requests.get(f\"{API}/software/{agent['agent_id']}/\", headers=HEADERS)\n        print(r.json())\n\nif __name__ == \"__main__\":\n    get_software()\n</code></pre>"},{"location":"functions/api/#list-agents","title":"List Agents","text":"<pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Agents_Endpoint = GetURL(\"agents\")\n$Agents = Invoke-RestMethod $Agents_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n# $Agents | ConvertTo-Json\n$Agents.foreach({ $_ }) | Select-Object Agent_ID, Hostname, Site_Name, Client_Name, Monitoring_Type | Format-Table\n</code></pre>"},{"location":"functions/api/#list-tasks","title":"List Tasks","text":"<pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Tasks_Endpoint = GetURL(\"tasks\")\n$Response = Invoke-RestMethod $Tasks_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n# $Response | ConvertTo-Json\n$Response.foreach({ $_ }) | Select-Object ID, Policy, Name, Custom_Field | Format-Table\n</code></pre>"},{"location":"functions/api/#get-custom-fields","title":"Get Custom Fields","text":"<pre><code>$TRMM_API_Base_Endpoint = Read-Host \"Please provide your API domain i.e https://api.domain.com\"\n$TRMM_API_Key = Read-Host \"Please provide your API Key\"\n\n$TRMM_API_CustomFields_Endpoint = $TRMM_API_Base_Endpoint + \"/core/customfields\"\n\n$TRMM_Request_Headers = @{\n\n    \"X-API-KEY\" = $TRMM_API_Key\n\n}\n\n$Request = Invoke-RestMethod $TRMM_API_CustomFields_Endpoint -Headers $TRMM_Request_Headers -Method Get\n\n$TRMM_Agent_ExistingCustomFields = ($Request | ? {$_.model -eq 'Agent'})\n\n# Gets all of the Windows Features and places it in an array to parse later\n# This is to ensure that TRMM has all Windows Feature roles available as a Custom Field\n$AllWindowsFeatures = Get-WindowsFeature\n$TRMM_Role_AllCustomFields = @()\n\nforeach($WindowsFeature in $AllWindowsFeatures){\n\n    if($WindowsFeature.Depth -eq 1){\n\n        $PrimaryRole = $WindowsFeature.DisplayName\n\n    } else {\n\n        $TRMM_Role_AllCustomFields += [PSCustomObject]@{\n\n            \"Role\" = $PrimaryRole\n            \"Value\" = $WindowsFeature.DisplayName\n\n        }\n\n    }\n\n}\n\n$Unique_Roles = $TRMM_Role_AllCustomFields | Select -Unique Role\n#Loop through each WindowsFeature\nforeach($WindowsFeature in $Unique_Roles){\n\n    if($TRMM_Agent_ExistingCustomFields.Name -like \"*$($WindowsFeature.Role)*\"){\n\n        # Need to check if it also contains the value\n\n    } else {\n\n        # Check to see if the Role is an Array or an Object\n        # Convert to Array otherwise\n\n        if((($TRMM_Role_AllCustomFields | ? {$_.Role -eq $WindowsFeature.Role}).Value) -isnot [array]){\n\n            $CustomFieldOptions = @(($TRMM_Role_AllCustomFields | ? {$_.Role -eq $WindowsFeature.Role}).Value)\n\n        } else {\n\n            $CustomFieldOptions = ($TRMM_Role_AllCustomFields | ? {$_.Role -eq $WindowsFeature.Role}).Value\n\n        }\n\n        # Create the Custom Field body\n        $CustomFieldData = @{\n\n            model = \"agent\"\n            name = \"Server Role - \" + $WindowsFeature.Role\n            type = \"multiple\"\n            options = $CustomFieldOptions\n\n        }\n\n        $CreateCustomField = Invoke-RestMethod $TRMM_API_CustomFields_Endpoint -Headers $TRMM_Request_Headers -Method Post -Body ($CustomFieldData | ConvertTo-Json) -ContentType \"application/json\"\n\n    }\n}\n</code></pre>"},{"location":"functions/api/#get-custom-fields_1","title":"Get Custom Fields","text":"<p>https://discord.com/channels/736478043522072608/888474369544847430/1004184193078669522</p> <pre><code>import requests\nimport json\n\nAPI = \"https://api.example.com\"\nHEADERS = {\n    \"Content-Type\": \"application/json\",\n    \"X-API-KEY\": \"changeme\",\n}\n\npayload = {\"custom_fields\": [{\"string_value\": \"66666\", \"field\": 2}]}\n\nr = requests.put(\n    f\"{API}/agents/IcAhWvOHlADwjuYmndAkjbJuhSdWvWjtvYcYjCZk/\",\n    data=json.dumps(payload),\n    headers=HEADERS,\n)\n\nprint(r.__dict__)\n</code></pre>"},{"location":"functions/api/#create-collector-tasks","title":"Create Collector Tasks","text":"<p>https://discord.com/channels/736478043522072608/888474369544847430/1004383584070676610</p> <pre><code># Query the TRMM API with PowerShell\n\n# Add this to dotenv.ps1\n#$TRMM_API_KEY = \"\"\n#$TRMM_API_DOMAIN = \"\"\n. .\\dotenv.ps1\n\nfunction GetURL {\n    param (\n        [string] $Path\n    )\n    return \"https://${TRMM_API_DOMAIN}/${Path}/\"\n}\n\n$Headers = @{\n    'X-API-KEY' = $TRMM_API_KEY\n}\n\n$Collector = [PSCustomObject]@{\n    policy = 1\n    actions = @(@{\n        name = \"Collector - Location - City and State\"\n        type = \"script\"\n        script = 121\n        timeout = 90\n        script_args = @()\n    })\n    assigned_check = $null\n    custom_field = 14\n    name = \"Get city and state from API\"\n    # expire_date = $null\n    run_time_date = \"2022-08-02T08:00:00Z\"\n    # run_time_bit_weekdays = $null\n    weekly_interval = 1\n    daily_interval = 1\n    # monthly_months_of_year = $null\n    # monthly_days_of_month = $null\n    # monthly_weeks_of_month = $null\n    # task_instance_policy = 0\n    # task_repetition_interval = $null\n    # task_repetition_duration = $null\n    # stop_task_at_duration_end = $false\n    # random_task_delay = $null\n    # remove_if_not_scheduled = $false\n    run_asap_after_missed = $true\n    task_type = \"daily\"\n    alert_severity = \"info\"\n    # collector_all_output = $false\n    # continue_on_error = $false\n}\n\n$Tasks_Endpoint = GetURL(\"tasks\")\n$Payload = $Collector | ConvertTo-Json\n$Response = Invoke-RestMethod $Tasks_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Post\" -Body $Payload\nif (! $?) {\n    Write-Output \"Failed to submit request: $($error[0].ToString() )\"\n    Write-Output \"Stacktrace: $($error[0].Exception.ToString() )\"\n    Exit(1)\n}\n$Response | ConvertTo-Json\n</code></pre>"},{"location":"functions/api/#show-tasks","title":"Show Tasks","text":"<pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Tasks_Endpoint = GetURL(\"tasks\")\n$Response = Invoke-RestMethod $Tasks_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n# $Response | ConvertTo-Json\n$Response.foreach({ $_ }) | Select-Object ID, Policy, Name, Custom_Field | Format-Table\n</code></pre>"},{"location":"functions/api/#show-taskcollector-results","title":"Show Task/collector results","text":"<pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Agents_Endpoint = GetURL(\"agents\")\n$Agents = Invoke-RestMethod $Agents_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n# $Agents | ConvertTo-Json\n# $Agents.foreach({ $_ }) | Select-Object Agent_ID, Hostname, Site_Name, Client_Name, Monitoring_Type | Format-Table\n$Agent_ID = \"AGENT ID FROM TABLE\"\n\n$Agents.foreach({\n    if ($_.Agent_ID -ne $Agent_ID) {\n        return\n    }\n    $Fields_Endpoint = GetURL(\"agents/$($_.Agent_ID)/tasks\")\n    $Fields = Invoke-RestMethod $Fields_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n    # $Fields | ConvertTo-Json\n    $Fields.foreach({ $_ }) | Select-Object ID, Check_Name, Name, Actions, Task_Result | Format-Table\n})\n</code></pre> <p>or to see results</p> <pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Agents_Endpoint = GetURL(\"agents\")\n$Agents = Invoke-RestMethod $Agents_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n# $Agents | ConvertTo-Json\n# $Agents.foreach({ $_ }) | Select-Object Agent_ID, Hostname, Site_Name, Client_Name, Monitoring_Type | Format-Table\n$Agent_ID = \"AGENT ID FROM TABLE\"\n\n$Agents.foreach({\n    if ($_.Agent_ID -ne $Agent_ID) {\n        return\n    }\n    $Fields_Endpoint = GetURL(\"agents/$($_.Agent_ID)/tasks\")\n    $Fields = Invoke-RestMethod $Fields_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\n    # $Fields | ConvertTo-Json\n    $Fields.foreach({\n        $_.Task_Result | Format-Table\n     })\n})\n</code></pre>"},{"location":"functions/api/#list-custom-fields-of-agent","title":"List Custom Fields of Agent","text":"<pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Agent_ID = \"ENTER AGENT ID HERE\"\n$Agents_Endpoint = GetURL(\"agents/$($Agent_ID)\")\n$Agents = Invoke-RestMethod $Agents_Endpoint -Headers $Headers -ContentType \"application/json\" -Method \"Get\"\nConvertTo-Json $Agents.Custom_Fields\n$Agents.Custom_Fields\n</code></pre>"},{"location":"functions/api/#update-custom-fields","title":"Update Custom Fields","text":"<p>https://discord.com/channels/736478043522072608/888474369544847430/1004422340815360111</p> <p>This will update the custom fields for an agent. The field value come from the custom fields two posts above. Other fields that exist will not be updated. If you want to update only 1 custom field, use only 1 entry in the array.</p> <pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Agent_ID = \"AGENT ID GOES HERE\"\n$Endpoint = GetURL(\"agents/$($Agent_ID)\")\n\n$Custom_Fields = [PSCustomObject]@{\n    custom_fields = @(\n        @{\n            field = 13\n            string_value = \"Value updated from the API\"\n        },\n        @{\n            field = 14\n            string_value = \"Another value from the API\"\n        }\n    )\n}\n\n$Payload = $Custom_Fields | ConvertTo-Json\n$Response = Invoke-RestMethod $Endpoint -Headers $Headers -ContentType \"application/json\" -Method Put -Body $Payload\nif (! $?) {\n    Write-Output \"Failed to submit request: $($error[0].ToString() )\"\n    Write-Output \"Stacktrace: $($error[0].Exception.ToString() )\"\n    Exit(1)\n}\n$Response | ConvertTo-Json\n</code></pre>"},{"location":"functions/api/#list-service-information-from-agent","title":"List service information from Agent","text":"<pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n$Payload = [PSCustomObject]@{\n    code = [string](Get-Content -Path .\\TRMM-Run-Cmd-Remote.ps1 -Raw -Encoding UTF8)\n    timeout = 90\n    args = @()\n    shell = \"powershell\"\n}\n\n$Agent_ID = \"ENTER AGENT ID HERE\"\n$Rest_Params = @{\n    Uri = GetURL(\"scripts/${Agent_ID}/test\")\n    Headers = $Headers\n    ContentType = \"application/json\"\n    Method = \"POST\"\n    Body = $Payload | ConvertTo-Json\n}\n# Write-Output $Rest_Params[\"Body\"]\n\n# Prefer to handle the error ourselves rather than fill the screen with red text.\n$ErrorActionPreference = 'SilentlyContinue'\n\n$Response = Invoke-RestMethod @Rest_Params\nif (! $?) {\n    Write-Output \"Failed to submit request: $($error[0].ToString() )\"\n    Write-Output \"Stacktrace: $($error[0].Exception.ToString() )\"\n    Exit(1)\n}\n# $Response | ConvertTo-Json\n$Services = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($Response))\nConvertFrom-Json $Services\n</code></pre>"},{"location":"functions/api/#combining-scripts","title":"Combining scripts","text":"<p>This will iterate over all agents, filter out non-Windows and offline agents, run the PowerShell above to the first 5 services that are running, and compile the information in a Servers array.</p> <pre><code># Query the TRMM API with PowerShell\n. .\\dotenv.ps1\n\n# Default parameters. Body is missing because GET does not include the body.\n$Rest_Params = @{\n    Uri = \"\"\n    Headers = $Headers\n    ContentType = \"application/json\"\n    Method = \"GET\"\n}\n\n# Prefer to handle the error ourselves rather than fill the screen with red text.\n$ErrorActionPreference = 'SilentlyContinue'\n\n$Rest_Params[\"Uri\"] = GetURL(\"agents\")\n$Agents = Invoke-RestMethod @Rest_Params\nif (! $?) {\n    Write-Output \"Failed to get list of agents from API: $($error[0].ToString() )\"\n    Write-Output \"Stacktrace: $($error[0].Exception.ToString() )\"\n    Exit(1)\n}\n\n# Remote command to run.\n$Payload = [PSCustomObject]@{\n    # Without the type casting to [string], this was returning properties relating to Get-Content.\n    code = [string](Get-Content -Path .\\TRMM-Run-Cmd-Remote.ps1 -Raw -Encoding UTF8)\n    timeout = 90\n    args = @()\n    shell = \"powershell\"\n}\n\n$Rest_Params[\"Body\"] = [string]($Payload | ConvertTo-Json)\n$Rest_Params[\"Method\"] = \"POST\"\n$Servers = @()\nforeach($Agent in $Agents) {\n    # Build this object to match your needs.\n    $Server = [PSCustomObject]@{\n        Agent_ID = $Agent.agent_id\n        # Services = \"Error / Unavailable\"\n        Service_Name = \"N/A\"\n        Service_Status = \"N/A\"\n        Service_DisplayName = \"N/A\"\n        Hostname = $Agent.hostname\n        Platform = $Agent.plat\n        Status = $Agent.status\n    }\n\n    if ($Agent.plat -ne \"windows\" -or $Agent.status -ne \"online\") {\n        # Only process online Windows agents. Add other checks as necessary.\n        # Uncomment this if you want to include filtered servers in the output.\n        # $Servers += $Server.PSObject.Copy()\n        continue\n    }\n\n    $Rest_Params[\"Uri\"] = GetURL(\"scripts/$($Agent.Agent_ID)/test\")\n    $Response = Invoke-RestMethod @Rest_Params\n    if (! $?) {\n        $Servers += $Server.PSObject.Copy()\n        continue\n    }\n\n    # Create a new server object for every item returned from the remote agent (Services in this case).\n    $Services = ConvertFrom-Json ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($Response)))\n    foreach($Service in $Services) {\n        $Server.Service_Name = $Service.Name\n        $Server.Service_Status = $Service.Status\n        $Server.Service_DisplayName = $Service.DisplayName\n        $Servers += $Server.PSObject.Copy()\n    }\n}\n\n$Servers | Format-Table Agent_ID, Hostname, Status, Service_Name, Service_Status, Service_DisplayName\n# $Servers\n</code></pre>"},{"location":"functions/api/#pulling-audit-logs","title":"Pulling Audit Logs","text":"<pre><code>&lt;?php\n$ApiKey = \"XXX\";\n$BasicUrl = \"https://api.trmm.xxx.xxx/\";\n$Url = \"/logs/audit/\";\n$curl = curl_init();\n\ncurl_setopt($curl, CURLOPT_URL, $BasicUrl.$Url);\n\n$payload = '{\"pagination\":{\"sortBy\":\"entry_time\",\"descending\":true,\"page\":1,\"rowsPerPage\":1000,\"rowsNumber\":2},\"agentFilter\":[\"QFhdnzJcFnodMibCGJYmfIwRyjgIazjajjMSvVWX\"],\"actionFilter\":[\"modify\"]}';\ncurl_setopt($curl, CURLOPT_POSTFIELDS, $payload);\n\ncurl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n$headers = ['Content-Type: application/json', 'X-API-KEY: '.$ApiKey];\ncurl_setopt($curl, CURLOPT_HTTPHEADER, $headers);\n\ncurl_setopt($curl, CURLOPT_CUSTOMREQUEST, 'PATCH');\n\n$data = curl_exec($curl);\n\ncurl_close($curl);\n\n$audit = json_decode($data, true);\n\nvar_dump($audit);\n\n?&gt;\n</code></pre>"},{"location":"functions/api/#update-software-using-api","title":"Update software using API","text":"<pre><code>#!/rmm/api/env/bin/python\n\nimport concurrent.futures\nimport requests\n\nAPI = \"https://api.CHANGEME.com\"\nAPI_KEY = \"CHANGEME\"\n\nHEADERS = {\n    \"Content-Type\": \"application/json\",\n    \"X-API-KEY\": API_KEY,\n}\n\nMAX_WORKERS = 10\n\n\ndef create_list_of_urls():\n    ret = []\n    agents = requests.get(f\"{API}/agents/?detail=false\", headers=HEADERS)\n    for agent in agents.json():\n        ret.append(f\"{API}/software/{agent['agent_id']}/\")  # refresh software endpoint\n\n    return ret\n\n\ndef do_software_refresh(url):\n    r = requests.put(url, headers=HEADERS)\n    return r.json()\n\n\nwith concurrent.futures.ThreadPoolExecutor(max_workers=MAX_WORKERS) as executor:\n    futures = []\n    for url in create_list_of_urls():\n        futures.append(executor.submit(do_software_refresh, url))\n\n    for future in concurrent.futures.as_completed(futures):\n        print(future.result())\n</code></pre>"},{"location":"functions/automated_checks/","title":"Checks","text":""},{"location":"functions/automated_checks/#checks-vs-tasks","title":"Checks vs Tasks","text":""},{"location":"functions/automated_checks/#when-to-use-checks-for-scripts","title":"When to Use Checks for Scripts","text":"<ul> <li>Define custom return codes for Information and Warning levels.</li> <li>Configure alerts only after a specified number of consecutive failures.</li> </ul>"},{"location":"functions/automated_checks/#when-to-use-tasks-for-scripts","title":"When to Use Tasks for Scripts","text":"<ul> <li>Execute multiple commands and/or scripts in sequence.</li> <li>Leverage advanced scheduling options for flexibility.</li> </ul>"},{"location":"functions/automated_checks/#how-often-are-checks-run","title":"How Often Are Checks Run?","text":"<p>The frequency of checks is controlled at two levels:</p> <ol> <li> <p>Per Check Configuration    Each check has a Run Check Every (seconds) setting. Setting this to 0 defaults to the agent's global value.</p> </li> <li> <p>Agent Default Configuration    The default check frequency for the agent is set under Edit Agent &gt; General in the Run Checks Every field. The default value is 120 seconds.</p> </li> </ol>"},{"location":"functions/automated_checks/#best-practices","title":"Best Practices","text":"<ul> <li>Use Automation Policies to apply checks efficiently.</li> <li>Customize the frequency of individual checks as needed.</li> </ul>"},{"location":"functions/automated_tasks/","title":"Automated Tasks","text":"<p>An Automated Task allows you to run scripts and/or commands on an agent, with flexible scheduling options.</p>"},{"location":"functions/automated_tasks/#task-triggers","title":"Task Triggers","text":""},{"location":"functions/automated_tasks/#time-based","title":"Time-Based","text":"<ul> <li>Daily, Weekly, or Monthly: Schedule tasks to run at regular intervals, as expected. Note: On Linux and macOS, tasks will execute based on the \"Start Time\" field, ignoring the date portion. For example, a daily task set to start at 12:55 PM will run at that time every day starting from when the task is created.</li> <li>Run Once:  <ul> <li>For future dates, tasks run as scheduled.  </li> <li>For past dates, tasks are created to run 5 minutes after being registered with the Windows Task Scheduler. This ensures the task runs at least once, as the scheduler will not execute tasks with past \"Run Once\" dates.</li> </ul> </li> </ul>"},{"location":"functions/automated_tasks/#on-check-failure","title":"On Check Failure","text":"<p>Automatically trigger a script to address issues when a Check fails.</p>"},{"location":"functions/automated_tasks/#onboarding","title":"Onboarding","text":"<p>Use this type of task to execute \"Run Once\" scripts during agent onboarding. These tasks run immediately after the task is created on the agent, which happens a few minutes after the install of a new agent.</p> <p>Ideal for:     - Setting workstation defaults     - Installing software     - Configuring machines  </p> <p>Integrate these tasks with Automation Policies to streamline the setup of new devices.</p>"},{"location":"functions/automated_tasks/#manual","title":"Manual","text":"<p>Manually triggered tasks for on-demand operations. Example: A Windows Defender Cleanup Task might perform the following when manually triggered: 1. Delete all Shadow Copies from VSS. 2. Create a new VSS Snapshot. 3. Clear Defender logs to prevent duplicate alerts. 4. Run a full Defender scan.  </p> <p>This is useful for addressing alerts about Defender detections (e.g., malware or adware in download folders).</p>"},{"location":"functions/automated_tasks/#task-actions","title":"Task Actions","text":"<ul> <li>Execute any script from your Script Library, or use Batch or PowerShell commands.</li> <li>Configure multiple scripts/commands to run sequentially.  </li> <li>Optionally continue or halt the sequence based on errors.</li> </ul>"},{"location":"functions/automated_tasks/#collector-tasks","title":"Collector Tasks","text":"<p>Collector tasks allow you to save script output directly to a custom field.</p>"},{"location":"functions/automated_tasks/#how-to-create-collector-tasks","title":"How to Create Collector Tasks","text":"<ol> <li>Add the task to an Automation Policy or directly to an agent.  </li> <li>During task creation:</li> <li>Select the Collector checkbox.</li> <li>Choose the custom field where the output should be saved.</li> </ol> <p>Note</p> <p>Currently, you can only save data to agent-level custom fields.</p> <p>For more details, see Custom Fields and Scripting.</p>"},{"location":"functions/automation_policies/","title":"Automation Policies","text":"<p>Automation policies in Tactical RMM allow for mass deployment of Checks, Automated Tasks, Patch Policies, and Alert Templates. You can apply Automation Policies to:</p> <ul> <li>Global Settings</li> <li>Client</li> <li>Site</li> <li>Agent</li> </ul> <p>You can also see a list of Relations that show what policy is applied to what Clients / Sites / Agents.</p> <p></p> <p>Before you ask, multiple automation policies per level is in the todo list.</p>"},{"location":"functions/automation_policies/#creating-automation-policies","title":"Creating Automation Policies","text":"<p>In the dashboard, navigate to Settings &gt; Automation Manager. Use the Add button to create a blank Automation Policy. The options available are:</p> <ul> <li>Name - The name that will be used to identify the automation policy in the dashboard.</li> <li>Description - Optional description of the automation policy.</li> <li>Enabled - Specifies if the automation policy is active or not.</li> <li>Enforced - Specifies that the automation policy should overwrite any conflicting checks configured directly on the agent.</li> </ul>"},{"location":"functions/automation_policies/#policy-inheritance","title":"Policy Inheritance","text":"<p>They get applied in this order:</p> <ol> <li>Global Settings</li> <li>Client</li> <li>Site</li> <li>Agent</li> </ol> <p>At each level you can block policy inheritance from the level above using checkboxes in the appropriate screens.</p>"},{"location":"functions/automation_policies/#adding-windows-patch-management-policy","title":"Adding Windows Patch Management Policy","text":"<p>Under the Automation Manager you can create a Patch Policy and control what patches are applied, when, and if the computer is rebooted after.</p> <p>Note</p> <p>Most \"regular\" Windows patches are listed in the \"Other\" category.</p>"},{"location":"functions/custom_fields/","title":"Custom Fields","text":"<p>Warning</p> <p><code>\\</code> is an escape character, if you want to use that in a custom field you will need to use <code>\\\\</code> instead.</p>"},{"location":"functions/custom_fields/#adding-custom-fields","title":"Adding Custom Fields","text":"<p>In the dashboard, go to Settings &gt; Global Settings &gt; Custom Fields and click Add Custom Field.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive.</p> <p>The following options are available to configure on custom fields:</p> <ul> <li>Model - This is the object that the custom field will be added to. The available options are:<ul> <li>Agent</li> <li>Site</li> <li>Client</li> </ul> </li> <li>Name - Sets the name of the custom field. This will be used to identify the custom field in the dashboard and in scripts.</li> <li>Field Type - Sets the type of field. Below are the allowed types.<ul> <li>Text</li> <li>Number</li> <li>Single select dropdown</li> <li>Multi-select dropdown</li> <li>Checkbox (<code>1</code> = Checked or <code>$null</code> = Unchecked)</li> <li>DateTime</li> </ul> </li> <li>Input Options - Only available on Single and Multiple-select dropdowns. Sets the options to choose from.</li> <li>Default Value - If no value is found when looking up the custom field; this value will instead be supplied.</li> <li>Required - This makes the field required when adding new Clients, Sites, and Agents If this is set a default value will need to be set as well.</li> <li>Hide in Dashboard - This will not show the custom field in Client, Site, and Agent forms in the dashboard. This is useful if the custom field's value is updated by a collector task and only supplied to scripts.</li> </ul>"},{"location":"functions/custom_fields/#using-custom-fields-in-the-dashboard","title":"Using Custom Fields in the Dashboard","text":"<p>Once the custom fields are added, they will show up in the Client, Site, and Agent Add / Edit forms.</p>"},{"location":"functions/custom_fields/#using-custom-fields-in-scripts","title":"Using Custom Fields in Scripts","text":"<p>Tactical RMM allows for passing various database fields for Clients, Sites, and Agents in scripts. This includes custom fields as well! </p> <p>Warning</p> <p>The characters within the brackets are case-sensitive!</p> <p>In your script's arguments, use the notation <code>{{client.AV_KEY}}</code>. This will lookup the client for the agent that the script is running on and find the custom field named <code>AV_KEY</code> and replace that with the value.</p> <p>The same is also true for <code>{{site.no_patching}}</code> and <code>{{agent.Another Field}}</code>.</p> <p>For more information see SCRIPTING PAGE.</p>"},{"location":"functions/custom_fields/#populating-custom-fields-automatically","title":"Populating Custom Fields Automatically","text":"<p>Tactical RMM supports automatically collecting information and saving them directly to custom fields. This is made possible by creating Collector Tasks. These are just normal Automated Tasks, but instead they will save the last line of the standard output to the custom field that is selected.</p> <p>Info</p> <p>To populate a multiple select custom field, return a string with the options separated by a comma <code>\"This,will,be,an,array\"</code>.</p> <p>For more information See Collector Tasks.</p>"},{"location":"functions/custom_fields/#video-walkthru","title":"Video Walkthru","text":""},{"location":"functions/django_admin/","title":"Django Admin","text":"<p>Warning</p> <p>Do not use the Django admin unless you really know what you're doing.You should never need to access it unless you are familiar with Django or are instructed to do something here by one of the developers.</p> <p>The Django admin is basically a web interface for the postgres database.</p> <p>As of Tactical RMM v0.4.19, the Django admin is disabled by default.</p> <p>To enable it, edit <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> and change <code>ADMIN_ENABLED</code> from <code>False</code> to <code>True</code> then run these 2 commands:</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py collectstatic --no-input\n\nsudo systemctl restart rmm.service\n</code></pre> <p>Login to the Django admin using the same admin credential that was created during the <code>install.sh</code> script (ie the web ui login).</p> <p>If you did not save the Django admin url (which was printed out at the end of the install script), check the <code>local_settings.py</code> file referenced above for the <code>ADMIN_URL</code> variable. Then simply append the value of this variable to your api domain (<code>https://api.EXAMPLE.COM/</code>) to get the full url.</p> <p>Example of a full Django admin url: <pre><code>https://api.example.com/JwboKNYb3v6K93Fvtcz0G3vUM17LMTSZggOUAxa97jQfAh0P5xosEk7u2PPkjEfdOtucUp/\n</code></pre></p>"},{"location":"functions/emailsms_alert/","title":"Email and SMS Setup","text":""},{"location":"functions/emailsms_alert/#email-setup","title":"Email Setup","text":"<p>Under Settings &gt; Global Settings &gt; Email Alerts</p>"},{"location":"functions/emailsms_alert/#setting-up-tactical-rmm-alerts-using-open-relay","title":"Setting up Tactical RMM Alerts using Open Relay","text":"<p>MS 365 in this example</p> <ol> <li>Log into Tactical RMM</li> <li>Go to Settings</li> <li>Go to Global Settings</li> <li>Click on Alerts</li> <li>Enter the email address (or addresses) you want to receive alerts to eg info@EXAMPLE.COM</li> <li>Enter the from email address (this will need to be part of your domain on 365, however it doesn\u2019t need a license) eg rmm@EXAMPLE.COM</li> <li>Go to MXToolbox.com and enter your domain name in, copy the hostname from there and paste into Host</li> <li>Change the port to 25</li> <li>Click Save</li> <li>Login to admin.microsoft.com</li> <li>Go to Exchange Admin Centre</li> <li>Go to \u201cConnectors\u201d under \u201cMail Flow\u201d</li> <li>Click to + button</li> <li>In From: select \u201cYour organizations email server\u201d</li> <li>In To: select \u201cOffice 365\u201d</li> <li>Click Next</li> <li>In the Name type in RMM</li> <li>Click By Verifying that the IP address\u2026\u2026</li> <li>Click +</li> <li>Enter your IP and Click OK</li> <li>Click Next</li> <li>Click OK</li> </ol>"},{"location":"functions/emailsms_alert/#setting-up-tactical-rmm-alerts-using-username-password","title":"Setting up Tactical RMM Alerts using username &amp; password","text":"<p>Gmail in this example</p> <ol> <li>Log into Tactical RMM</li> <li>Go to Settings</li> <li>Go to Global Settings</li> <li>Click on Alerts</li> <li>Enter the email address (or addresses) you want to receive alerts to eg info@EXAMPLE.COM</li> <li>Enter the from email address myrmm@gmail.com</li> <li>Tick the box \u201cMy server requires Authentication\u201d  </li> <li>Enter your username e.g. myrmm@gmail.com</li> <li>Enter your password</li> <li>Change the port to 587</li> <li>Click Save</li> </ol>"},{"location":"functions/emailsms_alert/#sms-alerts","title":"SMS Alerts","text":"<p>Under Settings &gt; Global Settings &gt; SMS Alerts</p> <p>Currently Twilio is the only support SMS service</p> <p>Setup an Auth Token, and copy the data to the relevant fields</p> <p></p>"},{"location":"functions/examples/","title":"Examples","text":""},{"location":"functions/examples/#create-run-url-action-to-computer-support-page","title":"Create Run URL Action to Computer support page","text":"<p>This will create a URL link that will take you to the support page for a computer based on the computers Serial Number</p> <ol> <li> <p>Goto <code>Settings | Global Settings | Custom Fields</code> </p> <p>Under Agents tab Add Custom Field (CaSe SeNsItIve)</p> <p></p> </li> <li> <p>Create Task (best to use <code>Settings | Automation Manager</code> if you want to apply it to all computers). Add script that has an output of the data you want.</p> <p></p> </li> <li> <p>Create URL Action (under <code>Settings | Global Settings | URL ACTIONS</code>) for Manufacturer websites</p> <p></p> </li> </ol> <p>Dell Support Page</p> <pre><code>https://www.dell.com/support/home/en-us/product-support/servicetag/{{agent.SerialNumber}}/overview\n</code></pre> <p>Lenovo  Support Page</p> <pre><code>https://pcsupport.lenovo.com/us/en/products/{{agent.SerialNumber}}\n</code></pre> <p>HP Support Page</p> <p>It gives an errors because the product model doesn't match the serial number. If you figure out a better link please let us know! :)</p> <pre><code>https://support.hp.com/us-en/product/hp-pro-3500-microtower-pc/5270849/model/5270850?serialnumber={{agent.SerialNumber}}\n</code></pre>"},{"location":"functions/examples/#setup-laps-local-administrator-password-solution","title":"Setup LAPS - Local Administrator Password Solution","text":"<p>Optional: Create a Global Key to have a custom admin username</p> <p></p> <p>Create a custom field for storing the password</p> <p></p> <p>Create Task (can use Automation Policy)</p> <p></p> <p></p> <p>Run however often you'd like admin password reset</p> <p></p> <p>When you need the LAPS password, get from Agent Custom Fields</p> <p></p>"},{"location":"functions/global_settings/","title":"Global Settings","text":""},{"location":"functions/global_settings/#general","title":"General","text":"<ul> <li>Enable agent automatic self update (Recommended setting: Enabled)</li> <li>Enable server side scripts</li> <li>Enable web terminal</li> <li>Default Agent timezone</li> <li>Default Date Format</li> <li>Default Server Policy</li> <li>Default Workstation Policy</li> <li>Default Alert Template</li> <li>Receive notifications on</li> <li>Agent Debug Level</li> <li>Clear faults on agents that haven't checked in after (days)</li> <li>Reset Patch Policy on Agents</li> </ul>"},{"location":"functions/global_settings/#email-alerts","title":"Email Alerts","text":"<p>See Email Alerts</p>"},{"location":"functions/global_settings/#sms-alerts","title":"SMS Alerts","text":"<p>See SMS Alerts</p>"},{"location":"functions/global_settings/#meshcentral","title":"Meshcentral","text":"<p>See Meshcentral</p>"},{"location":"functions/global_settings/#custom-fields","title":"Custom Fields","text":"<p>See Custom Fields</p>"},{"location":"functions/global_settings/#global-key-store","title":"(Global) Key Store","text":"<p>See Key Store</p>"},{"location":"functions/global_settings/#url-actions","title":"URL Actions","text":"<p>See URL Actions</p>"},{"location":"functions/global_settings/#web-hooks","title":"Web Hooks","text":"<p>See Webhooks</p>"},{"location":"functions/global_settings/#retention-trmm-database","title":"Retention (TRMM Database)","text":"<p>These are the settings related to your Tools &gt; Server Maintenance &gt; Prune DB Tables</p> <p>Tactical RMM ships with data retention defaults that will work fine for most environments. There are situations, depending on the number of agents and checks configured, that these defaults need to be tweaked to improve performance.</p>"},{"location":"functions/global_settings/#adjusting-data-retention","title":"Adjusting Data Retention","text":"<p>The options are:</p> <ul> <li>Check History - Will delete check history older than the days specified (default is 30 days).</li> <li>Resolved Alerts - Will delete alerts that have been resolved older than the days specified (default is disabled).</li> <li>Agent History - Will delete agent command/script history older than the days specified (default is 60 days).</li> <li>Debug Logs - Will delete agent debug logs older than the days specified (default is 30 days).</li> <li>Audit Logs Will delete Tactical RMM audit logs older than the days specified (default is disabled).</li> </ul> <p>To disable database pruning on a table, set the days to 0.</p>"},{"location":"functions/global_settings/#api-keys","title":"API Keys","text":"<p>See API</p>"},{"location":"functions/keystore/","title":"Global Key Store","text":"<p>The key store is used to store values that need to be referenced from multiple scripts. This also allows for easy updating of values since scripts reference the values at runtime.</p> <p>To Add/Edit values in the Global Key Store, browse to Settings &gt; Global Settings &gt; KeyStore. </p> <p>You can reference values from the key store in script arguments by using the {{global.key_name}} syntax.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive. <code>global.</code> must be all lower case.</p> <p></p> <p>See Scripts for more information.</p>"},{"location":"functions/maintenance_mode/","title":"Maintenance Mode","text":"<p>Enabling maintenance mode for an agent will prevent any overdue/check/task email/sms alerts from being sent.</p> <p>It will also prevent clients/sites/agents from showing up as red in the dashboard if they have any failing checks or are overdue.</p> <p>To enable maintenance mode for all agents in a client/site, Right Click on a client / site and choose Enable Maintenance Mode</p> <p></p> <p>To enable maintenance mode for a single agent, Right Click on the agent and choose Enable Maintenance Mode</p>"},{"location":"functions/maintenance_mode/#putting-server-into-maintenance-mode","title":"Putting server into maintenance mode","text":"<ul> <li> <p>Follow the instructions at the top of Management Commands page to activate the python virtual env</p> </li> <li> <p>Run the management command using one of the options below:</p> </li> </ul> <pre><code>python manage.py server_maint_mode [options]\n</code></pre> Options Description <code>--enable</code> Enable Maintenance Mode. Sets all agents to maintenance mode and saves their current states. <code>--disable</code> Disable Maintenance Mode. Restores agents to their previous states before maintenance mode was enabled. <code>--force-enable</code> Force Enable Maintenance Mode. Unconditionally sets all agents to maintenance mode, ignoring any previously saved states. <code>--force-disable</code> Force Disable Maintenance Mode. Unconditionally disables maintenance mode for all agents, removing any saved state information. <p>Note: Only one of the above options should be used at a time to avoid conflicts.</p>"},{"location":"functions/permissions/","title":"User Roles and Permissions","text":""},{"location":"functions/permissions/#permission-manager","title":"Permission Manager","text":"<p>Make sure you've setup at least 1 valid (Super User aka Administrator) role under Settings &gt; Permission Manager</p> <ol> <li>Login as usual Tactical user</li> <li>Go to Settings - Permissions Manager</li> <li>Click New Role</li> <li>You can all the role anything, I called it Admins</li> <li>Tick the Super User Box/or relevant permissions required</li> <li>Click Save then exit Permissions Manager</li> <li>Go to Settings - Users</li> <li>Open current logged in user/or any other user and assign role (created above step 6) in the Role drop down box.</li> <li>Click Save </li> </ol> <p>Once you've set that up a Super User role and assigned your primary user, you can create other Roles with more limited access.</p> <p>Tip</p> <p>If you are only trying to give permissions to one or more sites within a client, but not all of the sites, then leave the \"Allowed Clients\" field blank and only add sites to \"Allowed Sites\". If a client is set in \"Allowed Clients\" that will override any site perms and give access to all sites within that client, regardless of what sites are set.</p>"},{"location":"functions/permissions/#video-walkthru","title":"Video Walkthru","text":""},{"location":"functions/permissions/#permissions-with-extra-security-implications","title":"Permissions with extra Security implications","text":"<p>Warning</p> <p>DO NOT use the Web Terminal for running the Tactical update script as it will stop the service running the web terminal and bork your update.</p> <ul> <li>Use TRMM Server Web Terminal</li> <li>Run Scripts on TRMM Server</li> </ul> <p>Both of these functions are running under the linux user that you installed TRMM with (usually <code>tactical</code> if you followed the docs).</p> <p>These have full access to your TRMM server's filesystem and as a result have the ability to become root if you have passwordless sudo enabled.</p> <p>These can be very dangerous features if not handled with care so think carefully before you enable/use them.</p> <p>These features can be disabled from the web UI in Global Settings.</p> <p></p> <p>They can also be disabled at the filesystem level (which overrides the setting in Global Settings) by adding any of these variables to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></p> <pre><code>TRMM_DISABLE_WEB_TERMINAL = True\nTRMM_DISABLE_SERVER_SCRIPTS = True\n</code></pre> <p>After adding these make sure they take effect by running <code>sudo systemctl restart rmm daphne celery celerybeat</code></p> <p>Info</p> <p>Docker Installs need to only update the .env file and issue command  <code>docker compose down &amp;&amp; docker compose up -d</code>  for the variables to take effect.</p>"},{"location":"functions/remote_bg/","title":"Remote Background","text":"<p>To access: Right click on an agent &gt; Remote Background</p>"},{"location":"functions/remote_bg/#terminal-tab","title":"Terminal Tab","text":"<p>Meshcentral Integration: This will allow you to open a terminal on the remote agent. </p> <p></p> <p>Right-clicking will allow:</p> <ul> <li>Admin Shell</li> <li>Admin PowerShell</li> <li>User Shell</li> <li>User PowerShell</li> <li>Ask Admin Shell</li> <li>Ask Admin PowerShell</li> <li>Ask User Shell</li> <li>Ask User PowerShell</li> </ul> <p>Tip</p> <p>If you don't see any Connect button in the top left the problem is either the TRMM user doesn't have meshcentral permissions or the mesh agent is having connectivity problems. Try either the \"Recover Connection\" button or script \"TacticalRMM - Check Mesh Agent for problems\"</p>"},{"location":"functions/remote_bg/#file-browser","title":"File Browser","text":"<p>Meshcentral Integration: This will allow you to open a File Manager where you can manage and transfer files to and from the agent.</p>"},{"location":"functions/remote_bg/#services-tab","title":"Services Tab","text":"<p>Right click on a service to show the context menu where you can start/stop/restart services:</p> <p></p> <p>Click Service Details to bring up the details tab where you can edit more service options:</p> <p></p>"},{"location":"functions/remote_bg/#processes-tab","title":"Processes Tab","text":"<p>A very basic task manager that shows real time process usage.</p> <p>Right click on a process to end the task:</p> <p></p>"},{"location":"functions/remote_bg/#event-log","title":"Event Log","text":"<p>Allows you to query the Windows Application | System | Security Logs</p> <p></p>"},{"location":"functions/scripting/","title":"Scripting","text":"<p>Tactical RMM supports uploading existing scripts or creating new scripts from within the web interface.</p> <p>Windows agent languages supported:</p> <ul> <li>PowerShell</li> <li>Windows Batch</li> <li>Python</li> <li>Nushell</li> <li>Deno</li> </ul> <p>There is RunAsUser functionality for Windows.</p> <p>Linux/Mac languages supported:</p> <ul> <li>Any language that is installed on the remote machine (use a shebang at the top of the script to set the interpreter)</li> <li>nu</li> <li>deno (Javascript and TypeScript)</li> </ul>"},{"location":"functions/scripting/#adding-scripts","title":"Adding Scripts","text":"<p>In the dashboard, browse to Settings &gt; Scripts Manager. Click the New button and select either Upload Script or New Script. The available options for scripts are:</p> <ul> <li>Name - This identifies the script in the dashboard.</li> <li>Description - Optional description for the script.</li> <li>Category - Optional way to group similar scripts together.</li> <li> <p>Type - This sets the language of the script. Available options are:</p> <ul> <li>PowerShell</li> <li>Windows Batch</li> <li>Python</li> <li>Shell (use for Linux/macOS scripts)</li> <li>Nushell</li> <li>Deno</li> </ul> </li> <li> <p>Script Arguments - Optional way to set default arguments for scripts. These will auto populate when running scripts and can be changed at runtime. Logged on Windows Event Viewer &gt; Applications and Services Logs &gt; Microsoft &gt; Windows&gt; PowerShell &gt; Operational</p> </li> <li>Environment vars - Optional way to set default arguments for scripts using Environment Variables. These will auto populate when running scripts and can be changed at runtime. Not logged, better to use when passing data you don't want logged</li> <li>Default Timeout - Sets the default timeout of the script and will stop script execution if the duration surpasses the configured timeout. Can be changed at script runtime.</li> <li>Favorite - Favorites the script.</li> </ul>"},{"location":"functions/scripting/#downloading-scripts","title":"Downloading Scripts","text":"<p>To download a Tactical RMM Script, click on the script in the Script Manager to select it. Then click the Download Script button on the top. You can also right-click on the script and select download.</p>"},{"location":"functions/scripting/#community-scripts","title":"Community Scripts","text":"<p>These are script that are built into Tactical RMM. They are provided and maintained by the Tactical RMM community. These scripts are updated whenever Tactical RMM is updated and can't be modified or deleted in the dashboard.</p>"},{"location":"functions/scripting/#hiding-community-scripts","title":"Hiding Community Scripts","text":"<p>You can choose to hide community script throughout the dashboard by opening Script Manager and clicking the Show/Hide Community Scripts toggle button.</p>"},{"location":"functions/scripting/#using-scripts","title":"Using Scripts","text":""},{"location":"functions/scripting/#manual-run-on-agent","title":"Manual run on agent","text":"<p>In the Agent Table, you can right-click on an agent and select Run Script. You have the options of:</p> <ul> <li>Wait for Output - Runs the script and waits for the script to finish running and displays the output.</li> <li>Fire and Forget - Starts the script and does not wait for output.</li> <li>Email Output - Starts the script and will email the output. Allows for using the default email address in the global settings or adding a new email address.</li> <li>Save as Note - Saves the output as a Note that can be views in the agent Notes tab.</li> <li>Collector - Saves to output to the specified custom field.</li> </ul> <p>There is also an option on the agent context menu called Run Favorited Script. This will pre-populate the script run dialog with the script of your choice.</p> <p>Script Execution Process</p>"},{"location":"functions/scripting/#script-arguments","title":"Script Arguments","text":"<p>The <code>Script Arguments</code> field should be pre-filled with information for any script that can accept or requires parameters. Use the (i)</p> <p> &lt;Required Parameter Name&gt; &lt;string&gt; [-&lt;Optional Parameter Name&gt; &lt;string&gt;] [-&lt;string&gt; {(&lt;default string if not specified&gt;) | &lt;string2&gt; | &lt;string3&gt;}]</p> <p>Where <code>[]</code> indicates an optional parameter</p> <p>and <code>{}</code> indicates a parameter with several preconfigured parameter</p> <p>and <code>()</code> indicates a default parameter if none is specified.</p> <p>Starting with 0.15.4 you can use environment variables to pass them too!</p>"},{"location":"functions/scripting/#examples","title":"Examples","text":"<p>Script Arguments</p> <pre><code>-hello world\n-foo bar\n-data {{agent.public_ip}}\n</code></pre> <p>Environment vars</p> <pre><code>ehello=eworld\nefoo=ebar\nedata={{agent.hostname}}\n</code></pre> <p></p>  Batch Powershell Python Shell <p>Script</p> <pre><code>@echo off\nsetlocal\n\nrem Parameters. Batch only accepts positional params not named ones\nset hello=%1\nset foo=%2\nset data=%3\n\necho Script Args\necho hello: %hello%\necho foo: %foo%\necho data: %data%\n\necho.\necho Environment Vars\necho ehello: %ehello%\necho efoo: %efoo%\necho edata: %edata%\n\nendlocal\n</code></pre> <p>Script</p> <pre><code>param(\n    [string]$hello,\n    [string]$foo,\n    [string]$data\n)\n\nWrite-Output \"Script Args\"\nWrite-Output \"hello: $hello\"\nWrite-Output \"foo: $foo\"\nWrite-Output \"data: $data\"\n\nWrite-Output \"\"\nWrite-Output \"Environment Vars\"\nWrite-Output \"ehello: $env:ehello\"\nWrite-Output \"efoo: $env:efoo\"\nWrite-Output \"edata: $env:edata\"\n</code></pre> <p>Script</p> <pre><code>#!/usr/bin/python3\n\nimport os\nimport argparse\n\n#Note: named args in python require -- and = between name and value eg \n# --hello=world \n# --foo=bar\n# --data={{agent.public_ip}}\n# Parse command-line arguments\nparser = argparse.ArgumentParser(description=\"Process some strings.\")\nparser.add_argument(\"--hello\", type=str, help=\"Value for hello\")\nparser.add_argument(\"--foo\", type=str, help=\"Value for foo\")\nparser.add_argument(\"--data\", type=str, help=\"Value for data\")\n\nargs = parser.parse_args()\n\n# Script Args\nprint(\"Script Args\")\nprint(f\"hello: {args.hello}\")\nprint(f\"foo: {args.foo}\")\nprint(f\"data: {args.data}\")\n\n# Environment Vars\nprint(\"\\nEnvironment Vars\")\nprint(f\"ehello: {os.getenv('ehello')}\")\nprint(f\"efoo: {os.getenv('efoo')}\")\nprint(f\"edata: {os.getenv('edata')}\")\n</code></pre> <p>Script</p> <pre><code>#!/bin/bash\n\n#Bash only accepts positional params not named ones\nhello=\"$1\"\nfoo=\"$2\"\ndata=\"$3\"\n\necho \"Script Args\"\necho \"hello: $hello\"\necho \"foo: $foo\"\necho \"data: $data\"\n\necho \"\"\necho \"Environment Vars\"\necho \"ehello: $ehello\"\necho \"efoo: $efoo\"\necho \"edata: $edata\"\n</code></pre>"},{"location":"functions/scripting/#run-script-on-many-agents-at-once","title":"Run Script on many agents at once","text":"<p>Under the <code>Tools menu</code> -&gt; <code>Bulk Script</code> you can execute scripts against Clients/Sites/Selected Agents/All based on All/Servers/Workstations. The history is saved in the history tab of the agent. The history can also be retrieved from the API from the <code>/agents/history/</code> endpoint.</p>"},{"location":"functions/scripting/#run-command-on-many-agents-at-once","title":"Run Command on many agents at once","text":"<p>Under the <code>Tools menu</code> -&gt; <code>Bulk Command</code> you can execute a command against Clients/Sites/Selected Agents/All based on All/Servers/Workstations. The history is saved in the history tab of the agent. The history can also be retrieved from the API from the <code>/agents/history/</code> endpoint.</p>"},{"location":"functions/scripting/#automated-tasks","title":"Automated Tasks","text":"<p>Tactical RMM allows scheduling tasks to run on agents. This leverages the Windows Task Scheduler and has the same scheduling options.</p> <p>See Automated Tasks for configuring automated tasks.</p>"},{"location":"functions/scripting/#script-checks","title":"Script Checks","text":"<p>Scripts can also be run periodically on an agent and trigger an alert if it fails in case you want any kind of warning code to alert you.</p> <p>Important: When utilizing PowerShell scripts and manually assigning an exit code, it's essential to define the exit code using the following syntax: <code>$host.SetShouldExit(EXITCODE)</code>. Here, EXITCODE represents the desired exit code number. For instance, to assign an exit code of 3, use <code>$host.SetShouldExit(3)</code>.</p>"},{"location":"functions/scripting/#alert-failureresolve-actions","title":"Alert Failure/Resolve Actions","text":"<p>Scripts can be triggered when an alert is triggered and resolved.</p> <p>For configuring Alert Templates, see Alerting</p> <p>See below for populating dashboard data in scripts and the available options.</p>"},{"location":"functions/scripting/#using-dashboard-data-in-scripts","title":"Using dashboard data in scripts","text":"<p>Tactical RMM allows passing in dashboard data to scripts as arguments or environment variables. The below PowerShell arguments will get the client name of the agent and also the agent's public IP address.</p> <pre><code>-ClientName {{client.name}} -PublicIP {{agent.public_ip}}\n</code></pre> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p> <p>See a full list of possible built-in variables Here</p>"},{"location":"functions/scripting/#getting-custom-field-values","title":"Getting Custom Field values","text":"<p>Tactical RMM supports pulling data from custom fields using the {{model.custom_field_name}} syntax.</p> <p>See Using Custom Fields in Scripts.</p>"},{"location":"functions/scripting/#getting-values-from-the-global-keystore","title":"Getting values from the Global Keystore","text":"<p>Tactical RMM supports getting values from the global key store using the {{global.key_name}} syntax.</p> <p>See Global Keystore.</p>"},{"location":"functions/scripting/#script-snippets","title":"Script Snippets","text":"<p>Script Snippets allow you to create common code blocks or comments and apply them to all of your scripts. This could be initialization code, common error checking, or even code comments.</p>"},{"location":"functions/scripting/#adding-script-snippets","title":"Adding Script Snippets","text":"<p>In the dashboard, browse to Settings &gt; Scripts Manager. Click the Script Snippets button.</p> <ul> <li>Name - This identifies the script snippet in the dashboard</li> <li>Description - Optional description for the script snippet</li> <li>Shell - This sets the language of the script. Available options are:<ul> <li>PowerShell</li> <li>Windows Batch</li> <li>Python</li> </ul> </li> </ul>"},{"location":"functions/scripting/#using-script-snippets","title":"Using Script Snippets","text":"<p>When editing a script, you can add template tags to the script body that contains the script snippet name. For example, if a script snippet exists with the name \"Check WMF\", you would put {{Check WMF}} in the script body and the snippet code will be replaced.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p> <p>The template tags will only be visible when Editing the script. When downloading or viewing the script code the template tags will be replaced with the script snippet code.</p>"},{"location":"functions/scripting/#powershell-7","title":"PowerShell 7","text":"<p>https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/start-process?view=powershell-7.2</p> <p>Shell Type: PowerShell</p> <p>Command: <code>Start-Process nohup 'pwsh -noprofile -c \"1..120 | % { Write-Host . -NoNewline; sleep 1 }\"'</code></p>"},{"location":"functions/scripting/#python","title":"Python","text":""},{"location":"functions/scripting/#python-on-windows","title":"Python on windows","text":"<p>Tactical ships with a portable python distribution on windows.</p> OS Version Windows &gt;= 8.1 3.11.9 Windows &lt; 8.1 3.8.7 <p>The following 3rd party packages are also bundled with this distribution:</p> <ul> <li>cryptography</li> <li>httpx</li> <li>msgpack</li> <li>psutil</li> <li>pysnmplib</li> <li>pywin32</li> <li>pywin32-ctypes</li> <li>requests</li> <li>websockets</li> <li>WMI</li> <li>validators</li> </ul>"},{"location":"functions/scripting/#python-on-posix","title":"Python on posix","text":"<p>How do you target a specific version? The shebang can specify the interpreter on macOS and Linux, but since Windows does not use the shebang, the interpreter needs to be specified by the calling program.</p> <p>Ok, so how do you use the shebang? Take this hello world script for example. The shebang <code>#!</code> in this script will use <code>/usr/bin/python3</code>. This is easy enough until you run across a system where the system Python is not the expected 3.8 or later.</p> <pre><code>#!/usr/bin/python3\nprint(\"Hello World!\")\n</code></pre> <p>This is where env comes into play. <code>env</code> will search the <code>$PATH</code> for the executable that matches the argument. In this case, the script will be run by the first \"python3\" found in $PATH. However, what if <code>python3</code> points to <code>python3.6</code>? You're in the same boat you were in before.</p> <pre><code>#!/usr/bin/env python3\nprint(\"Hello World!\")\n</code></pre> <p>Or are you? If you read the env man page, it states you can add parameters to the command line. In case you didn't know, the shebang is the command line! <code>env</code> will modify the <code>$PATH</code> before searching for <code>python3</code>, allowing you to use a custom python location.</p> <pre><code>#!/usr/bin/env PATH=\"/opt/my-python/3.8/:$PATH\" python3\nprint(\"Hello World!\")\n</code></pre> <p>Wait! Isn't the shebang a shell script, not a Python script? In TRMM, a \"Shell\" script and a \"Python\" script are treated the same except that Python scripts also work on Windows. On Linux and macOS, \"Shell\" and \"Python\" scripts are treated the same.</p> Script Type OS Supported Python Windows Yes Python Linux Yes Python macOS Yes Shell Windows No Shell Linux Yes Shell macOS Yes"},{"location":"functions/scripting/#python-version-references","title":"Python version references","text":"<ul> <li>Python 2 was sunset in January 2020.</li> <li>Python versions: Python 3.7 is end of life in June 2023.</li> <li>Debian releases including the end of life date.</li> <li>Python support in Debian to determine the Python version included in Debian.</li> <li>Ubuntu inherits from Debian; see previous line.</li> <li>Ubuntu vs Debian OS versions; to map Ubuntu version to Debian version to determine the Python version.</li> <li>Ubuntu Release Notes may contain the Python version included.</li> <li>macOS versions; macOS version number mapped to the OS name.</li> <li>macOS release history; includes supported/maintained/unsupported and last update date.</li> </ul> OS Python version Installed by TRMM Windows 3.11 Yes Linux, Debian 10 (Buster) (end of life) 3.7 No Linux, Debian 11 (Bullseye) 3.9 No Linux, Debian 12 (Bookworm) 3.12 No Linux, Ubuntu 20.04 LTS 3.8 No Linux, Ubuntu 22.04 LTS 3.10 No macOS Ventura 3.8 No macOS Monterey 12.3 2.7 removed No macOS Catalina 10.15 2.7 (not recommended to use) No"},{"location":"functions/scripting/#targeting-a-specific-version","title":"Targeting a specific version","text":"<p>Python compiles the script into bytecode and then executes it. Because of the compilation step, errors due to language constructs introduced in a later version of Python will cause the script to fail. For example, Python 3.10 introduced the \"match\" term as their version of a case or switch statement.</p> <pre><code>#!/usr/bin/env python3\n\nmatch \"term\":\n    case \"Nope\":\n        print(\"No match found\")\n    case \"term\":\n        print(\"Found match!\")\n    case _:\n        print(\"Default if nothing matches\")\n</code></pre> <p>The same code will work on Python 3.10.</p> <pre><code>$ python3.10 test-python-version.py\nFound match!\n</code></pre> <p>The same code fails on versions prior to 3.10. <pre><code>$ python3.6 test-python-version.py\n  File \"test-python-version.py\", line 3\n    match \"term\":\n               ^\nSyntaxError: invalid syntax\n</code></pre></p>"},{"location":"functions/scripting/#nushell","title":"Nushell","text":"<p>Nu is a new type of shell. Like PowerShell, Nu passes objects from one command to the next. For example, this script will list processes that are more than 100MB.</p> <pre><code>ps | where mem &gt;= 100MB\n</code></pre> <p>There are some important points to keep in mind when writing Nu scripts. See the Thinking in Nu for details. Some highlights:</p> <ol> <li>The <code>&gt;</code> is the greater-than operator, not redirection. Use <code>| save some-file.txt</code></li> <li>Variables are immutable, or constant. Use <code>mut</code> to make a variable mutable.</li> <li>Currently Nu does not support background tasks. <code>long-running-command &amp;</code> will not work.</li> </ol> <p>Nu has a Discord server if you have questions.</p> <p>To disable this feature, add the following to <code>local_settings.py</code>:</p> <pre><code>INSTALL_NUSHELL = False\n</code></pre>"},{"location":"functions/scripting/#example-nushell-script","title":"Example Nushell Script","text":"<p>The below script find processes sorted by greatest cpu utilization.</p> <pre><code>ps | sort-by cpu | reverse\n</code></pre>"},{"location":"functions/scripting/#deno","title":"Deno","text":"<p>Deno is considered to be the next iteration of Node.js. Deno uses ECMAScript modules (a.k.a ES Modules or ESM) syntax, not CommonJS (CJS). I.e. use <code>import * from https://example.com/package/module.ts</code> instead of <code>require('./local/file.js')</code>.</p> <p>Tactical RMM runs Deno scripts with the following permissions:</p> <pre><code>DENO_PERMISSIONS=--allow-all\n</code></pre> <p>See the documentation on permissions for details.</p> <p>To override this, either:</p> <ol> <li>Add the <code>DENO_DEFAULT_PERMISSIONS</code> string variable with the permissions requested to <code>local_settings.py</code> or</li> <li>Set the <code>DENO_PERMISSIONS</code> environment variable to the permissions requested in your script.</li> </ol> <p>To disable this feature, add the following to <code>local_settings.py</code>:</p> <pre><code>INSTALL_DENO = False\n</code></pre>"},{"location":"functions/scripting/#example-deno-script","title":"Example Deno Script","text":"<p>The below script prints basic system information:</p> <pre><code>async function gatherSystemInfo() {\n  const os = Deno.build.os;\n  const arch = Deno.build.arch;\n  const memory = Deno.systemMemoryInfo();\n\n\n  const info = `\nOS: ${os}\nArchitecture: ${arch}\nTotal Memory: ${(await memory).total / 1024 / 1024} MB\nFree Memory: ${(await memory).free / 1024 / 1024} MB\n`;\n\n  console.log(info);\n}\n\ngatherSystemInfo().catch(console.error);\n</code></pre>"},{"location":"functions/scripting/#example-scripts","title":"Example Scripts","text":""},{"location":"functions/scripting/#example-powershell-script","title":"Example PowerShell Script","text":"<p>The below script takes five named values. The arguments will look like this: <code>-SiteName {{site.name}}</code> <code>-ClientName {{client.name}}</code> <code>-PublicIP {{agent.public_ip}}</code> <code>-CustomField {{client.AV_KEY}}</code> <code>-Global {{global.API_KEY}}</code></p> <pre><code>param (\n   [string] $SiteName,\n   [string] $ClientName,\n   [string] $PublicIp,\n   [string] $CustomField,\n   [string] $Global\n)\n\nWrite-Output \"Site: $SiteName\"\nWrite-Output \"Client: $ClientName\"\nWrite-Output \"Public IP: $PublicIp\"\nWrite-Output \"Custom Fields: $CustomField\"\nWrite-Output \"Global: $Global\"\n</code></pre>"},{"location":"functions/scripting/#example-shell-script","title":"Example Shell Script","text":"<p>The below script prints the user running the script.</p> <pre><code>#!/usr/bin/env bash\nwhoami\n</code></pre>"},{"location":"functions/settings_override/","title":"Overriding / Customizing Default Settings","text":""},{"location":"functions/settings_override/#admin-user-browser-token-expiration-and-idle-timeout-settings","title":"Admin User Browser Token Expiration and Idle Timeout Settings","text":"<p>The browser token expiration for admin users determines how long a session remains active before requiring re-authentication. By default, the token expires after 5 hours of inactivity. You can customize this idle timeout to automatically log out admin users after a shorter or longer period, depending on your security policy. See this ticket for reference.</p> <p>To change it, add the following code block to the end of <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></p> <pre><code>from datetime import timedelta\n\nREST_KNOX = {\n    \"TOKEN_TTL\": timedelta(days=30),\n    \"AUTO_REFRESH\": True,\n    \"MIN_REFRESH_INTERVAL\": 600,\n}\n</code></pre> <p>Change <code>(days=30)</code> to whatever you prefer. Then run <code>sudo systemctl restart rmm.service</code> for changes to take effect.</p>"},{"location":"functions/settings_override/#using-your-own-wildcard-ssl-cert","title":"Using your own wildcard SSL cert","text":""},{"location":"functions/settings_override/#before-install","title":"Before Install","text":"<p>Follow the instructions in the install guide for the <code>--use-own-cert</code> install flag.</p>"},{"location":"functions/settings_override/#existing-install","title":"Existing Install","text":"<ol> <li> <p>Append the following two variables to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code>, replacing the paths with the actual locations of your certificate and private key. The certificate must include the full chain: <pre><code>CERT_FILE = \"/path/to/your/fullchain.pem\"\nKEY_FILE = \"/path/to/your/privkey.pem\"\n</code></pre></p> </li> <li> <p>Ensure that both files are readable by the <code>tactical</code> Linux user: <pre><code>sudo chown tactical:tactical /path/to/your/fullchain.pem /path/to/your/privkey.pem\nsudo chmod 440 /path/to/your/fullchain.pem /path/to/your/privkey.pem\n</code></pre></p> </li> <li> <p>Update all instances of <code>ssl_certificate</code> and <code>ssl_certificate_key</code> in the three Nginx configuration files located in <code>/etc/nginx/sites-enabled</code> to point to your certificate and private key paths.</p> </li> <li> <p>Restart the services: <code>sudo systemctl restart nginx meshcentral rmm daphne</code></p> </li> </ol>"},{"location":"functions/settings_override/#use-nats-standard-instead-of-nats-websocket","title":"Use NATS Standard instead of NATS websocket","text":"<p>Prior to TRMM v0.14.0 (released 7/7/2022), agents NATS traffic connected to the TRMM server on public port 4222. If you have upgraded to v0.14.0 and have agents that won't work with websockets for some reason (too old TLS etc) then you can do the following to use NATS standard TCP on port 4222, just like how it was before v0.14.0:</p> <p>For Windows agents:</p> <p>Add the following registry string value (REG_SZ):</p> <p><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\TacticalRMM\\NatsStandardPort</code> with value <code>4222</code></p> <p>Then restart the <code>tacticalrmm</code> Windows service.</p> <p>For Linux agents:</p> <p>Add the following key/value pair to <code>/etc/tacticalagent</code>: <pre><code>{\"natsstandardport\": \"4222\"}\n</code></pre></p> <p>Then <code>sudo systemctl restart tacticalagent.service</code></p> <p>Just make sure port 4222 TCP is still open in your firewall and you're done.</p>"},{"location":"functions/settings_override/#configuring-custom-temp-dirs-on-windows-agents","title":"Configuring Custom Temp Dirs on Windows Agents","text":"<p>Version added: Tactical RMM v0.15.10</p> <p>Requires Agent v2.4.7</p> <p>By default, the Windows agent utilizes the <code>C:\\ProgramData\\TacticalRMM</code> directory for executing scripts and managing agent updates. However, it is possible to override this default directory by setting two optional registry string values (<code>REG_SZ</code>), specifying full paths to the desired directories:</p> <p><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\TacticalRMM\\WinTmpDir</code>: This registry value is used for running scripts and handling agent updates. Provide the full path to the custom directory.</p> <p><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\TacticalRMM\\WinRunAsUserTmpDir</code>: This registry value is specifically for executing Run As User scripts. Provide the full path to the custom directory.</p> <p>Please note that these custom directories must already exist on the system, as the agent will not attempt to create them. Ensure that the desired directories are created and that the appropriate permissions are set before adding the registry values.</p> <p>Directory path cannot contain spaces, this is a known issue and will be fixed in a future release.</p> <p>To apply the changes, restart the <code>tacticalrmm</code> Windows service. The custom temporary directories will then be used for the respective tasks.</p> <p>Example:</p> <p></p>"},{"location":"functions/settings_override/#monitor-nats-via-its-http-api","title":"Monitor NATS via its HTTP API","text":"<p>Version added: Tactical RMM v0.15.1</p> <p>To enable NATS monitoring, add the folllowing to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> (replace with whatever port you want). <pre><code>NATS_HTTP_PORT = 8222\n</code></pre></p> <p>Then from the TRMM Web UI, do Tools &gt; Server Maintenance &gt; Reload Nats Configuration.</p> <p>And then from your TRMM server cli restart both the <code>rmm.service</code> and <code>nats.service</code> services.</p>"},{"location":"functions/settings_override/#modify-the-placeholder-text-for-the-send-command-functionality","title":"Modify the Placeholder Text for the 'Send Command' Functionality","text":"<p>Version added: Tactical RMM v0.15.12</p> <p>Users now have the flexibility to customize the placeholder text that is displayed in the 'Send Command' dialog. This customization can be achieved by defining any or all of the following three optional variables in <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> file:</p> <pre><code>CMD_PLACEHOLDER_TEXT = \"&lt;Your customized command prompt text&gt;\"\nPOWERSHELL_PLACEHOLDER_TEXT = \"&lt;Your customized PowerShell prompt text&gt;\"\nSHELL_PLACEHOLDER_TEXT = \"&lt;Your customized shell prompt text&gt;\"\n</code></pre> <p>To activate, restart the api with <code>sudo systemctl restart rmm</code> and then refresh the web interface.</p>"},{"location":"functions/settings_override/#define-a-root-user-to-prevent-changes-from-web-ui","title":"Define a root user to prevent changes from web UI","text":"<p>To define a \"root\" user who cannot be modified via the web UI, add the following line to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></p> <pre><code>ROOT_USER = \"username\"\n</code></pre> <p>Replace \"username\" with the actual username. After making this change, run <code>sudo systemctl restart rmm.service</code> to apply the changes.</p>"},{"location":"functions/settings_override/#adjusting-agent-check-in-intervals","title":"Adjusting Agent Check-In Intervals","text":"<p>The agent periodically communicates with the RMM server, sending various data about its status and environment at random intervals. These randomized intervals are designed to prevent the \"thundering herd\" problem, where too many agents would check in simultaneously, potentially overloading the server.</p> <p>You can modify these intervals by adding one or more of the following variables to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code>. Each variable is a Python tuple containing two values: the minimum and maximum interval times, specified in seconds. The agent will select a random interval within this range for each check-in.</p> <p>The default check-in intervals are as follows:</p> <pre><code>CHECKIN_HELLO = (30, 60)  # Agent heartbeat (\"I'm alive\")\nCHECKIN_AGENTINFO = (200, 400)  # System info (logged-in user, boot time, RAM, etc.)\nCHECKIN_WINSVC = (2400, 3000)  # Windows services and their status\nCHECKIN_PUBIP = (300, 500)  # Agent's public IP address\nCHECKIN_DISKS = (1000, 2000)  # Disk information and usage\nCHECKIN_SW = (2800, 3500)  # Installed Windows software list\nCHECKIN_WMI = (3000, 4000)  # Asset details (as seen in the \"Assets\" tab)\nCHECKIN_SYNCMESH = (800, 1200)  # Agent's Mesh node ID\n</code></pre> <p>By adjusting these intervals, you can control how frequently the agent checks in with the RMM server for different types of data. This flexibility allows for balancing between server load and the frequency of updates.</p> <p>After adding any of these settings, you must restart both the RMM service (<code>sudo systemctl restart rmm</code>) and the agent service. An easy way to restart the agent service is by using the \"Tools &gt; Recover All Agents\" function in the TRMM web UI.</p>"},{"location":"functions/settings_override/#configuring-agent-check-jitter","title":"Configuring Agent Check Jitter","text":"<p>Version added: v1.0.0</p> <p>To prevent the thundering herd problem, where multiple agents send their check results simultaneously and overwhelm the server, a random jitter has been introduced. By default, this jitter is a random delay between 1 and 60 seconds.</p> <p>To customize this behavior, add the following variable to <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> and adjust the values as needed, then restart the RMM service (<code>sudo systemctl restart rmm</code>): <pre><code>CHECK_INTERVAL_JITTER = (1, 60)\n</code></pre></p>"},{"location":"functions/snmp_checks/","title":"SNMP Checks","text":"<p>Version added: Tactical RMM v0.19.0 / Agent v2.8.0</p>"},{"location":"functions/snmp_checks/#video-walkthru","title":"Video Walkthru","text":"<p>SNMP monitoring can now be done using the <code>pysnmplib</code> library included with the portable python distribution on windows agents.</p> <p>Here is a sample script (written by ChatGPT) that can be used to query and monitor a printer. It takes the printer's IP address as the first argument.</p> <pre><code>#!/usr/bin/python3\n\nimport sys\nfrom pysnmp.hlapi import *\n\nif len(sys.argv) != 2:\n    print(\"Missing required argument: snmp device IP address\")\n    sys.exit(1)\n\nprinter_ip = sys.argv[1]\ncommunity_string = 'public'\n\noids = {\n    'Printer Model': '1.3.6.1.2.1.1.1.0',\n    'Total Page Count': '1.3.6.1.2.1.43.10.2.1.4.1.1',\n    'Toner Level Black': '1.3.6.1.2.1.43.11.1.1.9.1.1',\n    'Toner Level Cyan': '1.3.6.1.2.1.43.11.1.1.9.1.2',\n    'Toner Level Magenta': '1.3.6.1.2.1.43.11.1.1.9.1.3',\n    'Toner Level Yellow': '1.3.6.1.2.1.43.11.1.1.9.1.4',\n    'Device Status': '1.3.6.1.2.1.25.3.2.1.5.1',\n    'Serial Number': '1.3.6.1.2.1.43.5.1.1.17.1',\n}\n\nfor name, oid in oids.items():\n    iterator = getCmd(\n        SnmpEngine(),\n        CommunityData(community_string, mpModel=0),\n        UdpTransportTarget((printer_ip, 161)),\n        ContextData(),\n        ObjectType(ObjectIdentity(oid))\n    )\n\n    errorIndication, errorStatus, errorIndex, varBinds = next(iterator)\n\n    if errorIndication:\n        print(f\"Error: {errorIndication}\")\n    elif errorStatus:\n        print(f'Error: {errorStatus.prettyPrint()} at {errorIndex and varBinds[int(errorIndex) - 1] or \"?\"}')\n    else:\n        for varBind in varBinds:\n            print(f'{name}: {varBind[1]}')\n</code></pre>"},{"location":"functions/software/","title":"Software","text":""},{"location":"functions/software/#software-tab","title":"Software tab","text":""},{"location":"functions/software/#install-software-button","title":"Install Software Button","text":"<p>This will give you a list of software installable from the Official Choco Community</p>"},{"location":"functions/software/#uninstall-button","title":"Uninstall button","text":"<p>This button will pull the software's uninstall string as set by the software developer.</p> <p>You should be aware that:</p> <ul> <li>You can use the Agents history tab for log data</li> <li>If you don't select <code>Run as user</code> all commands are sent via the TRMM agent native security context: <code>SYSTEM</code>. If the developer hasn't designed it to work from there you might get a stuck uninstaller with permission problems, or prompting with questions that can't be answered. YMMV</li> <li>msiexec doesn't log by default. If it's not uninstalling properly, you'll need to append <code>/l*v c:\\path\\to\\somelog.txt</code> to the uninstall string and then check that log file and troubleshoot accordingly. Microsoft docs has other msi command line options.</li> </ul>"},{"location":"functions/url_actions/","title":"URL Actions","text":"<p>URL Actions will run against an agent and open a configured URL in a new browser tab or window. This allows for integrations with various remote viewing softwares.</p>"},{"location":"functions/url_actions/#adding-url-actions","title":"Adding URL Actions","text":"<p>In the dashboard, browse to Settings &gt; Global Settings &gt; URL Actions. The available options are:</p> <ul> <li>Name - This identifies the URL Action in other parts of the dashboard</li> <li>Description - Optional description for the URL Action</li> <li>Pattern - This is the actual URL pattern that will open in the new browser tab/window. This field supports variables from the Global Keystore and Script Variables.</li> </ul>"},{"location":"functions/url_actions/#url-pattern-example","title":"URL Pattern Example","text":"<p>Info</p> <p>Variable names are case sensitive!</p> <pre><code>https://remote.example.com/connect?API_KEY={{global.API_KEY}}&amp;agent_id={{agent.Remote ID}}\n</code></pre> <p>The above example uses a value defined in the global keystore named API_KEY and an Agent custom field called remote id. The URLs are properly encoded to work with any special characters or spaces returned in the values.</p>"},{"location":"functions/url_actions/#running-url-actions","title":"Running URL Actions","text":"<p>In the agent table, right-click on the Agent and select Run URL Action and select the action to run.</p> <p>You can also create a shortcut for this by setting the default double-click action to open a URL action:</p> <p>Click on your username in the top right of the web UI &gt; Preferences, then select Run URL Action and then select the URL action:</p> <p></p> <p>The URL action will now run when you double click on a row in the Agent table in the dashboard.</p>"},{"location":"functions/user_ui/","title":"User Interface Preferences","text":"<p>Click on your username at the top right of the dashboard &gt; Preferences:</p> <p></p> <p></p>"},{"location":"functions/web_terminal/","title":"Web Terminal","text":""},{"location":"functions/web_terminal/#video-walkthru","title":"Video Walkthru","text":""},{"location":"functions/webhooks/","title":"Web Hooks","text":""},{"location":"functions/webhooks/#video-walkthru","title":"Video Walkthru","text":"<p>To apply and run on Agent overdue and Check/Task failures use Alert Templates</p> <p><code>Name</code>: Name</p> <p><code>Description</code>: for notes about webhook.</p> <p><code>URL Pattern</code>: For webhooks, you need a URL where the Tactical RMM can send HTTP requests when an event occurs. This URL should be a server endpoint configured to accept HTTP requests.</p>"},{"location":"functions/webhooks/#request-headers","title":"Request Headers","text":"<p>Request headers allow the server to learn more about the request context. Here are some common headers used in webhook configurations:</p> <p>Content-Type: Describes the nature of the data being sent. For JSON data, you use application/json.</p> <p>Authorization: If your endpoint requires authentication, you might use a token or other credentials in this header.</p> <p>User-Agent: Identifies the application making the request.</p> <pre><code>{\n    \"Content-Type\": \"application/json\"\n}\n</code></pre>"},{"location":"functions/webhooks/#request-body","title":"Request Body","text":"<p>The request body must contain valid JSON and can include anything you want. Here are some examples:</p>  Discord JSON Microsoft Teams (Basic) Microsoft Teams (Advanced) Slack Ticketing System <p>Discord: Edit a channel &gt; Integrations &gt; Webhooks</p> <pre><code>{\n    \"content\": \"Agent hasn't checked in for {{agent.overdue_time}} minutes.\",\n    \"username\": \"{{agent.hostname}}\",\n    \"avatar_url\": \"https://cdn3.emoji.gg/emojis/PogChamp.png\",\n    \"embeds\": [\n        {\n            \"title\": \"Agent {{agent.hostname}} Client: {{agent.site.client.name}}\",\n            \"description\": \"This is an embed\",\n            \"color\": 15258703,\n            \"fields\": [\n                {\n                    \"name\": \"Field1\",\n                    \"value\": \"Some value\",\n                    \"inline\": true\n                },\n                {\n                    \"name\": \"Field2\",\n                    \"value\": \"Another value\",\n                    \"inline\": true\n                }\n            ]\n        }\n    ]\n}\n</code></pre> <p>Simple JSON</p> <pre><code>{\n    \"text\": \"{{agent.hostname}}: {{alert.message}}\"\n}\n</code></pre> <p>Teams</p> <p>Microsoft Teams uses Office 365 Connectors for its incoming webhooks. The format for Teams is slightly more complex, allowing for potentially richer content.</p> <pre><code>{\n    \"@type\": \"MessageCard\",\n    \"@context\": \"http://schema.org/extensions\",\n    \"summary\": \"Issue 176715375\",\n    \"themeColor\": \"0078D7\",\n    \"title\": \"Issue opened: \\\"Push notifications not working\\\"\",\n    \"sections\": [{\n        \"activityTitle\": \"Mona Lisa\",\n        \"activitySubtitle\": \"On Project XYZ\",\n        \"activityImage\": \"https://teamsnodesample.azurewebsites.net/static/img/image5.png\",\n        \"facts\": [{\n            \"name\": \"Assigned to\",\n            \"value\": \"Unassigned\"\n        }, {\n            \"name\": \"Due date\",\n            \"value\": \"2016-08-29T04:31:32.993Z\"\n        }],\n        \"markdown\": true\n    }]\n}\n</code></pre> <p>Teams</p> <p>Microsoft Teams uses Office 365 Connectors for its incoming webhooks. The format for Teams is slightly more complex, allowing for potentially richer content.</p> <pre><code>{\n    \"type\": \"message\",\n    \"attachments\": [\n        {\n            \"contentType\": \"application/vnd.microsoft.card.adaptive\",\n            \"contentUrl\": null,\n            \"content\": {\n                \"$schema\": \"https://adaptivecards.io/schemas/adaptive-card.json\",\n                \"type\": \"AdaptiveCard\",\n                \"version\": \"1.2\",\n                \"msteams\": {\n                    \"width\": \"Full\"\n                },\n                \"body\": [\n                    {\n                        \"type\": \"ColumnSet\",\n                        \"columns\": [\n                            {\n                                \"type\": \"Column\",\n                                \"items\": [\n                                    {\n                                        \"type\": \"Image\",\n                                        \"style\": \"person\",\n                                        \"url\": \"https://amidaware.com/images/amidaware.jpg\",\n                                        \"altText\": \"TacticalRMM\",\n                                        \"size\": \"small\"\n                                    }\n                                ],\n                                \"width\": \"auto\"\n                            },\n                            {\n                                \"type\": \"Column\",\n                                \"items\": [\n                                    {\n                                        \"type\": \"TextBlock\",\n                                        \"weight\": \"bolder\",\n                                        \"text\": \"TacticalRMM\",\n                                        \"wrap\": true,\n                                        \"size\": \"heading\"\n                                    },\n                                    {\n                                        \"type\": \"TextBlock\",\n                                        \"spacing\": \"none\",\n                                        \"text\": \"Created date here\",\n                                        \"isSubtle\": true,\n                                        \"wrap\": true\n                                    }\n                                ],\n                                \"width\": \"stretch\"\n                            }\n                        ]\n                    },\n                    {\n                        \"type\": \"ColumnSet\",\n                        \"isVisible\": true,\n                        \"columns\": [\n                            {\n                                \"type\": \"Column\",\n                                \"isVisible\": true,\n                                \"items\": [\n                                    {\n                                        \"type\": \"RichTextBlock\",\n                                        \"inlines\": [\n                                            {\n                                                \"type\": \"TextRun\",\n                                                \"text\": \"first column more text\",\n                                                \"wrap\": true,\n                                                \"color\": \"default\",\n                                                \"weight\": \"bolder\"\n                                            }\n                                        ]\n                                    }\n                                ]\n                            },\n                            {\n                                \"type\": \"Column\",\n                                \"isVisible\": true,\n                                \"items\": [\n                                    {\n                                        \"type\": \"RichTextBlock\",\n                                        \"inlines\": [\n                                            {\n                                                \"type\": \"TextRun\",\n                                                \"text\": \"Second column\",\n                                                \"wrap\": true\n                                            },\n                                            {\n                                                \"type\": \"TextRun\",\n                                                \"text\": \"second column more text\",\n                                                \"wrap\": true,\n                                                \"color\": \"default\",\n                                                \"weight\": \"bolder\"\n                                            }\n                                        ]\n                                    }\n                                ]\n                            }\n                        ]\n                    },\n                    {\n                        \"type\": \"ColumnSet\",\n                        \"columns\": [\n                            {\n                                \"type\": \"Column\",\n                                \"width\": \"stretch\",\n                                \"style\": \"emphasis\",\n                                \"minHeight\": \"40px\",\n                                \"items\": [\n                                    {\n                                        \"type\": \"TextBlock\",\n                                        \"text\": \"The minimal message!\",\n                                        \"wrap\": true\n                                    }\n                                ]\n                            },\n                            {\n                                \"type\": \"Column\",\n                                \"width\": \"auto\",\n                                \"verticalContentAlignment\": \"center\",\n                                \"isVisible\": false,\n                                \"items\": [\n                                    {\n                                        \"type\": \"ActionSet\",\n                                        \"isVisible\": false,\n                                        \"actions\": []\n                                    },\n                                    {\n                                        \"type\": \"ActionSet\",\n                                        \"isVisible\": false,\n                                        \"actions\": []\n                                    }\n                                ]\n                            }\n                        ]\n                    }\n                ]\n            }\n        }\n    ]\n}\n</code></pre> <p>Slack</p> <p>You can also send more complex messages with attachments, buttons, etc., by using Slack\u2019s rich messaging format.</p> <pre><code>{\n    \"text\": \"Hello, world! This is a line of text.\\nAnd this is another one.\"\n}\n</code></pre> <p>Zammad</p> <p>See above for how to open a ticket in Zammad with a webhook alert.</p>"},{"location":"functions/webhooks/#testing-webhooks","title":"Testing webhooks","text":"<p>Use the test button to make sure your webhook is working. Note: <code>{{alert.XXX}}</code> variables will NOT be available in testing mode.</p>"}]}